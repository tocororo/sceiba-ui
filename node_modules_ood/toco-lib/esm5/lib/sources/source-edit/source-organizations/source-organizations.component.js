/**
 * @fileoverview added by tsickle
 * Generated from: lib/sources/source-edit/source-organizations/source-organizations.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Inject } from "@angular/core";
import { MatDialogRef, MAT_DIALOG_DATA, MatDialog } from "@angular/material";
import { OrganizationServiceNoAuth } from '../../../backend/public-api';
import { MessageHandler, StatusCode, HandlerComponent } from '../../../core/public-api';
import { SourceData, Organization, SourceOrganizationRole, SourceOrganization, OrganizationRelationships } from '../../../entities/public-api';
var SourceOrganizationsComponent = /** @class */ (function () {
    function SourceOrganizationsComponent(dialog, orgService) {
        this.dialog = dialog;
        this.orgService = orgService;
        this.editable = true;
        this.topMainOrganization = null;
        this.roles = SourceOrganizationRole;
    }
    /**
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        console.log(this.sourceData.organizations);
        this.sourceData.organizations = this.sourceData.organizations.filter((/**
         * @param {?} element
         * @return {?}
         */
        function (element) { return element && element.role; }));
        console.log(this.sourceData.organizations);
    };
    /**
     * @param {?=} cuban
     * @param {?=} topMain
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.addOrg = /**
     * @param {?=} cuban
     * @param {?=} topMain
     * @return {?}
     */
    function (cuban, topMain) {
        var _this = this;
        if (cuban === void 0) { cuban = true; }
        if (topMain === void 0) { topMain = false; }
        if (topMain && this.topMainOrganization) {
            this.dialog.open(SourceOrganizationSelectTopDialog, {
                width: "500px",
                data: {
                    topMainOrganization: this.topMainOrganization,
                    selectOrg: (/**
                     * @param {?} org
                     * @param {?} parents
                     * @return {?}
                     */
                    function (org, parents) {
                        _this.addOrgToSource(org, SourceOrganizationRole.MAIN.value);
                        parents.forEach((/**
                         * @param {?} element
                         * @return {?}
                         */
                        function (element) {
                            _this.addOrgToSource(element, SourceOrganizationRole.COLABORATOR.value);
                        }));
                    }),
                },
            });
        }
        else {
            this.dialog.open(SourceOrganizationSelectDialog, {
                width: "500px",
                data: {
                    filter: cuban ? { type: "country", value: "Cuba" } : null,
                    canSelectRole: this.topMainOrganization == null,
                    selectOrg: (/**
                     * @param {?} org
                     * @param {?} role
                     * @param {?} parents
                     * @return {?}
                     */
                    function (org, role, parents) {
                        _this.addOrgToSource(org, role);
                        parents.forEach((/**
                         * @param {?} element
                         * @return {?}
                         */
                        function (element) {
                            _this.addOrgToSource(element, SourceOrganizationRole.COLABORATOR.value);
                        }));
                    }),
                },
            });
        }
    };
    /**
     * @private
     * @param {?} org
     * @param {?} role
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.addOrgToSource = /**
     * @private
     * @param {?} org
     * @param {?} role
     * @return {?}
     */
    function (org, role) {
        if (!this.sourceData.organizations.find((/**
         * @param {?} o
         * @return {?}
         */
        function (o) { return o.id == org.id; }))) {
            /** @type {?} */
            var selected = new SourceOrganization();
            selected.deepcopy(org);
            selected.role = role;
            this.sourceData.organizations.push(selected);
            if (SourceOrganizationRole.MAIN.value == role) {
                this.setAsMain(org);
            }
        }
    };
    /**
     * @param {?} organization
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.setAsMain = /**
     * @param {?} organization
     * @return {?}
     */
    function (organization) {
        this.sourceData.organizations.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            if (organization.id == element.id) {
                element.role = SourceOrganizationRole.MAIN.value;
            }
            else {
                element.role = SourceOrganizationRole.COLABORATOR.value;
            }
        }));
    };
    /**
     * @param {?} index
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.removeInst = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        var _this = this;
        /** @type {?} */
        var organization = this.sourceData.organizations[index];
        /** @type {?} */
        var m = new MessageHandler(null, this.dialog);
        /** @type {?} */
        var child = this.childToRemove(organization);
        if (child == null) {
            /** @type {?} */
            var parents = this.getOrgToDelete(organization);
            /** @type {?} */
            var toDelete = [];
            /** @type {?} */
            var msg = "";
            for (var i = 0; i < parents.length; i++) {
                /** @type {?} */
                var element = parents[i];
                toDelete.push(this.sourceData.organizations[element]);
                msg += this.sourceData.organizations[element].name + ", ";
            }
            toDelete.push(organization);
            console.log(toDelete);
            if (toDelete.length > 0) {
                m.showMessage(StatusCode.OK, msg, HandlerComponent.dialog, "Se eliminó también: ");
            }
            /** @type {?} */
            var orgs = [];
            var _loop_1 = function (i) {
                if (!toDelete.find((/**
                 * @param {?} o
                 * @return {?}
                 */
                function (o) { return o.id == _this.sourceData.organizations[i].id; }))) {
                    orgs.push(this_1.sourceData.organizations[i]);
                }
            };
            var this_1 = this;
            for (var i = 0; i < this.sourceData.organizations.length; i++) {
                _loop_1(i);
            }
            console.log(orgs);
            this.sourceData.organizations = orgs;
            // this.sourceData.organizations = this.sourceData.organizations.filter(
            //   (o) => o.id != organization.id
            // );
        }
        else {
            m.showMessage(StatusCode.OK, child.name, HandlerComponent.dialog, "Para eliminar este elemento debe eliminar:");
        }
    };
    /**
     * @private
     * @param {?} org
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.childToRemove = /**
     * @private
     * @param {?} org
     * @return {?}
     */
    function (org) {
        // se puede eliminar si no tiene hijos en el sourceData.organizations
        /** @type {?} */
        var result = true;
        if (org.relationships) {
            for (var index = 0; index < org.relationships.length; index++) {
                /** @type {?} */
                var element = org.relationships[index];
                if (element.type == OrganizationRelationships.CHILD.value) {
                    /** @type {?} */
                    var childIndex = this.getIndexByPid(element.identifiers[0].value);
                    if (childIndex != null) {
                        return this.sourceData.organizations[childIndex];
                    }
                }
            }
            return null;
        }
    };
    // removeInst(index) {
    //   let toDelete = []
    //   toDelete.push(index);
    //   toDelete.concat(this.getOrgToDelete(this.sourceData.organizations[index]));
    //   let orgs = [];
    //   for (let i = 0; i < this.sourceData.organizations.length; i++) {
    //     if(!toDelete.find((o) => o == i)){
    //       orgs.push(this.sourceData.organizations[i]);
    //     }
    //   }
    //   this.sourceData.organizations = orgs;
    // }
    // removeInst(index) {
    //   let toDelete = []
    //   toDelete.push(index);
    //   toDelete.concat(this.getOrgToDelete(this.sourceData.organizations[index]));
    //   let orgs = [];
    //   for (let i = 0; i < this.sourceData.organizations.length; i++) {
    //     if(!toDelete.find((o) => o == i)){
    //       orgs.push(this.sourceData.organizations[i]);
    //     }
    //   }
    //   this.sourceData.organizations = orgs;
    // }
    /**
     * @private
     * @param {?} org
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.getOrgToDelete = 
    // removeInst(index) {
    //   let toDelete = []
    //   toDelete.push(index);
    //   toDelete.concat(this.getOrgToDelete(this.sourceData.organizations[index]));
    //   let orgs = [];
    //   for (let i = 0; i < this.sourceData.organizations.length; i++) {
    //     if(!toDelete.find((o) => o == i)){
    //       orgs.push(this.sourceData.organizations[i]);
    //     }
    //   }
    //   this.sourceData.organizations = orgs;
    // }
    /**
     * @private
     * @param {?} org
     * @return {?}
     */
    function (org) {
        var _this = this;
        /** @type {?} */
        var toDelete = [];
        if (org.relationships) {
            org.relationships.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                if (element.type == OrganizationRelationships.PARENT.value) {
                    /** @type {?} */
                    var parentIndex = _this.getIndexByPid(element.identifiers[0].value);
                    if (parentIndex) {
                        toDelete.push(parentIndex);
                        toDelete.concat(_this.getOrgToDelete(_this.sourceData.organizations[parentIndex]));
                    }
                }
            }));
        }
        return toDelete;
    };
    /**
     * @private
     * @param {?} pid
     * @return {?}
     */
    SourceOrganizationsComponent.prototype.getIndexByPid = /**
     * @private
     * @param {?} pid
     * @return {?}
     */
    function (pid) {
        for (var index = 0; index < this.sourceData.organizations.length; index++) {
            /** @type {?} */
            var element = this.sourceData.organizations[index];
            for (var pidindex = 0; pidindex < element.identifiers.length; pidindex++) {
                /** @type {?} */
                var identifier = element.identifiers[pidindex];
                console.log(identifier.value + "==" + pid);
                if (identifier.value == pid) {
                    console.log(identifier.value + "==" + pid + "  iguales!!!");
                    return index;
                }
            }
        }
        return null;
    };
    SourceOrganizationsComponent.decorators = [
        { type: Component, args: [{
                    selector: "toco-source-organizations",
                    template: "<ng-container>\n  <mat-toolbar\n    *ngIf=\"editable\"\n    fxLayout=\"row wrap\"\n    fxLayoutAlign=\"space-between center\"\n    fxLayoutGap=\"20px\"\n  >\n    <span>Adicionar</span>\n    <div\n      fxLayout=\"row wrap\"\n      fxLayoutAlign=\"space-between center\"\n      fxLayoutGap=\"20px\"\n    >\n    <button *ngIf=\"topMainOrganization\" mat-raised-button (click)=\"addOrg(true, true)\">\n      Organizaci\u00F3n Principal\n    </button>\n      <button mat-raised-button (click)=\"addOrg(true)\">\n        Organizaciones Cubanas\n      </button>\n      <button mat-raised-button (click)=\"addOrg(false)\">\n        Otras\n      </button>\n    </div>\n  </mat-toolbar>\n\n  \n  <mat-accordion>\n    <mat-expansion-panel\n      *ngFor=\"let org of sourceData.organizations; let index = index\"\n      [expanded]=\"false\"\n    >\n      <mat-expansion-panel-header>\n        <mat-panel-title>\n          {{ roles[org.role].label }}\n        </mat-panel-title>\n        <mat-panel-description>\n          {{ org.name }}\n        </mat-panel-description>\n      </mat-expansion-panel-header>\n      <mat-action-row *ngIf=\"editable\">\n        <button\n          mat-stroked-button\n          [disabled]=\"org.length === 1\"\n          (click)=\"setAsMain(org)\"\n          *ngIf=\"!topMainOrganization\"\n        >\n          Establecer como Principal\n        </button>\n        <button\n          mat-stroked-button\n          [disabled]=\"org.length === 1\"\n          (click)=\"removeInst(index)\"\n        >\n          Eliminar\n        </button>\n      </mat-action-row>\n      <toco-org-view [org]=\"org\" [showContent]=\"false\"></toco-org-view>\n    </mat-expansion-panel>\n  </mat-accordion>\n</ng-container>\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SourceOrganizationsComponent.ctorParameters = function () { return [
        { type: MatDialog },
        { type: OrganizationServiceNoAuth }
    ]; };
    SourceOrganizationsComponent.propDecorators = {
        sourceData: [{ type: Input }],
        editable: [{ type: Input }],
        topMainOrganization: [{ type: Input }]
    };
    return SourceOrganizationsComponent;
}());
export { SourceOrganizationsComponent };
if (false) {
    /** @type {?} */
    SourceOrganizationsComponent.prototype.sourceData;
    /** @type {?} */
    SourceOrganizationsComponent.prototype.editable;
    /** @type {?} */
    SourceOrganizationsComponent.prototype.topMainOrganization;
    /** @type {?} */
    SourceOrganizationsComponent.prototype.roles;
    /** @type {?} */
    SourceOrganizationsComponent.prototype.dialog;
    /**
     * @type {?}
     * @private
     */
    SourceOrganizationsComponent.prototype.orgService;
}
var SourceOrganizationSelectTopDialog = /** @class */ (function () {
    function SourceOrganizationSelectTopDialog(dialogRef, data, orgService) {
        this.dialogRef = dialogRef;
        this.data = data;
        this.orgService = orgService;
        this.topMainOrganization = null;
        this.toSelect = null;
        this.selected = -1;
    }
    /**
     * @return {?}
     */
    SourceOrganizationSelectTopDialog.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.topMainOrganization = this.data.topMainOrganization;
        this.toSelect = new Array();
        this.topMainOrganization.relationships.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            if (element.type == OrganizationRelationships.CHILD.value) {
                _this.toSelect.push(element);
            }
        }));
        console.log(this.toSelect);
    };
    /**
     * @return {?}
     */
    SourceOrganizationSelectTopDialog.prototype.onNoClick = /**
     * @return {?}
     */
    function () {
        this.dialogRef.close();
    };
    /**
     * @return {?}
     */
    SourceOrganizationSelectTopDialog.prototype.ok = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // let selected = new SourceOrganization()
        // selected.organization = org;
        // selected.role = SourceOrganizationRole.MAIN.value;
        if (this.selected >= 0) {
            console.log(this.toSelect[this.selected]);
            this.orgService
                .getOrganizationByPID(this.toSelect[this.selected].identifiers[0].value)
                .subscribe({
                next: (/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    _this.data.selectOrg(response.metadata, [_this.topMainOrganization]);
                    _this.dialogRef.close();
                }),
            });
        }
    };
    SourceOrganizationSelectTopDialog.decorators = [
        { type: Component, args: [{
                    selector: "toco-source-organizations-select-top-main",
                    template: "<mat-dialog-content class=\"height-auto\">\n    <ng-container *ngIf=\"toSelect\"\n      >{{ topMainOrganization.name }}\n      <br />\n      <mat-form-field>\n        <mat-label>Seleccione la Organizaci\u00F3n Principal: </mat-label>\n        <mat-select [(value)]=\"selected\" required>\n          <mat-option\n            *ngFor=\"let item of toSelect; let index = index\"\n            value=\"{{ index }}\"\n            >{{ item.label }}</mat-option\n          >\n        </mat-select>\n      </mat-form-field>\n\n      <br />\n      <mat-label *ngIf=\"selected >= 0\">{{\n        toSelect[selected].label\n      }}</mat-label>\n      <br />\n    </ng-container>\n    <br />\n    <button mat-raised-button (click)=\"ok()\">OK</button>\n  </mat-dialog-content>"
                }] }
    ];
    /** @nocollapse */
    SourceOrganizationSelectTopDialog.ctorParameters = function () { return [
        { type: MatDialogRef },
        { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] },
        { type: OrganizationServiceNoAuth }
    ]; };
    return SourceOrganizationSelectTopDialog;
}());
export { SourceOrganizationSelectTopDialog };
if (false) {
    /** @type {?} */
    SourceOrganizationSelectTopDialog.prototype.topMainOrganization;
    /** @type {?} */
    SourceOrganizationSelectTopDialog.prototype.toSelect;
    /** @type {?} */
    SourceOrganizationSelectTopDialog.prototype.selected;
    /** @type {?} */
    SourceOrganizationSelectTopDialog.prototype.dialogRef;
    /** @type {?} */
    SourceOrganizationSelectTopDialog.prototype.data;
    /**
     * @type {?}
     * @private
     */
    SourceOrganizationSelectTopDialog.prototype.orgService;
}
var SourceOrganizationSelectDialog = /** @class */ (function () {
    function SourceOrganizationSelectDialog(dialogRef, data, orgService) {
        this.dialogRef = dialogRef;
        this.data = data;
        this.orgService = orgService;
        this.roles = [
            { label: "Principal", value: "MAIN" },
            { label: "Colaborador", value: "COLABORATOR" },
        ];
        this.role = null;
        this.parents = new Array();
        this.placeholder = "Buscar una organización";
        this.canSelectRole = true;
    }
    /**
     * @return {?}
     */
    SourceOrganizationSelectDialog.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        console.log(this.data);
        this.canSelectRole = this.data.canSelectRole;
        if (this.data.filter) {
            this.placeholder = "Buscar una organización cubana";
        }
    };
    /**
     * @return {?}
     */
    SourceOrganizationSelectDialog.prototype.onNoClick = /**
     * @return {?}
     */
    function () {
        this.dialogRef.close();
    };
    /**
     * @param {?=} org
     * @return {?}
     */
    SourceOrganizationSelectDialog.prototype.selectedOrg = /**
     * @param {?=} org
     * @return {?}
     */
    function (org) {
        console.log(org);
        this.org = org;
        this.addParent(this.org);
    };
    /**
     * @private
     * @param {?} child
     * @return {?}
     */
    SourceOrganizationSelectDialog.prototype.addParent = /**
     * @private
     * @param {?} child
     * @return {?}
     */
    function (child) {
        var _this = this;
        child.relationships.forEach((/**
         * @param {?} p
         * @return {?}
         */
        function (p) {
            if (p.type == OrganizationRelationships.PARENT.value) {
                if (p.identifiers.length > 0 && p.identifiers[0].value) {
                    _this.orgService
                        .getOrganizationByPID(p.identifiers[0].value)
                        .subscribe({
                        next: (/**
                         * @param {?} response
                         * @return {?}
                         */
                        function (response) {
                            console.log(response);
                            _this.parents.push(response.metadata);
                            _this.addParent(response.metadata);
                        }),
                    });
                }
            }
        }));
    };
    /**
     * @return {?}
     */
    SourceOrganizationSelectDialog.prototype.ok = /**
     * @return {?}
     */
    function () {
        // let selected = new SourceOrganization()
        // selected.organization = org;
        // selected.role = SourceOrganizationRole.MAIN.value;
        if (this.canSelectRole) {
            if (this.role) {
                this.data.selectOrg(this.org, this.role, this.parents);
                this.dialogRef.close();
            }
        }
        else {
            this.data.selectOrg(this.org, SourceOrganizationRole.COLABORATOR.value, this.parents);
            this.dialogRef.close();
        }
    };
    SourceOrganizationSelectDialog.decorators = [
        { type: Component, args: [{
                    selector: "toco-source-organizations-select-dialog",
                    template: "<mat-dialog-content class=\"height-auto\">\n    <toco-org-search\n      [orgFilter]=\"data.filter\"\n      (selectedOrg)=\"selectedOrg($event)\"\n      [placeholder]=\"placeholder\"\n    >\n    </toco-org-search>\n    <br />\n    <mat-label *ngIf=\"org\">{{ org.name }}</mat-label>\n    <br />\n    <mat-form-field *ngIf=\"canSelectRole\">\n      <mat-label>Rol</mat-label>\n      <mat-select [(value)]=\"role\" required>\n        <mat-option *ngFor=\"let item of roles\" value=\"{{ item.value }}\">{{\n          item.label\n        }}</mat-option>\n      </mat-select>\n    </mat-form-field>\n\n    <br />\n\n    <ng-container *ngIf=\"parents.length > 0\">\n      <mat-label>Se a\u00F1adir\u00E1 tambi\u00E9n: </mat-label>\n      <ng-container *ngFor=\"let item of parents\">\n        <br />\n        <mat-label>{{ item.name }}</mat-label>\n        <br />\n      </ng-container>\n      <br />\n    </ng-container>\n\n    <button mat-raised-button (click)=\"ok()\">OK</button>\n  </mat-dialog-content>"
                }] }
    ];
    /** @nocollapse */
    SourceOrganizationSelectDialog.ctorParameters = function () { return [
        { type: MatDialogRef },
        { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] },
        { type: OrganizationServiceNoAuth }
    ]; };
    return SourceOrganizationSelectDialog;
}());
export { SourceOrganizationSelectDialog };
if (false) {
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.roles;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.role;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.org;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.parents;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.placeholder;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.canSelectRole;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.dialogRef;
    /** @type {?} */
    SourceOrganizationSelectDialog.prototype.data;
    /**
     * @type {?}
     * @private
     */
    SourceOrganizationSelectDialog.prototype.orgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLW9yZ2FuaXphdGlvbnMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vdG9jby1saWIvIiwic291cmNlcyI6WyJsaWIvc291cmNlcy9zb3VyY2UtZWRpdC9zb3VyY2Utb3JnYW5pemF0aW9ucy9zb3VyY2Utb3JnYW5pemF0aW9ucy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFakUsT0FBTyxFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDN0UsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDeEUsT0FBTyxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUN4RixPQUFPLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxzQkFBc0IsRUFBRSxrQkFBa0IsRUFBRSx5QkFBeUIsRUFBZ0IsTUFBTSw4QkFBOEIsQ0FBQztBQUc3SjtJQWdCRSxzQ0FDUyxNQUFpQixFQUNoQixVQUFxQztRQUR0QyxXQUFNLEdBQU4sTUFBTSxDQUFXO1FBQ2hCLGVBQVUsR0FBVixVQUFVLENBQTJCO1FBUnhDLGFBQVEsR0FBWSxJQUFJLENBQUM7UUFHekIsd0JBQW1CLEdBQWlCLElBQUksQ0FBQztRQUV6QyxVQUFLLEdBQUcsc0JBQXNCLENBQUM7SUFJbkMsQ0FBQzs7OztJQUVKLCtDQUFROzs7SUFBUjtRQUNFLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUMzQyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxNQUFNOzs7O1FBQ2xFLFVBQUMsT0FBTyxJQUFLLE9BQUEsT0FBTyxJ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QUUseUNBQXlDO29CQUNuRCxRQUFRLEVBQUUsMitCQWdDWTtpQkFDdkI7Ozs7Z0JBN1RRLFlBQVk7Z0RBaVVoQixNQUFNLFNBQUMsZUFBZTtnQkFoVWxCLHlCQUF5Qjs7SUFpWWxDLHFDQUFDO0NBQUEsQUF4R0QsSUF3R0M7U0FwRVksOEJBQThCOzs7SUFPekMsK0NBR0U7O0lBQ0YsOENBQW1COztJQUNuQiw2Q0FBeUI7O0lBQ3pCLGlEQUFnRTs7SUFDaEUscURBQXdDOztJQUN4Qyx1REFBNEI7O0lBYjFCLG1EQUE4RDs7SUFDOUQsOENBQXlDOzs7OztJQUN6QyxvREFBNkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIEluamVjdCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmltcG9ydCB7IE1hdERpYWxvZ1JlZiwgTUFUX0RJQUxPR19EQVRBLCBNYXREaWFsb2cgfSBmcm9tIFwiQGFuZ3VsYXIvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IE9yZ2FuaXphdGlvblNlcnZpY2VOb0F1dGggfSBmcm9tICcuLi8uLi8uLi9iYWNrZW5kL3B1YmxpYy1hcGknO1xuaW1wb3J0IHsgTWVzc2FnZUhhbmRsZXIsIFN0YXR1c0NvZGUsIEhhbmRsZXJDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3B1YmxpYy1hcGknO1xuaW1wb3J0IHsgU291cmNlRGF0YSwgT3JnYW5pemF0aW9uLCBTb3VyY2VPcmdhbml6YXRpb25Sb2xlLCBTb3VyY2VPcmdhbml6YXRpb24sIE9yZ2FuaXphdGlvblJlbGF0aW9uc2hpcHMsIFJlbGF0aW9uc2hpcCB9IGZyb20gJy4uLy4uLy4uL2VudGl0aWVzL3B1YmxpYy1hcGknO1xuXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJ0b2NvLXNvdXJjZS1vcmdhbml6YXRpb25zXCIsXG4gIHRlbXBsYXRlVXJsOiBcIi4vc291cmNlLW9yZ2FuaXphdGlvbnMuY29tcG9uZW50Lmh0bWxcIixcbiAgc3R5bGVVcmxzOiBbXCIuL3NvdXJjZS1vcmdhbml6YXRpb25zLmNvbXBvbmVudC5zY3NzXCJdLFxufSlcbmV4cG9ydCBjbGFzcyBTb3VyY2VPcmdhbml6YXRpb25zQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KClcbiAgcHVibGljIHNvdXJjZURhdGE6IFNvdXJjZURhdGE7XG5cbiAgQElucHV0KClcbiAgcHVibGljIGVkaXRhYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICBASW5wdXQoKVxuICBwdWJsaWMgdG9wTWFpbk9yZ2FuaXphdGlvbjogT3JnYW5pemF0aW9uID0gbnVsbDtcblxuICBwdWJsaWMgcm9sZXMgPSBTb3VyY2VPcmdhbml6YXRpb25Sb2xlO1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgZGlhbG9nOiBNYXREaWFsb2csXG4gICAgcHJpdmF0ZSBvcmdTZXJ2aWNlOiBPcmdhbml6YXRpb25TZXJ2aWNlTm9BdXRoXG4gICkge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICBjb25zb2xlLmxvZyh0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9ucyk7XG4gICAgdGhpcy5zb3VyY2VEYXRhLm9yZ2FuaXphdGlvbnMgPSB0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9ucy5maWx0ZXIoXG4gICAgICAoZWxlbWVudCkgPT4gZWxlbWVudCAmJiBlbGVtZW50LnJvbGVcbiAgICApO1xuICAgIGNvbnNvbGUubG9nKHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zKTtcbiAgfVxuXG4gIGFkZE9yZyhjdWJhbiA9IHRydWUsIHRvcE1haW4gPSBmYWxzZSkge1xuICAgIGlmICh0b3BNYWluICYmIHRoaXMudG9wTWFpbk9yZ2FuaXphdGlvbikge1xuICAgICAgdGhpcy5kaWFsb2cub3BlbihTb3VyY2VPcmdhbml6YXRpb25TZWxlY3RUb3BEaWFsb2csIHtcbiAgICAgICAgd2lkdGg6IFwiNTAwcHhcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHRvcE1haW5Pcmdhbml6YXRpb246IHRoaXMudG9wTWFpbk9yZ2FuaXphdGlvbixcbiAgICAgICAgICBzZWxlY3RPcmc6IChvcmc6IE9yZ2FuaXphdGlvbiwgcGFyZW50czogQXJyYXk8T3JnYW5pemF0aW9uPikgPT4ge1xuICAgICAgICAgICAgdGhpcy5hZGRPcmdUb1NvdXJjZShvcmcsIFNvdXJjZU9yZ2FuaXphdGlvblJvbGUuTUFJTi52YWx1ZSk7XG4gICAgICAgICAgICBwYXJlbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5hZGRPcmdUb1NvdXJjZShcbiAgICAgICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgICAgIFNvdXJjZU9yZ2FuaXphdGlvblJvbGUuQ09MQUJPUkFUT1IudmFsdWVcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kaWFsb2cub3BlbihTb3VyY2VPcmdhbml6YXRpb25TZWxlY3REaWFsb2csIHtcbiAgICAgICAgd2lkdGg6IFwiNTAwcHhcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGZpbHRlcjogY3ViYW4gPyB7IHR5cGU6IFwiY291bnRyeVwiLCB2YWx1ZTogXCJDdWJhXCIgfSA6IG51bGwsXG4gICAgICAgICAgY2FuU2VsZWN0Um9sZTogdGhpcy50b3BNYWluT3JnYW5pemF0aW9uID09IG51bGwsXG4gICAgICAgICAgc2VsZWN0T3JnOiAoXG4gICAgICAgICAgICBvcmc6IE9yZ2FuaXphdGlvbixcbiAgICAgICAgICAgIHJvbGUsXG4gICAgICAgICAgICBwYXJlbnRzOiBBcnJheTxPcmdhbml6YXRpb24+XG4gICAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZE9yZ1RvU291cmNlKG9yZywgcm9sZSk7XG4gICAgICAgICAgICBwYXJlbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5hZGRPcmdUb1NvdXJjZShcbiAgICAgICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgICAgIFNvdXJjZU9yZ2FuaXphdGlvblJvbGUuQ09MQUJPUkFUT1IudmFsdWVcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcHJpdmF0ZSBhZGRPcmdUb1NvdXJjZShvcmc6IE9yZ2FuaXphdGlvbiwgcm9sZSkge1xuICAgIGlmICghdGhpcy5zb3VyY2VEYXRhLm9yZ2FuaXphdGlvbnMuZmluZCgobykgPT4gby5pZCA9PSBvcmcuaWQpKSB7XG4gICAgICBsZXQgc2VsZWN0ZWQgPSBuZXcgU291cmNlT3JnYW5pemF0aW9uKCk7XG4gICAgICBzZWxlY3RlZC5kZWVwY29weShvcmcpO1xuICAgICAgc2VsZWN0ZWQucm9sZSA9IHJvbGU7XG4gICAgICB0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9ucy5wdXNoKHNlbGVjdGVkKTtcbiAgICAgIGlmIChTb3VyY2VPcmdhbml6YXRpb25Sb2xlLk1BSU4udmFsdWUgPT0gcm9sZSkge1xuICAgICAgICB0aGlzLnNldEFzTWFpbihvcmcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBzZXRBc01haW4ob3JnYW5pemF0aW9uOiBPcmdhbml6YXRpb24pIHtcbiAgICB0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9ucy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICBpZiAob3JnYW5pemF0aW9uLmlkID09IGVsZW1lbnQuaWQpIHtcbiAgICAgICAgZWxlbWVudC5yb2xlID0gU291cmNlT3JnYW5pemF0aW9uUm9sZS5NQUlOLnZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5yb2xlID0gU291cmNlT3JnYW5pemF0aW9uUm9sZS5DT0xBQk9SQVRPUi52YWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUluc3QoaW5kZXgpIHtcbiAgICBjb25zdCBvcmdhbml6YXRpb24gPSB0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9uc1tpbmRleF07XG4gICAgY29uc3QgbSA9IG5ldyBNZXNzYWdlSGFuZGxlcihudWxsLCB0aGlzLmRpYWxvZyk7XG4gICAgY29uc3QgY2hpbGQgPSB0aGlzLmNoaWxkVG9SZW1vdmUob3JnYW5pemF0aW9uKTtcbiAgICBpZiAoY2hpbGQgPT0gbnVsbCkge1xuICAgICAgbGV0IHBhcmVudHMgPSB0aGlzLmdldE9yZ1RvRGVsZXRlKG9yZ2FuaXphdGlvbik7XG4gICAgICBsZXQgdG9EZWxldGUgPSBbXTtcbiAgICAgIGxldCBtc2cgPSBcIlwiO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBwYXJlbnRzW2ldO1xuICAgICAgICB0b0RlbGV0ZS5wdXNoKHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW2VsZW1lbnRdKTtcbiAgICAgICAgbXNnICs9IHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW2VsZW1lbnRdLm5hbWUgKyBcIiwgXCI7XG4gICAgICB9XG4gICAgICB0b0RlbGV0ZS5wdXNoKG9yZ2FuaXphdGlvbik7XG4gICAgICBjb25zb2xlLmxvZyh0b0RlbGV0ZSk7XG4gICAgICBpZih0b0RlbGV0ZS5sZW5ndGg+MCl7XG4gICAgICAgIG0uc2hvd01lc3NhZ2UoXG4gICAgICAgICAgU3RhdHVzQ29kZS5PSyxcbiAgICAgICAgICBtc2csXG4gICAgICAgICAgSGFuZGxlckNvbXBvbmVudC5kaWFsb2csXG4gICAgICAgICAgXCJTZSBlbGltaW7DsyB0YW1iacOpbjogXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgbGV0IG9yZ3MgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zb3VyY2VEYXRhLm9yZ2FuaXphdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICF0b0RlbGV0ZS5maW5kKChvKSA9PiBvLmlkID09IHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW2ldLmlkKVxuICAgICAgICApIHtcbiAgICAgICAgICBvcmdzLnB1c2godGhpcy5zb3VyY2VEYXRhLm9yZ2FuaXphdGlvbnNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZyhvcmdzKTtcbiAgICAgIHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zID0gb3JncztcbiAgICAgIC8vIHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zID0gdGhpcy5zb3VyY2VEYXRhLm9yZ2FuaXphdGlvbnMuZmlsdGVyKFxuICAgICAgLy8gICAobykgPT4gby5pZCAhPSBvcmdhbml6YXRpb24uaWRcbiAgICAgIC8vICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG0uc2hvd01lc3NhZ2UoXG4gICAgICAgIFN0YXR1c0NvZGUuT0ssXG4gICAgICAgIGNoaWxkLm5hbWUsXG4gICAgICAgIEhhbmRsZXJDb21wb25lbnQuZGlhbG9nLFxuICAgICAgICBcIlBhcmEgZWxpbWluYXIgZXN0ZSBlbGVtZW50byBkZWJlIGVsaW1pbmFyOlwiXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2hpbGRUb1JlbW92ZShvcmc6IE9yZ2FuaXphdGlvbikge1xuICAgIC8vIHNlIHB1ZWRlIGVsaW1pbmFyIHNpIG5vIHRpZW5lIGhpam9zIGVuIGVsIHNvdXJjZURhdGEub3JnYW5pemF0aW9uc1xuICAgIGxldCByZXN1bHQgPSB0cnVlO1xuXG4gICAgaWYgKG9yZy5yZWxhdGlvbnNoaXBzKSB7XG4gICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgb3JnLnJlbGF0aW9uc2hpcHMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBvcmcucmVsYXRpb25zaGlwc1tpbmRleF07XG4gICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gT3JnYW5pemF0aW9uUmVsYXRpb25zaGlwcy5DSElMRC52YWx1ZSkge1xuICAgICAgICAgIGNvbnN0IGNoaWxkSW5kZXggPSB0aGlzLmdldEluZGV4QnlQaWQoZWxlbWVudC5pZGVudGlmaWVyc1swXS52YWx1ZSk7XG4gICAgICAgICAgaWYgKGNoaWxkSW5kZXggIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW2NoaWxkSW5kZXhdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG4gIC8vIHJlbW92ZUluc3QoaW5kZXgpIHtcbiAgLy8gICBsZXQgdG9EZWxldGUgPSBbXVxuICAvLyAgIHRvRGVsZXRlLnB1c2goaW5kZXgpO1xuICAvLyAgIHRvRGVsZXRlLmNvbmNhdCh0aGlzLmdldE9yZ1RvRGVsZXRlKHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW2luZGV4XSkpO1xuICAvLyAgIGxldCBvcmdzID0gW107XG4gIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9ucy5sZW5ndGg7IGkrKykge1xuICAvLyAgICAgaWYoIXRvRGVsZXRlLmZpbmQoKG8pID0+IG8gPT0gaSkpe1xuICAvLyAgICAgICBvcmdzLnB1c2godGhpcy5zb3VyY2VEYXRhLm9yZ2FuaXphdGlvbnNbaV0pO1xuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgLy8gICB0aGlzLnNvdXJjZURhdGEub3JnYW5pemF0aW9ucyA9IG9yZ3M7XG4gIC8vIH1cblxuICBwcml2YXRlIGdldE9yZ1RvRGVsZXRlKG9yZzogT3JnYW5pemF0aW9uKSB7XG4gICAgbGV0IHRvRGVsZXRlID0gW107XG4gICAgaWYgKG9yZy5yZWxhdGlvbnNoaXBzKSB7XG4gICAgICBvcmcucmVsYXRpb25zaGlwcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gT3JnYW5pemF0aW9uUmVsYXRpb25zaGlwcy5QQVJFTlQudmFsdWUpIHtcbiAgICAgICAgICBjb25zdCBwYXJlbnRJbmRleCA9IHRoaXMuZ2V0SW5kZXhCeVBpZChlbGVtZW50LmlkZW50aWZpZXJzWzBdLnZhbHVlKTtcbiAgICAgICAgICBpZiAocGFyZW50SW5kZXgpIHtcbiAgICAgICAgICAgIHRvRGVsZXRlLnB1c2gocGFyZW50SW5kZXgpO1xuICAgICAgICAgICAgdG9EZWxldGUuY29uY2F0KFxuICAgICAgICAgICAgICB0aGlzLmdldE9yZ1RvRGVsZXRlKHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW3BhcmVudEluZGV4XSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdG9EZWxldGU7XG4gIH1cblxuICBwcml2YXRlIGdldEluZGV4QnlQaWQocGlkKSB7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc291cmNlRGF0YS5vcmdhbml6YXRpb25zW2luZGV4XTtcbiAgICAgIGZvciAoXG4gICAgICAgIGxldCBwaWRpbmRleCA9IDA7XG4gICAgICAgIHBpZGluZGV4IDwgZWxlbWVudC5pZGVudGlmaWVycy5sZW5ndGg7XG4gICAgICAgIHBpZGluZGV4KytcbiAgICAgICkge1xuICAgICAgICBjb25zdCBpZGVudGlmaWVyID0gZWxlbWVudC5pZGVudGlmaWVyc1twaWRpbmRleF07XG4gICAgICAgIGNvbnNvbGUubG9nKGlkZW50aWZpZXIudmFsdWUgKyBcIj09XCIgKyBwaWQpO1xuICAgICAgICBpZiAoaWRlbnRpZmllci52YWx1ZSA9PSBwaWQpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhpZGVudGlmaWVyLnZhbHVlICsgXCI9PVwiICsgcGlkICsgXCIgIGlndWFsZXMhISFcIik7XG4gICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJ0b2NvLXNvdXJjZS1vcmdhbml6YXRpb25zLXNlbGVjdC10b3AtbWFpblwiLFxuICB0ZW1wbGF0ZTogYDxtYXQtZGlhbG9nLWNvbnRlbnQgY2xhc3M9XCJoZWlnaHQtYXV0b1wiPlxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ0b1NlbGVjdFwiXG4gICAgICA+e3sgdG9wTWFpbk9yZ2FuaXphdGlvbi5uYW1lIH19XG4gICAgICA8YnIgLz5cbiAgICAgIDxtYXQtZm9ybS1maWVsZD5cbiAgICAgICAgPG1hdC1sYWJlbD5TZWxlY2Npb25lIGxhIE9yZ2FuaXphY2nDs24gUHJpbmNpcGFsOiA8L21hdC1sYWJlbD5cbiAgICAgICAgPG1hdC1zZWxlY3QgWyh2YWx1ZSldPVwic2VsZWN0ZWRcIiByZXF1aXJlZD5cbiAgICAgICAgICA8bWF0LW9wdGlvblxuICAgICAgICAgICAgKm5nRm9yPVwibGV0IGl0ZW0gb2YgdG9TZWxlY3Q7IGxldCBpbmRleCA9IGluZGV4XCJcbiAgICAgICAgICAgIHZhbHVlPVwie3sgaW5kZXggfX1cIlxuICAgICAgICAgICAgPnt7IGl0ZW0ubGFiZWwgfX08L21hdC1vcHRpb25cbiAgICAgICAgICA+XG4gICAgICAgIDwvbWF0LXNlbGVjdD5cbiAgICAgIDwvbWF0LWZvcm0tZmllbGQ+XG5cbiAgICAgIDxiciAvPlxuICAgICAgPG1hdC1sYWJlbCAqbmdJZj1cInNlbGVjdGVkID49IDBcIj57e1xuICAgICAgICB0b1NlbGVjdFtzZWxlY3RlZF0ubGFiZWxcbiAgICAgIH19PC9tYXQtbGFiZWw+XG4gICAgICA8YnIgLz5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8YnIgLz5cbiAgICA8YnV0dG9uIG1hdC1yYWlzZWQtYnV0dG9uIChjbGljayk9XCJvaygpXCI+T0s8L2J1dHRvbj5cbiAgPC9tYXQtZGlhbG9nLWNvbnRlbnQ+YCxcbn0pXG5leHBvcnQgY2xhc3MgU291cmNlT3JnYW5pemF0aW9uU2VsZWN0VG9wRGlhbG9nIGltcGxlbWVudHMgT25Jbml0IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPFNvdXJjZU9yZ2FuaXphdGlvblNlbGVjdFRvcERpYWxvZz4sXG4gICAgQEluamVjdChNQVRfRElBTE9HX0RBVEEpIHB1YmxpYyBkYXRhOiBhbnksXG4gICAgcHJpdmF0ZSBvcmdTZXJ2aWNlOiBPcmdhbml6YXRpb25TZXJ2aWNlTm9BdXRoXG4gICkge31cblxuICBwdWJsaWMgdG9wTWFpbk9yZ2FuaXphdGlvbjogT3JnYW5pemF0aW9uID0gbnVsbDtcbiAgcHVibGljIHRvU2VsZWN0OiBBcnJheTxSZWxhdGlvbnNoaXA+ID0gbnVsbDtcbiAgcHVibGljIHNlbGVjdGVkID0gLTE7XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy50b3BNYWluT3JnYW5pemF0aW9uID0gdGhpcy5kYXRhLnRvcE1haW5Pcmdhbml6YXRpb247XG4gICAgdGhpcy50b1NlbGVjdCA9IG5ldyBBcnJheTxSZWxhdGlvbnNoaXA+KCk7XG4gICAgdGhpcy50b3BNYWluT3JnYW5pemF0aW9uLnJlbGF0aW9uc2hpcHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSBPcmdhbml6YXRpb25SZWxhdGlvbnNoaXBzLkNISUxELnZhbHVlKSB7XG4gICAgICAgIHRoaXMudG9TZWxlY3QucHVzaChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLnRvU2VsZWN0KTtcbiAgfVxuICBvbk5vQ2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5kaWFsb2dSZWYuY2xvc2UoKTtcbiAgfVxuXG4gIHB1YmxpYyBvaygpIHtcbiAgICAvLyBsZXQgc2VsZWN0ZWQgPSBuZXcgU291cmNlT3JnYW5pemF0aW9uKClcbiAgICAvLyBzZWxlY3RlZC5vcmdhbml6YXRpb24gPSBvcmc7XG4gICAgLy8gc2VsZWN0ZWQucm9sZSA9IFNvdXJjZU9yZ2FuaXphdGlvblJvbGUuTUFJTi52YWx1ZTtcbiAgICBpZiAodGhpcy5zZWxlY3RlZCA+PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLnRvU2VsZWN0W3RoaXMuc2VsZWN0ZWRdKTtcbiAgICAgIHRoaXMub3JnU2VydmljZVxuICAgICAgICAuZ2V0T3JnYW5pemF0aW9uQnlQSUQodGhpcy50b1NlbGVjdFt0aGlzLnNlbGVjdGVkXS5pZGVudGlmaWVyc1swXS52YWx1ZSlcbiAgICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgICAgbmV4dDogKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRhdGEuc2VsZWN0T3JnKHJlc3BvbnNlLm1ldGFkYXRhLCBbdGhpcy50b3BNYWluT3JnYW5pemF0aW9uXSk7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6IFwidG9jby1zb3VyY2Utb3JnYW5pemF0aW9ucy1zZWxlY3QtZGlhbG9nXCIsXG4gIHRlbXBsYXRlOiBgPG1hdC1kaWFsb2ctY29udGVudCBjbGFzcz1cImhlaWdodC1hdXRvXCI+XG4gICAgPHRvY28tb3JnLXNlYXJjaFxuICAgICAgW29yZ0ZpbHRlcl09XCJkYXRhLmZpbHRlclwiXG4gICAgICAoc2VsZWN0ZWRPcmcpPVwic2VsZWN0ZWRPcmcoJGV2ZW50KVwiXG4gICAgICBbcGxhY2Vob2xkZXJdPVwicGxhY2Vob2xkZXJcIlxuICAgID5cbiAgICA8L3RvY28tb3JnLXNlYXJjaD5cbiAgICA8YnIgLz5cbiAgICA8bWF0LWxhYmVsICpuZ0lmPVwib3JnXCI+e3sgb3JnLm5hbWUgfX08L21hdC1sYWJlbD5cbiAgICA8YnIgLz5cbiAgICA8bWF0LWZvcm0tZmllbGQgKm5nSWY9XCJjYW5TZWxlY3RSb2xlXCI+XG4gICAgICA8bWF0LWxhYmVsPlJvbDwvbWF0LWxhYmVsPlxuICAgICAgPG1hdC1zZWxlY3QgWyh2YWx1ZSldPVwicm9sZVwiIHJlcXVpcmVkPlxuICAgICAgICA8bWF0LW9wdGlvbiAqbmdGb3I9XCJsZXQgaXRlbSBvZiByb2xlc1wiIHZhbHVlPVwie3sgaXRlbS52YWx1ZSB9fVwiPnt7XG4gICAgICAgICAgaXRlbS5sYWJlbFxuICAgICAgICB9fTwvbWF0LW9wdGlvbj5cbiAgICAgIDwvbWF0LXNlbGVjdD5cbiAgICA8L21hdC1mb3JtLWZpZWxkPlxuXG4gICAgPGJyIC8+XG5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwicGFyZW50cy5sZW5ndGggPiAwXCI+XG4gICAgICA8bWF0LWxhYmVsPlNlIGHDsWFkaXLDoSB0YW1iacOpbjogPC9tYXQtbGFiZWw+XG4gICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBpdGVtIG9mIHBhcmVudHNcIj5cbiAgICAgICAgPGJyIC8+XG4gICAgICAgIDxtYXQtbGFiZWw+e3sgaXRlbS5uYW1lIH19PC9tYXQtbGFiZWw+XG4gICAgICAgIDxiciAvPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8YnIgLz5cbiAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgIDxidXR0b24gbWF0LXJhaXNlZC1idXR0b24gKGNsaWNrKT1cIm9rKClcIj5PSzwvYnV0dG9uPlxuICA8L21hdC1kaWFsb2ctY29udGVudD5gLFxufSlcbmV4cG9ydCBjbGFzcyBTb3VyY2VPcmdhbml6YXRpb25TZWxlY3REaWFsb2cgaW1wbGVtZW50cyBPbkluaXQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgZGlhbG9nUmVmOiBNYXREaWFsb2dSZWY8U291cmNlT3JnYW5pemF0aW9uU2VsZWN0RGlhbG9nPixcbiAgICBASW5qZWN0KE1BVF9ESUFMT0dfREFUQSkgcHVibGljIGRhdGE6IGFueSxcbiAgICBwcml2YXRlIG9yZ1NlcnZpY2U6IE9yZ2FuaXphdGlvblNlcnZpY2VOb0F1dGhcbiAgKSB7fVxuXG4gIHB1YmxpYyByb2xlcyA9IFtcbiAgICB7IGxhYmVsOiBcIlByaW5jaXBhbFwiLCB2YWx1ZTogXCJNQUlOXCIgfSxcbiAgICB7IGxhYmVsOiBcIkNvbGFib3JhZG9yXCIsIHZhbHVlOiBcIkNPTEFCT1JBVE9SXCIgfSxcbiAgXTtcbiAgcHVibGljIHJvbGUgPSBudWxsO1xuICBwdWJsaWMgb3JnOiBPcmdhbml6YXRpb247XG4gIHB1YmxpYyBwYXJlbnRzOiBBcnJheTxPcmdhbml6YXRpb24+ID0gbmV3IEFycmF5PE9yZ2FuaXphdGlvbj4oKTtcbiAgcGxhY2Vob2xkZXIgPSBcIkJ1c2NhciB1bmEgb3JnYW5pemFjacOzblwiO1xuICBwdWJsaWMgY2FuU2VsZWN0Um9sZSA9IHRydWU7XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgY29uc29sZS5sb2codGhpcy5kYXRhKTtcbiAgICB0aGlzLmNhblNlbGVjdFJvbGUgPSB0aGlzLmRhdGEuY2FuU2VsZWN0Um9sZTtcbiAgICBpZiAodGhpcy5kYXRhLmZpbHRlcikge1xuICAgICAgdGhpcy5wbGFjZWhvbGRlciA9IFwiQnVzY2FyIHVuYSBvcmdhbml6YWNpw7NuIGN1YmFuYVwiO1xuICAgIH1cbiAgfVxuICBvbk5vQ2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5kaWFsb2dSZWYuY2xvc2UoKTtcbiAgfVxuXG4gIHB1YmxpYyBzZWxlY3RlZE9yZyhvcmc/OiBPcmdhbml6YXRpb24pOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZyhvcmcpO1xuICAgIHRoaXMub3JnID0gb3JnO1xuICAgIHRoaXMuYWRkUGFyZW50KHRoaXMub3JnKTtcbiAgfVxuICBwcml2YXRlIGFkZFBhcmVudChjaGlsZDogT3JnYW5pemF0aW9uKSB7XG4gICAgY2hpbGQucmVsYXRpb25zaGlwcy5mb3JFYWNoKChwKSA9PiB7XG4gICAgICBpZiAocC50eXBlID09IE9yZ2FuaXphdGlvblJlbGF0aW9uc2hpcHMuUEFSRU5ULnZhbHVlKSB7XG4gICAgICAgIGlmIChwLmlkZW50aWZpZXJzLmxlbmd0aCA+IDAgJiYgcC5pZGVudGlmaWVyc1swXS52YWx1ZSkge1xuICAgICAgICAgIHRoaXMub3JnU2VydmljZVxuICAgICAgICAgICAgLmdldE9yZ2FuaXphdGlvbkJ5UElEKHAuaWRlbnRpZmllcnNbMF0udmFsdWUpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgbmV4dDogKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50cy5wdXNoKHJlc3BvbnNlLm1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFBhcmVudChyZXNwb25zZS5tZXRhZGF0YSk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIHB1YmxpYyBvaygpIHtcbiAgICAvLyBsZXQgc2VsZWN0ZWQgPSBuZXcgU291cmNlT3JnYW5pemF0aW9uKClcbiAgICAvLyBzZWxlY3RlZC5vcmdhbml6YXRpb24gPSBvcmc7XG4gICAgLy8gc2VsZWN0ZWQucm9sZSA9IFNvdXJjZU9yZ2FuaXphdGlvblJvbGUuTUFJTi52YWx1ZTtcbiAgICBpZiAodGhpcy5jYW5TZWxlY3RSb2xlKSB7XG4gICAgICBpZiAodGhpcy5yb2xlKSB7XG4gICAgICAgIHRoaXMuZGF0YS5zZWxlY3RPcmcodGhpcy5vcmcsIHRoaXMucm9sZSwgdGhpcy5wYXJlbnRzKTtcbiAgICAgICAgdGhpcy5kaWFsb2dSZWYuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kYXRhLnNlbGVjdE9yZyhcbiAgICAgICAgdGhpcy5vcmcsXG4gICAgICAgIFNvdXJjZU9yZ2FuaXphdGlvblJvbGUuQ09MQUJPUkFUT1IudmFsdWUsXG4gICAgICAgIHRoaXMucGFyZW50c1xuICAgICAgKTtcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKCk7XG4gICAgfVxuICB9XG59XG4iXX0=