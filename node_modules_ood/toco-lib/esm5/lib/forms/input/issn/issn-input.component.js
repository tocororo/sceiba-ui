/**
 * @fileoverview added by tsickle
 * Generated from: lib/forms/input/issn/issn-input.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component } from '@angular/core';
import { FormControl, Validators } from '@angular/forms';
import { ExtraValidators } from '../../../core/utils/validator';
import { IssnType_Abbreviation, IssnValue } from './issn-value';
import { InputControl } from '../input.control';
/**
 * Represents a control that allows the writing of an ISSN.
 * An ISSN (International Standard Serial Number) is an 8-digit code.
 * This control stores the code as a string of length 11, with the form 'XXXX – XXXX'.
 * It is used to identify newspapers, journals, magazines and periodicals
 * of all kinds and on all media–print and electronic. For more information
 * follow the link: https://www.issn.org/understanding-the-issn/what-is-an-issn/.
 * It uses the `IssnType_Abbreviation.ISSN` as a label if the `content.label` is not specified.
 * It uses the `IssnValue.issn_Placeholder` as a placeholder if the `content.placeholder` is not specified.
 */
var InputIssnComponent = /** @class */ (function (_super) {
    tslib_1.__extends(InputIssnComponent, _super);
    function InputIssnComponent() {
        var _this = _super.call(this) || this;
        _this._codeOldValue = undefined;
        return _this;
    }
    /* Note: Before, this control worked well with a 'width' = '310px' or '285px'. */
    /**
     * Returns a `FormControl` by default.
     * It is used to initialized the `InputIssnComponent`'s `content.formControl` value by default.
     * In this case, the `validatorArguments` argument is always `undefined`.
     */
    /* Note: Before, this control worked well with a 'width' = '310px' or '285px'. */
    /**
     * Returns a `FormControl` by default.
     * It is used to initialized the `InputIssnComponent`'s `content.formControl` value by default.
     * In this case, the `validatorArguments` argument is always `undefined`.
     * @param {?=} validatorArguments
     * @return {?}
     */
    InputIssnComponent.getFormControlByDefault = /* Note: Before, this control worked well with a 'width' = '310px' or '285px'. */
    /**
     * Returns a `FormControl` by default.
     * It is used to initialized the `InputIssnComponent`'s `content.formControl` value by default.
     * In this case, the `validatorArguments` argument is always `undefined`.
     * @param {?=} validatorArguments
     * @return {?}
     */
    function (validatorArguments) {
        if (validatorArguments === void 0) { validatorArguments = undefined; }
        /** @type {?} */
        var res = new FormControl('', [
            ExtraValidators.equalLength(IssnValue.codeLength),
            Validators.pattern(IssnValue.regExpIssnWithLength_11),
            ExtraValidators.issnConfirmCheckDigitOneField(IssnValue.codeLength)
        ]);
        return res;
    };
    /**
     * @return {?}
     */
    InputIssnComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        /* Sets the default values. */
        this.init(IssnType_Abbreviation.ISSN, IssnValue.issn_Placeholder, true, true);
        if ((typeof this.content.value !== 'string') && (typeof this.content.value !== 'undefined')) {
            throw new Error("For the '" + this.content.name + "' control, the 'content.value' value must be of string type.");
        }
        /* The '_codeOldValue' must be set after the 'content.formControl.value' is set. */
        this.handleSpecificInput();
    };
    /**
      * Returns an error string if the control is in an error state; otherwise, empty string.
      */
    /**
     * Returns an error string if the control is in an error state; otherwise, empty string.
     * @return {?}
     */
    InputIssnComponent.prototype.getErrorMessage = /**
     * Returns an error string if the control is in an error state; otherwise, empty string.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var result = '';
        /** @type {?} */
        var result_alreadyHaveErrorInfo = false;
        /** @type {?} */
        var validationErrors = this.content.formControl.errors;
        /* Shows the code errors. */
        if (validationErrors) {
            if ((validationErrors[ExtraValidators.equalLength.name]) || (validationErrors[Validators.required.name])) {
                result = 'TOCO_NG_ERROR_MSG_ISSN_LONG_INVAL';
                result_alreadyHaveErrorInfo = true;
            }
            if (validationErrors[Validators.pattern.name]) {
                if (result_alreadyHaveErrorInfo) {
                    result = 'TOCO_NG_ERROR_MSG_ISSN_LONG_Y_DIG_INVAL';
                }
                else {
                    result = 'TOCO_NG_ERROR_MSG_ISSN_DIG_INVAL';
                }
                result_alreadyHaveErrorInfo = true;
            }
        }
        /* Only shows the `issnConfirmCheckDigitOneField` error if there isn't any previous error. */
        if (!result_alreadyHaveErrorInfo) {
            if (validationErrors) {
                if (validationErrors[ExtraValidators.issnConfirmCheckDigitOneField.name]) {
                    result = 'TOCO_NG_ERROR_MSG_ISSN_DIG_CHEQUEO_INVAL';
                    result_alreadyHaveErrorInfo = true;
                }
            }
        }
        return result;
    };
    /**
     * Handler method that is called by the internal logic when the control's value changes in the UI.
     * This method contains the specific handling of the input that the derived class wants to do.
     */
    /**
     * Handler method that is called by the internal logic when the control's value changes in the UI.
     * This method contains the specific handling of the input that the derived class wants to do.
     * @return {?}
     */
    InputIssnComponent.prototype.handleSpecificInput = /**
     * Handler method that is called by the internal logic when the control's value changes in the UI.
     * This method contains the specific handling of the input that the derived class wants to do.
     * @return {?}
     */
    function () {
        /* Forma de entrada del código ISSN por parte del usuario:
         * El control ISSN permite copiar códigos ISSN con el separador de menos (-) o con
         * el separador de raya (–), y son copiados correctamente para un código ISSN
         * con el separador de raya (–); es decir, los siguientes ejemplos muestran
         * el resultado de copiar una forma de código en particular.
         *  - Si se copia 01234560, entonces se muestra 0123 – 4560
         *  - Si se copia 0123-4560, entonces se muestra 0123 – 4560
         *  - Si se copia 0123 - 4560, entonces se muestra 0123 – 4560
         *  - Si se copia 0123–4560, entonces se muestra 0123 – 4560
         *  - Si se copia 0123 – 4560, entonces se muestra 0123 – 4560
         *  - Si se copia 0123 – 45601, entonces se muestra 0123 – 4560
         *  - Si se copia un código ISSN con más de 8 dígitos en la forma que sea,
         *    entonces no se copia y se sigue mostrando el código anterior.
         * Recuerde que el caracter 'x' or 'X' puede aparecer solamente en la última
         * posición del código ISSN. Además, aunque los dos caracteres significan lo mismo,
         * siempre se trata de mostrar el caracter 'X' en mayúscula.
         */
        /* Forma de entrada del código ISSN por parte del usuario:
                 * El control ISSN permite copiar códigos ISSN con el separador de menos (-) o con
                 * el separador de raya (–), y son copiados correctamente para un código ISSN
                 * con el separador de raya (–); es decir, los siguientes ejemplos muestran
                 * el resultado de copiar una forma de código en particular.
                 *  - Si se copia 01234560, entonces se muestra 0123 – 4560
                 *  - Si se copia 0123-4560, entonces se muestra 0123 – 4560
                 *  - Si se copia 0123 - 4560, entonces se muestra 0123 – 4560
                 *  - Si se copia 0123–4560, entonces se muestra 0123 – 4560
                 *  - Si se copia 0123 – 4560, entonces se muestra 0123 – 4560
                 *  - Si se copia 0123 – 45601, entonces se muestra 0123 – 4560
                 *  - Si se copia un código ISSN con más de 8 dígitos en la forma que sea,
                 *    entonces no se copia y se sigue mostrando el código anterior.
                 * Recuerde que el caracter 'x' or 'X' puede aparecer solamente en la última
                 * posición del código ISSN. Además, aunque los dos caracteres significan lo mismo,
                 * siempre se trata de mostrar el caracter 'X' en mayúscula.
                 */
        /** @type {?} */
        var tempCode = this.content.formControl.value;
        /** @type {?} */
        var len = tempCode.length;
        /* Checks that the code length can not be longer than `IssnValue.codeLength`. */
        if (len > IssnValue.codeLength) /* This case is used for code with length 11. */ {
            /* Sets the old value. */
            this.content.formControl.setValue(this._codeOldValue);
            return;
        }
        /** @type {?} */
        var i;
        /** @type {?} */
        var newCode = '';
        /** @type {?} */
        var alreadyHasSpace = false;
        /** @type {?} */
        var count = 0;
        for (i = 0; i < len; i++) {
            switch (tempCode[i]) {
                case '0':
                case '1':
                case '2':
                case '3':
                case '4':
                case '5':
                case '6':
                case '7':
                case '8':
                case '9':
                    {
                        if (((++count) == 4) && (!alreadyHasSpace)) {
                            alreadyHasSpace = true;
                            newCode += tempCode[i] + IssnValue.codeGroupSeparatorWithSpace;
                        }
                        else {
                            newCode += tempCode[i];
                        }
                        break;
                    }
                case 'x':
                case 'X':
                    {
                        if ((i + 1) == len) /* The 'x' or 'X' character can only appear in the last position. */ {
                            count++;
                            newCode += 'X';
                        }
                        break;
                    }
                case ' ':
                    {
                        if (!alreadyHasSpace) {
                            alreadyHasSpace = true;
                            newCode += IssnValue.codeGroupSeparatorWithSpace;
                        }
                        break;
                    }
            }
        }
        /* Checks that the code length can not be longer than `IssnValue.codeLength`. */
        if (count > 8) /* This case is used for code with length 8 and 9. */ {
            /* Sets the old value. */
            this.content.formControl.setValue(this._codeOldValue);
        }
        else {
            /* Sets the new value, and updates the old value. */
            this.content.formControl.setValue((this._codeOldValue = newCode));
        }
    };
    InputIssnComponent.decorators = [
        { type: Component, args: [{
                    selector: 'input-issn',
                    template: "\n<mat-form-field class=\"text-mat-form-field\" [appearance]=\"content.appearance\">\n<!-- <mat-form-field class=\"text-mat-form-field\" [appearance]=\"content.appearance\" [formGroup]=\"content.parentFormSection\"> -->\n\n    <mat-label>{{ content.label | translate }}</mat-label>\n\n    <input matInput [formControl]=\"content.formControl\" [required]=\"content.required\" [placeholder]=\"content.placeholder | translate\" [style.textAlign]=\"content.textAlign\" [attr.aria-label]=\"content.ariaLabel | translate\" (input)=\"handleInput()\" />\n    <!-- <input matInput id=\"inputId-{{ content.name }}\" class=\"input-text-element\" [formControl]=\"content.formControl\" [required]=\"content.required\" [placeholder]=\"content.placeholder | translate\" [style.textAlign]=\"content.textAlign\" [attr.aria-label]=\"content.ariaLabel | translate\" (input)=\"handleInput()\" [formControlName]=\"content.name\" /> -->\n\n    <!-- At the moment of writing this code (2019-08-03), I think that there is an error in `ng-container` or \n        `mat-icon` or something related because I can not put the `mat-icon` tag within an `ng-container` tag \n        because the normal layout of `mat-icon` is modified. This is a contradiction because the `ng-container` \n        does not interfere with styles or layout. -->\n\n    <!-- Only renders one of these two `mat-icon` or nothing. -->\n    <mat-icon *ngIf=\"content.prefixIcon && iconSourceState(content.prefixIcon, iconSource.internal)\" class=\"text-mat-icon-prefix mat-icon {{ content.appearance }} notranslate\" matPrefix [svgIcon]=\"content.prefixIcon.name\"></mat-icon>\n    <mat-icon *ngIf=\"content.prefixIcon && iconSourceState(content.prefixIcon, iconSource.external)\" class=\"text-mat-icon-prefix mat-icon {{ content.appearance }} notranslate\" matPrefix>{{ content.prefixIcon.name }}</mat-icon>\n\n    <!-- Only renders one of these two `mat-icon` or nothing. -->\n    <mat-icon *ngIf=\"content.suffixIcon && iconSourceState(content.suffixIcon, iconSource.internal)\" class=\"text-mat-icon-suffix mat-icon {{ content.appearance }} notranslate\" matSuffix [svgIcon]=\"content.suffixIcon.name\"></mat-icon>\n    <mat-icon *ngIf=\"content.suffixIcon && iconSourceState(content.suffixIcon, iconSource.external)\" class=\"text-mat-icon-suffix mat-icon {{ content.appearance }} notranslate\" matSuffix>{{ content.suffixIcon.name }}</mat-icon>\n\n    <span *ngIf=\"content.prefixText\" matPrefix><pre class=\"content.appearance\">{{ content.prefixText }}</pre></span>\n    <span *ngIf=\"content.suffixText\" matSuffix><pre class=\"content.appearance\">{{ content.suffixText }}</pre></span>\n\n    <mat-hint *ngIf=\"hintState && content.startHint\" [align]=\"'start'\">{{ content.startHint.label | translate }}</mat-hint>\n    <mat-hint *ngIf=\"hintState && content.endHint\" [align]=\"'end'\">{{ content.endHint.label | translate }}</mat-hint>\n    <mat-error *ngIf=\"errorState\">\n        <ng-container *ngIf=\"isTranslationBuiltByControl; then thenTemplate_BuildTranslation; else elseTemplate_NotBuildTranslation\"></ng-container>\n\n        <ng-template #thenTemplate_BuildTranslation>{{ getErrorMessage() }}</ng-template>\n\n        <ng-template #elseTemplate_NotBuildTranslation>{{ getErrorMessage() | translate }}</ng-template>\n    </mat-error>\n\n</mat-form-field>\n",
                    host: {
                        '[style.minWidth]': 'content.minWidth',
                        '[style.width]': 'content.width'
                    },
                    styles: [".text-mat-form-field{width:100%;cursor:text}.text-mat-icon-prefix{margin-right:8px}.text-mat-icon-prefix.standard{position:relative;top:4px}.text-mat-icon-suffix{margin-left:8px}.text-mat-icon-suffix.standard{position:relative;top:4px}pre{margin:0}pre.outline{position:relative;bottom:4px}"]
                }] }
    ];
    /** @nocollapse */
    InputIssnComponent.ctorParameters = function () { return []; };
    return InputIssnComponent;
}(InputControl));
export { InputIssnComponent };
if (false) {
    /**
     * It is used by `handleSpecificInput` method.
     * @type {?}
     * @private
     */
    InputIssnComponent.prototype._codeOldValue;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXNzbi1pbnB1dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90b2NvLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9mb3Jtcy9pbnB1dC9pc3NuL2lzc24taW5wdXQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFDbEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQW9CLE1BQU0sZ0JBQWdCLENBQUM7QUFFM0UsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBRWhFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxTQUFTLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDaEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGtCQUFrQixDQUFDOzs7Ozs7Ozs7OztBQWFoRDtJQVN3Qyw4Q0FBWTtJQXlCaEQ7UUFBQSxZQUVJLGlCQUFPLFNBR1Y7UUFERyxLQUFJLENBQUMsYUFBYSxHQUFHLFNBQVMsQ0FBQzs7SUFDbkMsQ0FBQztJQTVCRCxpRkFBaUY7SUFFakY7Ozs7T0FJRzs7Ozs7Ozs7O0lBQ1csMENBQXVCOzs7Ozs7OztJQUFyQyxVQUFzQyxrQkFBa0Q7UUFBbEQsbUNBQUEsRUFBQSw4QkFBa0Q7O1lBRWhGLEdBQUcsR0FBZ0IsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUFFO1lBQ3ZDLGVBQWUsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQztZQUNqRCxVQUFVLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyx1QkFBdUIsQ0FBQztZQUNyRCxlQUFlLENBQUMsNkJBQTZCLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQztTQUN0RSxDQUFDO1FBRUYsT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDOzs7O0lBY00scUNBQVE7OztJQUFmO1FBRUksOEJBQThCO1FBRTlCLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxF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WTtvQkFDdEIseXdHQUFnRDtvQkFFaEQsSUFBSSxFQUFFO3dCQUNGLGtCQUFrQixFQUFFLGtCQUFrQjt3QkFDdEMsZUFBZSxFQUFFLGVBQWU7cUJBQ25DOztpQkFDSjs7OztJQStMRCx5QkFBQztDQUFBLEFBdk1ELENBU3dDLFlBQVksR0E4TG5EO1NBOUxZLGtCQUFrQjs7Ozs7OztJQXVCM0IsMkNBQThCIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRm9ybUNvbnRyb2wsIFZhbGlkYXRvcnMsIFZhbGlkYXRpb25FcnJvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IEV4dHJhVmFsaWRhdG9ycyB9IGZyb20gJy4uLy4uLy4uL2NvcmUvdXRpbHMvdmFsaWRhdG9yJztcblxuaW1wb3J0IHsgSXNzblR5cGVfQWJicmV2aWF0aW9uLCBJc3NuVmFsdWUgfSBmcm9tICcuL2lzc24tdmFsdWUnO1xuaW1wb3J0IHsgSW5wdXRDb250cm9sIH0gZnJvbSAnLi4vaW5wdXQuY29udHJvbCc7XG5pbXBvcnQgeyBWYWxpZGF0b3JBcmd1bWVudHMgfSBmcm9tICcuLi8uLi9mb3JtLWZpZWxkLmNvbnRyb2wnO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBjb250cm9sIHRoYXQgYWxsb3dzIHRoZSB3cml0aW5nIG9mIGFuIElTU04uIFxuICogQW4gSVNTTiAoSW50ZXJuYXRpb25hbCBTdGFuZGFyZCBTZXJpYWwgTnVtYmVyKSBpcyBhbiA4LWRpZ2l0IGNvZGUuIFxuICogVGhpcyBjb250cm9sIHN0b3JlcyB0aGUgY29kZSBhcyBhIHN0cmluZyBvZiBsZW5ndGggMTEsIHdpdGggdGhlIGZvcm0gJ1hYWFgg4oCTIFhYWFgnLiBcbiAqIEl0IGlzIHVzZWQgdG8gaWRlbnRpZnkgbmV3c3BhcGVycywgam91cm5hbHMsIG1hZ2F6aW5lcyBhbmQgcGVyaW9kaWNhbHMgXG4gKiBvZiBhbGwga2luZHMgYW5kIG9uIGFsbCBtZWRpYeKAk3ByaW50IGFuZCBlbGVjdHJvbmljLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBcbiAqIGZvbGxvdyB0aGUgbGluazogaHR0cHM6Ly93d3cuaXNzbi5vcmcvdW5kZXJzdGFuZGluZy10aGUtaXNzbi93aGF0LWlzLWFuLWlzc24vLiBcbiAqIEl0IHVzZXMgdGhlIGBJc3NuVHlwZV9BYmJyZXZpYXRpb24uSVNTTmAgYXMgYSBsYWJlbCBpZiB0aGUgYGNvbnRlbnQubGFiZWxgIGlzIG5vdCBzcGVjaWZpZWQuIFxuICogSXQgdXNlcyB0aGUgYElzc25WYWx1ZS5pc3NuX1BsYWNlaG9sZGVyYCBhcyBhIHBsYWNlaG9sZGVyIGlmIHRoZSBgY29udGVudC5wbGFjZWhvbGRlcmAgaXMgbm90IHNwZWNpZmllZC4gXG4gKi9cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnaW5wdXQtaXNzbicsXG4gICAgdGVtcGxhdGVVcmw6ICcuLi90ZXh0L3RleHQtaW5wdXQuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuLi90ZXh0L3RleHQtaW5wdXQuY29tcG9uZW50LnNjc3MnXSxcbiAgICBob3N0OiB7XG4gICAgICAgICdbc3R5bGUubWluV2lkdGhdJzogJ2NvbnRlbnQubWluV2lkdGgnLFxuICAgICAgICAnW3N0eWxlLndpZHRoXSc6ICdjb250ZW50LndpZHRoJ1xuICAgIH1cbn0pXG5leHBvcnQgY2xhc3MgSW5wdXRJc3NuQ29tcG9uZW50IGV4dGVuZHMgSW5wdXRDb250cm9sIGltcGxlbWVudHMgT25Jbml0XG57XG4gICAgLyogTm90ZTogQmVmb3JlLCB0aGlzIGNvbnRyb2wgd29ya2VkIHdlbGwgd2l0aCBhICd3aWR0aCcgPSAnMzEwcHgnIG9yICcyODVweCcuICovXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgYEZvcm1Db250cm9sYCBieSBkZWZhdWx0LiBcbiAgICAgKiBJdCBpcyB1c2VkIHRvIGluaXRpYWxpemVkIHRoZSBgSW5wdXRJc3NuQ29tcG9uZW50YCdzIGBjb250ZW50LmZvcm1Db250cm9sYCB2YWx1ZSBieSBkZWZhdWx0LiBcbiAgICAgKiBJbiB0aGlzIGNhc2UsIHRoZSBgdmFsaWRhdG9yQXJndW1lbnRzYCBhcmd1bWVudCBpcyBhbHdheXMgYHVuZGVmaW5lZGAuIFxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZ2V0Rm9ybUNvbnRyb2xCeURlZmF1bHQodmFsaWRhdG9yQXJndW1lbnRzOiBWYWxpZGF0b3JBcmd1bWVudHMgPSB1bmRlZmluZWQpOiBGb3JtQ29udHJvbFxuICAgIHtcbiAgICAgICAgbGV0IHJlczogRm9ybUNvbnRyb2wgPSBuZXcgRm9ybUNvbnRyb2woJycsIFtcbiAgICAgICAgICAgIEV4dHJhVmFsaWRhdG9ycy5lcXVhbExlbmd0aChJc3NuVmFsdWUuY29kZUxlbmd0aCksXG4gICAgICAgICAgICBWYWxpZGF0b3JzLnBhdHRlcm4oSXNzblZhbHVlLnJlZ0V4cElzc25XaXRoTGVuZ3RoXzExKSxcbiAgICAgICAgICAgIEV4dHJhVmFsaWRhdG9ycy5pc3NuQ29uZmlybUNoZWNrRGlnaXRPbmVGaWVsZChJc3NuVmFsdWUuY29kZUxlbmd0aClcbiAgICAgICAgXSk7XG5cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG5cblx0LyoqXG5cdCAqIEl0IGlzIHVzZWQgYnkgYGhhbmRsZVNwZWNpZmljSW5wdXRgIG1ldGhvZC4gXG5cdCAqL1xuICAgIHByaXZhdGUgX2NvZGVPbGRWYWx1ZTogc3RyaW5nO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKClcbiAgICB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5fY29kZU9sZFZhbHVlID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkXG4gICAge1xuICAgICAgICAvKiBTZXRzIHRoZSBkZWZhdWx0IHZhbHVlcy4gKi9cblxuICAgICAgICB0aGlzLmluaXQoSXNzblR5cGVfQWJicmV2aWF0aW9uLklTU04sIElzc25WYWx1ZS5pc3NuX1BsYWNlaG9sZGVyLCB0cnVlLCB0cnVlKTtcblxuICAgICAgICBpZiAoKHR5cGVvZiB0aGlzLmNvbnRlbnQudmFsdWUgIT09ICdzdHJpbmcnKSAmJiAodHlwZW9mIHRoaXMuY29udGVudC52YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvciB0aGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wsIHRoZSAnY29udGVudC52YWx1ZScgdmFsdWUgbXVzdCBiZSBvZiBzdHJpbmcgdHlwZS5gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIFRoZSAnX2NvZGVPbGRWYWx1ZScgbXVzdCBiZSBzZXQgYWZ0ZXIgdGhlICdjb250ZW50LmZvcm1Db250cm9sLnZhbHVlJyBpcyBzZXQuICovXG4gICAgICAgIHRoaXMuaGFuZGxlU3BlY2lmaWNJbnB1dCgpO1xuICAgIH1cblxuICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBlcnJvciBzdHJpbmcgaWYgdGhlIGNvbnRyb2wgaXMgaW4gYW4gZXJyb3Igc3RhdGU7IG90aGVyd2lzZSwgZW1wdHkgc3RyaW5nLiBcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0RXJyb3JNZXNzYWdlKCk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgbGV0IHJlc3VsdDogc3RyaW5nID0gJyc7XG4gICAgICAgIGxldCByZXN1bHRfYWxyZWFkeUhhdmVFcnJvckluZm86IGJvb2xlYW4gPSBmYWxzZTtcbiAgICAgICAgbGV0IHZhbGlkYXRpb25FcnJvcnM6IFZhbGlkYXRpb25FcnJvcnMgPSB0aGlzLmNvbnRlbnQuZm9ybUNvbnRyb2wuZXJyb3JzO1xuXG4gICAgICAgIC8qIFNob3dzIHRoZSBjb2RlIGVycm9ycy4gKi9cblxuICAgICAgICBpZiAodmFsaWRhdGlvbkVycm9ycylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCh2YWxpZGF0aW9uRXJyb3JzW0V4dHJhVmFsaWRhdG9ycy5lcXVhbExlbmd0aC5uYW1lXSkgfHwgKHZhbGlkYXRpb25FcnJvcnNbVmFsaWRhdG9ycy5yZXF1aXJlZC5uYW1lXSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gJ1RPQ09fTkdfRVJST1JfTVNHX0lTU05fTE9OR19JTlZBTCc7XG4gICAgICAgICAgICAgICAgcmVzdWx0X2FscmVhZHlIYXZlRXJyb3JJbmZvID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZhbGlkYXRpb25FcnJvcnNbVmFsaWRhdG9ycy5wYXR0ZXJuLm5hbWVdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRfYWxyZWFkeUhhdmVFcnJvckluZm8pXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSAnVE9DT19OR19FUlJPUl9NU0dfSVNTTl9MT05HX1lfRElHX0lOVkFMJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gJ1RPQ09fTkdfRVJST1JfTVNHX0lTU05fRElHX0lOVkFMJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHRfYWxyZWFkeUhhdmVFcnJvckluZm8gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblx0XHQvKiBPbmx5IHNob3dzIHRoZSBgaXNzbkNvbmZpcm1DaGVja0RpZ2l0T25lRmllbGRgIGVycm9yIGlmIHRoZXJlIGlzbid0IGFueSBwcmV2aW91cyBlcnJvci4gKi9cblx0XHRpZiAoIXJlc3VsdF9hbHJlYWR5SGF2ZUVycm9ySW5mbylcblx0XHR7XG4gICAgICAgICAgICBpZiAodmFsaWRhdGlvbkVycm9ycylcblx0XHRcdHtcblx0XHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcnNbRXh0cmFWYWxpZGF0b3JzLmlzc25Db25maXJtQ2hlY2tEaWdpdE9uZUZpZWxkLm5hbWVdKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cmVzdWx0ID0gJ1RPQ09fTkdfRVJST1JfTVNHX0lTU05fRElHX0NIRVFVRU9fSU5WQUwnO1xuXHRcdFx0XHRcdHJlc3VsdF9hbHJlYWR5SGF2ZUVycm9ySW5mbyA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cblx0LyoqXG5cdCAqIEhhbmRsZXIgbWV0aG9kIHRoYXQgaXMgY2FsbGVkIGJ5IHRoZSBpbnRlcm5hbCBsb2dpYyB3aGVuIHRoZSBjb250cm9sJ3MgdmFsdWUgY2hhbmdlcyBpbiB0aGUgVUkuIFxuICAgICAqIFRoaXMgbWV0aG9kIGNvbnRhaW5zIHRoZSBzcGVjaWZpYyBoYW5kbGluZyBvZiB0aGUgaW5wdXQgdGhhdCB0aGUgZGVyaXZlZCBjbGFzcyB3YW50cyB0byBkby4gXG5cdCAqL1xuXHRwdWJsaWMgaGFuZGxlU3BlY2lmaWNJbnB1dCgpOiB2b2lkXG5cdHtcbiAgICAgICAgLyogRm9ybWEgZGUgZW50cmFkYSBkZWwgY8OzZGlnbyBJU1NOIHBvciBwYXJ0ZSBkZWwgdXN1YXJpbzogXG4gICAgICAgICAqIEVsIGNvbnRyb2wgSVNTTiBwZXJtaXRlIGNvcGlhciBjw7NkaWdvcyBJU1NOIGNvbiBlbCBzZXBhcmFkb3IgZGUgbWVub3MgKC0pIG8gY29uIFxuICAgICAgICAgKiBlbCBzZXBhcmFkb3IgZGUgcmF5YSAo4oCTKSwgeSBzb24gY29waWFkb3MgY29ycmVjdGFtZW50ZSBwYXJhIHVuIGPDs2RpZ28gSVNTTiBcbiAgICAgICAgICogY29uIGVsIHNlcGFyYWRvciBkZSByYXlhICjigJMpOyBlcyBkZWNpciwgbG9zIHNpZ3VpZW50ZXMgZWplbXBsb3MgbXVlc3RyYW4gXG4gICAgICAgICAqIGVsIHJlc3VsdGFkbyBkZSBjb3BpYXIgdW5hIGZvcm1hIGRlIGPDs2RpZ28gZW4gcGFydGljdWxhci4gXG4gICAgICAgICAqICAtIFNpIHNlIGNvcGlhIDAxMjM0NTYwLCBlbnRvbmNlcyBzZSBtdWVzdHJhIDAxMjMg4oCTIDQ1NjBcbiAgICAgICAgICogIC0gU2kgc2UgY29waWEgMDEyMy00NTYwLCBlbnRvbmNlcyBzZSBtdWVzdHJhIDAxMjMg4oCTIDQ1NjBcbiAgICAgICAgICogIC0gU2kgc2UgY29waWEgMDEyMyAtIDQ1NjAsIGVudG9uY2VzIHNlIG11ZXN0cmEgMDEyMyDigJMgNDU2MFxuICAgICAgICAgKiAgLSBTaSBzZSBjb3BpYSAwMTIz4oCTNDU2MCwgZW50b25jZXMgc2UgbXVlc3RyYSAwMTIzIOKAkyA0NTYwXG4gICAgICAgICAqICAtIFNpIHNlIGNvcGlhIDAxMjMg4oCTIDQ1NjAsIGVudG9uY2VzIHNlIG11ZXN0cmEgMDEyMyDigJMgNDU2MFxuICAgICAgICAgKiAgLSBTaSBzZSBjb3BpYSAwMTIzIOKAkyA0NTYwMSwgZW50b25jZXMgc2UgbXVlc3RyYSAwMTIzIOKAkyA0NTYwXG4gICAgICAgICAqICAtIFNpIHNlIGNvcGlhIHVuIGPDs2RpZ28gSVNTTiBjb24gbcOhcyBkZSA4IGTDrWdpdG9zIGVuIGxhIGZvcm1hIHF1ZSBzZWEsIFxuICAgICAgICAgKiAgICBlbnRvbmNlcyBubyBzZSBjb3BpYSB5IHNlIHNpZ3VlIG1vc3RyYW5kbyBlbCBjw7NkaWdvIGFudGVyaW9yLiBcbiAgICAgICAgICogUmVjdWVyZGUgcXVlIGVsIGNhcmFjdGVyICd4JyBvciAnWCcgcHVlZGUgYXBhcmVjZXIgc29sYW1lbnRlIGVuIGxhIMO6bHRpbWEgXG4gICAgICAgICAqIHBvc2ljacOzbiBkZWwgY8OzZGlnbyBJU1NOLiBBZGVtw6FzLCBhdW5xdWUgbG9zIGRvcyBjYXJhY3RlcmVzIHNpZ25pZmljYW4gbG8gbWlzbW8sIFxuICAgICAgICAgKiBzaWVtcHJlIHNlIHRyYXRhIGRlIG1vc3RyYXIgZWwgY2FyYWN0ZXIgJ1gnIGVuIG1hecO6c2N1bGEuIFxuICAgICAgICAgKi9cblxuICAgICAgICBsZXQgdGVtcENvZGU6IHN0cmluZyA9IHRoaXMuY29udGVudC5mb3JtQ29udHJvbC52YWx1ZTtcbiAgICAgICAgbGV0IGxlbjogbnVtYmVyID0gdGVtcENvZGUubGVuZ3RoO1xuXG4gICAgICAgIC8qIENoZWNrcyB0aGF0IHRoZSBjb2RlIGxlbmd0aCBjYW4gbm90IGJlIGxvbmdlciB0aGFuIGBJc3NuVmFsdWUuY29kZUxlbmd0aGAuICovXG5cdFx0aWYgKGxlbiA+IElzc25WYWx1ZS5jb2RlTGVuZ3RoKSAgLyogVGhpcyBjYXNlIGlzIHVzZWQgZm9yIGNvZGUgd2l0aCBsZW5ndGggMTEuICovXG5cdFx0e1xuXHRcdFx0LyogU2V0cyB0aGUgb2xkIHZhbHVlLiAqL1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LmZvcm1Db250cm9sLnNldFZhbHVlKHRoaXMuX2NvZGVPbGRWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaTogbnVtYmVyO1xuICAgICAgICBsZXQgbmV3Q29kZTogc3RyaW5nID0gJyc7XG4gICAgICAgIGxldCBhbHJlYWR5SGFzU3BhY2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICAgICAgbGV0IGNvdW50OiBudW1iZXIgPSAwO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgc3dpdGNoKHRlbXBDb2RlW2ldKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNhc2UgJzAnOiBjYXNlICcxJzogY2FzZSAnMic6IGNhc2UgJzMnOiBjYXNlICc0JzpcbiAgICAgICAgICAgICAgICBjYXNlICc1JzogY2FzZSAnNic6IGNhc2UgJzcnOiBjYXNlICc4JzogY2FzZSAnOSc6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKCgrK2NvdW50KSA9PSA0KSAmJiAoIWFscmVhZHlIYXNTcGFjZSkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscmVhZHlIYXNTcGFjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2RlICs9IHRlbXBDb2RlW2ldICsgSXNzblZhbHVlLmNvZGVHcm91cFNlcGFyYXRvcldpdGhTcGFjZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvZGUgKz0gdGVtcENvZGVbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FzZSAneCc6IGNhc2UgJ1gnOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChpICsgMSkgPT0gbGVuKSAgLyogVGhlICd4JyBvciAnWCcgY2hhcmFjdGVyIGNhbiBvbmx5IGFwcGVhciBpbiB0aGUgbGFzdCBwb3NpdGlvbi4gKi9cbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvZGUgKz0gJ1gnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNhc2UgJyAnOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhbHJlYWR5SGFzU3BhY2UpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscmVhZHlIYXNTcGFjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2RlICs9IElzc25WYWx1ZS5jb2RlR3JvdXBTZXBhcmF0b3JXaXRoU3BhY2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogQ2hlY2tzIHRoYXQgdGhlIGNvZGUgbGVuZ3RoIGNhbiBub3QgYmUgbG9uZ2VyIHRoYW4gYElzc25WYWx1ZS5jb2RlTGVuZ3RoYC4gKi9cbiAgICAgICAgaWYgKGNvdW50ID4gOCkgIC8qIFRoaXMgY2FzZSBpcyB1c2VkIGZvciBjb2RlIHdpdGggbGVuZ3RoIDggYW5kIDkuICovXG5cdFx0e1xuXHRcdFx0LyogU2V0cyB0aGUgb2xkIHZhbHVlLiAqL1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LmZvcm1Db250cm9sLnNldFZhbHVlKHRoaXMuX2NvZGVPbGRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvKiBTZXRzIHRoZSBuZXcgdmFsdWUsIGFuZCB1cGRhdGVzIHRoZSBvbGQgdmFsdWUuICovXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuZm9ybUNvbnRyb2wuc2V0VmFsdWUoKHRoaXMuX2NvZGVPbGRWYWx1ZSA9IG5ld0NvZGUpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==