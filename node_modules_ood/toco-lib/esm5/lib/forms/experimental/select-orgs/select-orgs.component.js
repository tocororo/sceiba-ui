/**
 * @fileoverview added by tsickle
 * Generated from: lib/forms/experimental/select-orgs/select-orgs.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { FormControl } from '@angular/forms';
import { InputControl } from '../../input/input.control';
import { OrganizationServiceNoAuth } from '../../../backend/organization.service';
import { HttpParams } from '@angular/common/http';
import { HitList } from '../../../entities/common';
/**
 * @record
 */
function SelectOrgsComponentExtraContent() { }
if (false) {
    /** @type {?} */
    SelectOrgsComponentExtraContent.prototype.multiple;
    /** @type {?} */
    SelectOrgsComponentExtraContent.prototype.selectedOrgsIds;
    /**
     * Input `orgFilter` is a dict with `type` and `value` to filter the organizations,
     * \@Example { type: 'country' , value: 'Cuba" }
     * @type {?}
     */
    SelectOrgsComponentExtraContent.prototype.orgFilter;
}
var SelectOrgsComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SelectOrgsComponent, _super);
    function SelectOrgsComponent(_orgService) {
        var _this = _super.call(this) || this;
        _this._orgService = _orgService;
        /**
         * Input `orgCtrl` is a FormControl
         */
        _this.orgCtrl = new FormControl();
        _this.filteredOrg = new HitList();
        _this.params = new HttpParams();
        _this.placeholder = "Escriba al menos 3 letras";
        _this.label = "Busque una organizaciÃ³n";
        _this.appearance = "outline";
        /**
         * Input `cleaning` is a boolen, if true then clean the search
         */
        _this.cleaning = false;
        _this.selectedOrg = new EventEmitter();
        _this.chipsList = [];
        _this.loading = false;
        _this.toSearch = 0;
        return _this;
    }
    /**
     * @return {?}
     */
    SelectOrgsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.init('', '', false, false);
        this.extraContent = this.content.extraContent;
        this.content.value = [];
        this.extraContent.selectedOrgsIds.forEach((/**
         * @param {?} uuid
         * @return {?}
         */
        function (uuid) {
            _this._orgService.getOrganizationByUUID(uuid).subscribe({
                next: (/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    _this.addChips(response);
                })
            });
        }));
        this.params = this.params.set('size', '10');
        this.params = this.params.set('page', '1');
        if (this.extraContent.orgFilter != undefined) {
            this.params = this.params.set(this.extraContent.orgFilter.type, this.extraContent.orgFilter.value);
        }
        this.orgCtrl.valueChanges
            .subscribe({
            next: (/**
             * @param {?} orgValueChanges
             * @return {?}
             */
            function (orgValueChanges) {
                _this.toSearch++;
                // this condition check if the param is a `string` an if at least write 3 letters
                if (_this.toSearch > 3 && typeof orgValueChanges === 'string') {
                    _this.toSearch = 0;
                    _this.params = _this.params.set('q', orgValueChanges);
                    _this.loading = true;
                    _this._orgService.getOrganizations(_this.params).subscribe({
                        next: (/**
                         * @param {?} response
                         * @return {?}
                         */
                        function (response) {
                            _this.filteredOrg = response.hits;
                            _this.loading = false;
                        })
                    });
                }
                else if (typeof orgValueChanges === 'object') {
                    _this.toSearch = 0;
                    _this.selectedOrg.emit(orgValueChanges);
                    if (_this.cleaning) {
                        _this.orgCtrl.setValue('');
                    }
                }
            })
        });
    };
    /* This function return the organization name
     * @param org the Organization object
     */
    /* This function return the organization name
        * @param org the Organization object
        */
    /**
     * @param {?=} org
     * @return {?}
     */
    SelectOrgsComponent.prototype.displayFn = /* This function return the organization name
        * @param org the Organization object
        */
    /**
     * @param {?=} org
     * @return {?}
     */
    function (org) {
        return org ? org.name : undefined;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    SelectOrgsComponent.prototype.addChips = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this.extraContent.multiple) {
            if (!this.chipsList.find((/**
             * @param {?} x
             * @return {?}
             */
            function (x) { return x.id == value.id; }))) {
                this.chipsList.unshift(value);
                this.content.value.unshift(value);
            }
        }
        else {
            this.chipsList = [value];
            this.content.value = [value];
        }
        this.content.formControl.setValue(this.content.value);
        this.orgCtrl.setValue("");
        this.filteredOrg = new HitList();
    };
    /**
     * @param {?} index
     * @return {?}
     */
    SelectOrgsComponent.prototype.removeChip = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        /** @type {?} */
        var todelete = this.chipsList[index];
        this.content.value = ((/** @type {?} */ (this.content.value))).filter((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.id !== todelete.id; }));
        this.content.formControl.setValue(this.content.value);
        this.chipsList.splice(index, 1);
    };
    SelectOrgsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'toco-select-org',
                    template: "<mat-card>\n\n\n  <mat-card-subtitle>\n    <mat-form-field style=\"width: 100%;height: 100%;\">\n\n      <mat-label> {{content.label}} <span *ngIf=\"content.required\">*</span></mat-label>\n      <input matInput placeholder=\"{{placeholder}}\" aria-label=\"Buscar\" [matAutocomplete]=\"auto\" [formControl]=\"orgCtrl\">\n      <input\n        matInput\n        id=\"'inputId-'{{content.name}}\"\n        type=\"text\"\n        [formControl]=\"orgCtrl\"\n        [matAutocomplete]=\"auto\"\n          aria-label=\"Number\"\n      />\n\n      <mat-hint *ngIf=\"content.startHint\" [align]=\"'start'\">{{ content.startHint.label }}</mat-hint>\n\n      <mat-autocomplete #auto=\"matAutocomplete\" [displayWith]=\"displayFn\">\n\n        <mat-option *ngFor=\"let org of filteredOrg.hits\" [value]=\"org.metadata\" (click)=\"addChips(org)\">\n            <span title=\"{{org.metadata.name}}\">{{org.metadata.name}}</span>\n        </mat-option>\n\n      </mat-autocomplete>\n\n      <!-- <button mat-icon-button color=\"accent\" class=\"delete-filter\" (click)=\"remove_component()\">\n        <mat-icon>close</mat-icon>\n      </button> -->\n    </mat-form-field>\n  </mat-card-subtitle>\n\n  <mat-progress-bar\n    mode=\"indeterminate\"\n    *ngIf=\"loading\">\n  </mat-progress-bar>\n\n  <mat-card-content *ngIf=\"!loading\">\n    <mat-chip-list class=\"mat-chip-list-stacked\" fxLayout=\"row\" fxLayoutAlign=\"start center\" style=\"margin-bottom: .5em\"\n      id=\"chiplist-{{content.name}}\">\n      <mat-chip *ngFor=\"let item of chipsList; let i=index\" (removed)=\"removeChip(i)\" [removable]=\"true\" style=\"width: 100%;height: 100%;\">\n        {{ item.metadata.name }}\n        <mat-icon matChipRemove>cancel</mat-icon>\n      </mat-chip>\n    </mat-chip-list>\n  </mat-card-content>\n\n</mat-card>\n",
                    host: {
                        "[style.minWidth]": "content.minWidth",
                        "[style.width]": "content.width"
                    },
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SelectOrgsComponent.ctorParameters = function () { return [
        { type: OrganizationServiceNoAuth }
    ]; };
    SelectOrgsComponent.propDecorators = {
        orgCtrl: [{ type: Input }],
        placeholder: [{ type: Input }],
        label: [{ type: Input }],
        appearance: [{ type: Input }],
        cleaning: [{ type: Input }],
        selectedOrg: [{ type: Output }]
    };
    return SelectOrgsComponent;
}(InputControl));
export { SelectOrgsComponent };
if (false) {
    /**
     * Input `orgCtrl` is a FormControl
     * @type {?}
     */
    SelectOrgsComponent.prototype.orgCtrl;
    /** @type {?} */
    SelectOrgsComponent.prototype.filteredOrg;
    /** @type {?} */
    SelectOrgsComponent.prototype.params;
    /** @type {?} */
    SelectOrgsComponent.prototype.placeholder;
    /** @type {?} */
    SelectOrgsComponent.prototype.label;
    /** @type {?} */
    SelectOrgsComponent.prototype.appearance;
    /**
     * Input `cleaning` is a boolen, if true then clean the search
     * @type {?}
     */
    SelectOrgsComponent.prototype.cleaning;
    /** @type {?} */
    SelectOrgsComponent.prototype.selectedOrg;
    /** @type {?} */
    SelectOrgsComponent.prototype.chipsList;
    /** @type {?} */
    SelectOrgsComponent.prototype.extraContent;
    /** @type {?} */
    SelectOrgsComponent.prototype.loading;
    /** @type {?} */
    SelectOrgsComponent.prototype.toSearch;
    /**
     * @type {?}
     * @private
     */
    SelectOrgsComponent.prototype._orgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LW9yZ3MuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vdG9jby1saWIvIiwic291cmNlcyI6WyJsaWIvZm9ybXMvZXhwZXJpbWVudGFsL3NlbGVjdC1vcmdzL3NlbGVjdC1vcmdzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQy9FLE9BQU8sRUFBRSxXQUFXLEVBQXFDLE1BQU0sZ0JBQWdCLENBQUM7QUFFaEYsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3pELE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQU8sT0FBTyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7Ozs7QUFHeEQsOENBU0M7OztJQVJDLG1EQUFrQjs7SUFDbEIsMERBQW9COzs7Ozs7SUFLcEIsb0RBQTBDOztBQUk1QztJQVN5QywrQ0FBWTtJQXFDbEQsNkJBQXFCLFdBQXNDO1FBQTNELFlBQWdFLGlCQUFPLFNBQUU7UUFBcEQsaUJBQVcsR0FBWCxXQUFXLENBQTJCOzs7O1FBOUIzRCxhQUFPLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztRQUU1QixpQkFBVyxHQUFHLElBQUssT0FBTyxFQUFnQixDQUFDO1FBRTNDLFlBQU0sR0FBRSxJQUFJLFVBQVUsRUFBRSxDQUFDO1FBSXpCLGlCQUFXLEdBQVcsMkJBQTJCLENBQUM7UUFHbEQsV0FBSyxHQUFXLHlCQUF5QixDQUFDO1FBRzFDLGdCQUFVLEdBQVcsU0FBUyxDQUFDOzs7O1FBTS9CLGNBQVEsR0FBWSxLQUFLLENBQUM7UUFHMUIsaUJBQVcsR0FBK0IsSUFBSSxZQUFZLEVBQWdCLENBQUM7UUFFM0UsZUFBUyxHQUF3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SyxRQUFRLENBQUMsRUFBRSxFQUFwQixDQUFvQixFQUMvQyxDQUFDO1FBQ0YsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7O2dCQXZIRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLGlCQUFpQjtvQkFDM0IsNnhEQUEyQztvQkFFM0MsSUFBSSxFQUFFO3dCQUNKLGtCQUFrQixFQUFFLGtCQUFrQjt3QkFDdEMsZUFBZSxFQUFFLGVBQWU7cUJBQ2pDOztpQkFDRjs7OztnQkF4QlEseUJBQXlCOzs7MEJBK0I5QixLQUFLOzhCQVFMLEtBQUs7d0JBR0wsS0FBSzs2QkFHTCxLQUFLOzJCQU1MLEtBQUs7OEJBR0wsTUFBTTs7SUFrRlYsMEJBQUM7Q0FBQSxBQXhIRCxDQVN5QyxZQUFZLEdBK0dwRDtTQS9HWSxtQkFBbUI7Ozs7OztJQU03QixzQ0FDNEI7O0lBRTVCLDBDQUEyQzs7SUFFM0MscUNBQXlCOztJQUd6QiwwQ0FDa0Q7O0lBRWxELG9DQUMwQzs7SUFFMUMseUNBQytCOzs7OztJQUsvQix1Q0FDMEI7O0lBRTFCLDBDQUMyRTs7SUFFM0Usd0NBQW9DOztJQUNwQywyQ0FBOEM7O0lBQzlDLHNDQUFnQjs7SUFFaEIsdUNBQVc7Ozs7O0lBQ0UsMENBQThDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRm9ybUNvbnRyb2wsIEFic3RyYWN0Q29udHJvbCwgVmFsaWRhdGlvbkVycm9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuaW1wb3J0IHsgSW5wdXRDb250cm9sIH0gZnJvbSAnLi4vLi4vaW5wdXQvaW5wdXQuY29udHJvbCc7XG5pbXBvcnQgeyBPcmdhbml6YXRpb25TZXJ2aWNlTm9BdXRoIH0gZnJvbSAnLi4vLi4vLi4vYmFja2VuZC9vcmdhbml6YXRpb24uc2VydmljZSc7XG5pbXBvcnQgeyBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgSGl0LCBIaXRMaXN0IH0gZnJvbSAnLi4vLi4vLi4vZW50aXRpZXMvY29tbW9uJztcbmltcG9ydCB7IE9yZ2FuaXphdGlvbiB9IGZyb20gJy4uLy4uLy4uL2VudGl0aWVzL29yZ2FuaXphdGlvbi5lbnRpdHknO1xuXG5pbnRlcmZhY2UgU2VsZWN0T3Jnc0NvbXBvbmVudEV4dHJhQ29udGVudHtcbiAgbXVsdGlwbGU6IGJvb2xlYW47XG4gIHNlbGVjdGVkT3Jnc0lkczogW107XG4gIC8qKlxuICAgICogSW5wdXQgYG9yZ0ZpbHRlcmAgaXMgYSBkaWN0IHdpdGggYHR5cGVgIGFuZCBgdmFsdWVgIHRvIGZpbHRlciB0aGUgb3JnYW5pemF0aW9ucyxcbiAgICAqIEBFeGFtcGxlIHsgdHlwZTogJ2NvdW50cnknICwgdmFsdWU6ICdDdWJhXCIgfVxuICAgICovXG4gIG9yZ0ZpbHRlcjogeyB0eXBlOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmd9O1xuXG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RvY28tc2VsZWN0LW9yZycsXG4gIHRlbXBsYXRlVXJsOiAnLi9zZWxlY3Qtb3Jncy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3NlbGVjdC1vcmdzLmNvbXBvbmVudC5zY3NzJ10sXG4gIGhvc3Q6IHtcbiAgICBcIltzdHlsZS5taW5XaWR0aF1cIjogXCJjb250ZW50Lm1pbldpZHRoXCIsXG4gICAgXCJbc3R5bGUud2lkdGhdXCI6IFwiY29udGVudC53aWR0aFwiXG4gIH1cbn0pXG5leHBvcnQgY2xhc3MgU2VsZWN0T3Jnc0NvbXBvbmVudCBleHRlbmRzIElucHV0Q29udHJvbFxuaW1wbGVtZW50cyBPbkluaXQge1xuXG4gIC8qKlxuICAgKiBJbnB1dCBgb3JnQ3RybGAgaXMgYSBGb3JtQ29udHJvbFxuICAgKi9cbiAgIEBJbnB1dCgpXG4gICBvcmdDdHJsID0gbmV3IEZvcm1Db250cm9sKCk7XG5cbiAgIGZpbHRlcmVkT3JnID0gbmV3ICBIaXRMaXN0PE9yZ2FuaXphdGlvbj4oKTtcblxuICAgcGFyYW1zPSBuZXcgSHR0cFBhcmFtcygpO1xuXG5cbiAgIEBJbnB1dCgpXG4gICBwbGFjZWhvbGRlcjogc3RyaW5nID0gXCJFc2NyaWJhIGFsIG1lbm9zIDMgbGV0cmFzXCI7XG5cbiAgIEBJbnB1dCgpXG4gICBsYWJlbDogc3RyaW5nID0gXCJCdXNxdWUgdW5hIG9yZ2FuaXphY2nDs25cIjtcblxuICAgQElucHV0KClcbiAgIGFwcGVhcmFuY2U6IHN0cmluZyA9IFwib3V0bGluZVwiO1xuXG4gICAvKipcbiAgICAqIElucHV0IGBjbGVhbmluZ2AgaXMgYSBib29sZW4sIGlmIHRydWUgdGhlbiBjbGVhbiB0aGUgc2VhcmNoXG4gICAgKi9cbiAgIEBJbnB1dCgpXG4gICBjbGVhbmluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICBAT3V0cHV0KClcbiAgIHNlbGVjdGVkT3JnOiBFdmVudEVtaXR0ZXI8T3JnYW5pemF0aW9uPiA9IG5ldyBFdmVudEVtaXR0ZXI8T3JnYW5pemF0aW9uPigpO1xuXG4gICBjaGlwc0xpc3Q6IEhpdDxPcmdhbml6YXRpb24+W10gPSBbXTtcbiAgIGV4dHJhQ29udGVudDogU2VsZWN0T3Jnc0NvbXBvbmVudEV4dHJhQ29udGVudDtcbiAgIGxvYWRpbmcgPSBmYWxzZTtcblxuICAgdG9TZWFyY2g9MDtcbiAgIGNvbnN0cnVjdG9yKCBwcml2YXRlIF9vcmdTZXJ2aWNlOiBPcmdhbml6YXRpb25TZXJ2aWNlTm9BdXRoKSB7ICBzdXBlcigpO31cblxuICAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5pbml0KCcnLCAnJywgZmFsc2UsIGZhbHNlKTtcbiAgICB0aGlzLmV4dHJhQ29udGVudCA9IHRoaXMuY29udGVudC5leHRyYUNvbnRlbnQ7XG4gICAgdGhpcy5jb250ZW50LnZhbHVlID0gW107XG5cbiAgICB0aGlzLmV4dHJhQ29udGVudC5zZWxlY3RlZE9yZ3NJZHMuZm9yRWFjaCh1dWlkID0+IHtcbiAgICAgIHRoaXMuX29yZ1NlcnZpY2UuZ2V0T3JnYW5pemF0aW9uQnlVVUlEKHV1aWQpLnN1YnNjcmliZSh7XG4gICAgICAgIG5leHQ6IChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgIHRoaXMuYWRkQ2hpcHMocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgfSk7XG4gICAgIHRoaXMucGFyYW1zID0gdGhpcy5wYXJhbXMuc2V0KCdzaXplJywgJzEwJyk7XG4gICAgIHRoaXMucGFyYW1zID0gdGhpcy5wYXJhbXMuc2V0KCdwYWdlJywgJzEnKTtcbiAgICAgaWYgKHRoaXMuZXh0cmFDb250ZW50Lm9yZ0ZpbHRlciAhPSB1bmRlZmluZWQpIHtcbiAgICAgICB0aGlzLnBhcmFtcyA9IHRoaXMucGFyYW1zLnNldCh0aGlzLmV4dHJhQ29udGVudC5vcmdGaWx0ZXIudHlwZSwgdGhpcy5leHRyYUNvbnRlbnQub3JnRmlsdGVyLnZhbHVlKTtcbiAgICAgfVxuICAgICB0aGlzLm9yZ0N0cmwudmFsdWVDaGFuZ2VzXG4gICAgIC5zdWJzY3JpYmUoe1xuICAgICAgIG5leHQ6IChvcmdWYWx1ZUNoYW5nZXMpID0+IHtcbiAgICAgICAgIHRoaXMudG9TZWFyY2grKztcbiAgICAgICAgIC8vIHRoaXMgY29uZGl0aW9uIGNoZWNrIGlmIHRoZSBwYXJhbSBpcyBhIGBzdHJpbmdgIGFuIGlmIGF0IGxlYXN0IHdyaXRlIDMgbGV0dGVyc1xuICAgICAgICAgaWYgKHRoaXMudG9TZWFyY2ggPiAzICYmIHR5cGVvZiBvcmdWYWx1ZUNoYW5nZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgIHRoaXMudG9TZWFyY2ggPSAwO1xuICAgICAgICAgICB0aGlzLnBhcmFtcyA9IHRoaXMucGFyYW1zLnNldCgncScsIG9yZ1ZhbHVlQ2hhbmdlcylcbiAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgdGhpcy5fb3JnU2VydmljZS5nZXRPcmdhbml6YXRpb25zKHRoaXMucGFyYW1zKS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgbmV4dDogKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRPcmcgPSByZXNwb25zZS5oaXRzXG4gICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9KTtcbiAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9yZ1ZhbHVlQ2hhbmdlcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgdGhpcy50b1NlYXJjaCA9IDA7XG4gICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcmcuZW1pdChvcmdWYWx1ZUNoYW5nZXMpO1xuICAgICAgICAgICBpZiAodGhpcy5jbGVhbmluZyl7XG4gICAgICAgICAgICAgdGhpcy5vcmdDdHJsLnNldFZhbHVlKCcnKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgIH1cbiAgICAgfSlcbiAgIH1cbiAgIC8qIFRoaXMgZnVuY3Rpb24gcmV0dXJuIHRoZSBvcmdhbml6YXRpb24gbmFtZVxuICAgICogQHBhcmFtIG9yZyB0aGUgT3JnYW5pemF0aW9uIG9iamVjdFxuICAgICovXG4gICBkaXNwbGF5Rm4ob3JnPzogT3JnYW5pemF0aW9uKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgcmV0dXJuIG9yZyA/IG9yZy5uYW1lIDogdW5kZWZpbmVkO1xuICAgfVxuXG4gICBhZGRDaGlwcyh2YWx1ZTogSGl0PE9yZ2FuaXphdGlvbj4pIHtcbiAgICBpZiAodGhpcy5leHRyYUNvbnRlbnQubXVsdGlwbGUpIHtcbiAgICAgIGlmKCF0aGlzLmNoaXBzTGlzdC5maW5kKHggPT4geC5pZCA9PSB2YWx1ZS5pZCkpe1xuICAgICAgICB0aGlzLmNoaXBzTGlzdC51bnNoaWZ0KHZhbHVlKTtcbiAgICAgICAgdGhpcy5jb250ZW50LnZhbHVlLnVuc2hpZnQodmFsdWUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNoaXBzTGlzdCA9IFt2YWx1ZV07XG4gICAgICB0aGlzLmNvbnRlbnQudmFsdWUgPSBbdmFsdWVdO1xuICAgIH1cbiAgICB0aGlzLmNvbnRlbnQuZm9ybUNvbnRyb2wuc2V0VmFsdWUodGhpcy5jb250ZW50LnZhbHVlKTtcbiAgICB0aGlzLm9yZ0N0cmwuc2V0VmFsdWUoXCJcIik7XG4gICAgdGhpcy5maWx0ZXJlZE9yZyA9IG5ldyAgSGl0TGlzdDxPcmdhbml6YXRpb24+KCk7XG4gIH1cblxuICByZW1vdmVDaGlwKGluZGV4OiBudW1iZXIpIHtcbiAgICBsZXQgdG9kZWxldGUgPSB0aGlzLmNoaXBzTGlzdFtpbmRleF1cbiAgICB0aGlzLmNvbnRlbnQudmFsdWUgPSAodGhpcy5jb250ZW50LnZhbHVlIGFzIFtdKS5maWx0ZXIoXG4gICAgICAoZTogSGl0PE9yZ2FuaXphdGlvbj4pID0+IGUuaWQgIT09IHRvZGVsZXRlLmlkXG4gICAgKTtcbiAgICB0aGlzLmNvbnRlbnQuZm9ybUNvbnRyb2wuc2V0VmFsdWUodGhpcy5jb250ZW50LnZhbHVlKTtcbiAgICB0aGlzLmNoaXBzTGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG59XG4iXX0=