/**
 * @fileoverview added by tsickle
 * Generated from: lib/backend/source.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 *   Copyright (c) 2020 Universidad de Pinar del Río "Hermanos Saíz Montes de Oca"
 *   All rights reserved.
 */
import { HttpBackend, HttpClient, HttpHeaders, HttpParams } from "@angular/common/http";
import { Injectable } from "@angular/core";
import { OAuthStorage } from "angular-oauth2-oidc";
import { Environment } from "../core/env";
var SourceService = /** @class */ (function () {
    function SourceService(env, http, handler, oauthStorage) {
        this.env = env;
        this.http = http;
        this.handler = handler;
        this.oauthStorage = oauthStorage;
        this.prefix = "source";
        this.httpOptions = {
            headers: new HttpHeaders({
                "Content-Type": "application/json",
                Authorization: "Bearer ",
            }),
        };
        this.token = "";
        this.token = this.oauthStorage.getItem("access_token");
        // TODO: hay una mejor manera de hacer esto, creando diferentes y propios HttpClients que
        // tengan un comportamiento especifico (eg: sin/con autenticacion)
        // ver: https://github.com/angular/angular/issues/20203#issuecomment-369754776
        // otra solucion seria pasar parametros especiales como {ignore_auth = true} y que el
        // interceptor actue en consecuencia... .
        // https://github.com/angular/angular/issues/18155#issuecomment-382438006
        this.httpSearch = new HttpClient(handler);
    }
    /**
     * @param {?=} size
     * @param {?=} page
     * @param {?=} role
     * @return {?}
     */
    SourceService.prototype.getMySources = /**
     * @param {?=} size
     * @param {?=} page
     * @param {?=} role
     * @return {?}
     */
    function (size, page, role) {
        if (size === void 0) { size = 10; }
        if (page === void 0) { page = 1; }
        if (role === void 0) { role = 'manager'; }
        /** @type {?} */
        var params = new HttpParams();
        params = params.set("size", size.toString(10));
        params = params.set("page", page.toString(10));
        /** @type {?} */
        var options = {
            params: params,
        };
        // this.httpOptions.headers = this.httpOptions.headers.set('Authorization', 'Bearer ' + this.token);
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/me/" + role + "/ALL";
        return this.http.get(req, options);
    };
    /**
     * @return {?}
     */
    SourceService.prototype.getMySourcesAllRoles = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/me/ALL";
        return this.http.get(req);
    };
    /**
     * @private
     * @param {?} source
     * @return {?}
     */
    SourceService.prototype.adhocstringgify = /**
     * @private
     * @param {?} source
     * @return {?}
     */
    function (source) {
        /** @type {?} */
        var orgs = JSON.stringify(source.data.organizations);
        console.log("-------------------", orgs);
        /** @type {?} */
        var all = source.entitystringify();
        console.log("-------------------", all);
        /** @type {?} */
        var from = all.search('"organizations"') + 16;
        /** @type {?} */
        var p1 = all.substr(0, from);
        console.log(p1);
        /** @type {?} */
        var p2 = all.substr(from);
        console.log(p2);
        /** @type {?} */
        var len = this.count_to_len(p2);
        console.log(len);
        /** @type {?} */
        var p3 = all.substr(from + len);
        console.log(p3);
        return p1 + orgs + p3;
    };
    /**
     * @private
     * @param {?} p2
     * @return {?}
     */
    SourceService.prototype.count_to_len = /**
     * @private
     * @param {?} p2
     * @return {?}
     */
    function (p2) {
        if (p2[0] == "[") {
            /** @type {?} */
            var len = 1;
            /** @type {?} */
            var count = 1;
            for (var index = 1; index < p2.length; index++) {
                /** @type {?} */
                var element = p2[index];
                len++;
                if (p2[index] === "[")
                    count++;
                if (p2[index] === "]")
                    count--;
                if (count === 0)
                    return len;
            }
        }
    };
    /**
     * @param {?} source
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.editSource = /**
     * @param {?} source
     * @param {?} uuid
     * @return {?}
     */
    function (source, uuid) {
        // this.adhocstringgify(source)
        // console.log(source)
        // let valu = source.entitystringify();
        // console.log("s: ", valu)
        // this.adhocstringgify(source)
        // console.log(source)
        // let valu = source.entitystringify();
        // console.log("s: ", valu)
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/" + uuid + "/edit";
        return this.http.post(req, this.adhocstringgify(source), this.httpOptions);
    };
    /**
     * @param {?} source
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.makeSourceAsApproved = /**
     * @param {?} source
     * @param {?} uuid
     * @return {?}
     */
    function (source, uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/" + uuid + "/publish";
        return this.http.post(req, this.adhocstringgify(source), this.httpOptions);
    };
    /**
     * @param {?} source
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.makeSourceAsUnApproved = /**
     * @param {?} source
     * @param {?} uuid
     * @return {?}
     */
    function (source, uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/" + uuid + "/unpublish";
        return this.http.post(req, this.adhocstringgify(source), this.httpOptions);
    };
    /**
     * @param {?} source
     * @param {?} uuid
     * @param {?} role
     * @return {?}
     */
    SourceService.prototype.newSource = /**
     * @param {?} source
     * @param {?} uuid
     * @param {?} role
     * @return {?}
     */
    function (source, uuid, role) {
        /** @type {?} */
        var params = new HttpParams();
        params = params.set("pid", uuid.toString());
        params = params.set("role", role.toString());
        /** @type {?} */
        var options = {
            params: params,
        };
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/new";
        return this.http.post(req, this.adhocstringgify(source), options);
    };
    /**
     * @param {?} issn
     * @return {?}
     */
    SourceService.prototype.getIssnInfo = /**
     * @param {?} issn
     * @return {?}
     */
    function (issn) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/journal/issn/" + issn;
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.getSourcesByTermUUID = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/relations/" + uuid;
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.getSourceVersions = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        this.httpOptions.headers = this.httpOptions.headers.set("Authorization", "Bearer " + this.token);
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/" + uuid + "/versions";
        return this.http.get(req, this.httpOptions);
    };
    /**
     * @param {?} uuid
     * @param {?=} level
     * @return {?}
     */
    SourceService.prototype.countSourcesByTerm = /**
     * @param {?} uuid
     * @param {?=} level
     * @return {?}
     */
    function (uuid, level) {
        if (level === void 0) { level = 0; }
        /** @type {?} */
        var params = new HttpParams();
        /** @type {?} */
        var options = {
            params: params.set("level", level.toString(10)),
        };
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + "/relations/" + uuid + "/count";
        return this.http.get(req, options);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.getSourceByUUID = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        // const req = this.env.sceibaApi + this.prefix + "/" + uuid;
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/' + uuid;
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.permissionGetSourceEditors = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/editor/' + uuid + '/users';
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    SourceService.prototype.permissionSetSourceEditor = /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    function (uuid, user, allow) {
        if (allow === void 0) { allow = false; }
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/' + user + '/editor/' + uuid + ((allow) ? '/allow' : '/deny');
        return this.http.post(req, null, this.httpOptions);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.permissionGetSourceManagers = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/manager/' + uuid + '/users';
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    SourceService.prototype.permissionSetSourceManager = /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    function (uuid, user, allow) {
        if (allow === void 0) { allow = false; }
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/' + user + '/manager/' + uuid + ((allow) ? '/allow' : '/deny');
        return this.http.post(req, null, this.httpOptions);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.permissionGetOrganizationManagers = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/organization/' + uuid + '/users';
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    SourceService.prototype.permissionSetOrganizationManager = /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    function (uuid, user, allow) {
        if (allow === void 0) { allow = false; }
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/' + user + '/organization/' + uuid + ((allow) ? '/allow' : '/deny');
        return this.http.post(req, null, this.httpOptions);
    };
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceService.prototype.permissionGetTermManagers = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/term/' + uuid + '/users';
        return this.http.get(req);
    };
    /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    SourceService.prototype.permissionSetTermManager = /**
     * @param {?} uuid
     * @param {?} user
     * @param {?=} allow
     * @return {?}
     */
    function (uuid, user, allow) {
        if (allow === void 0) { allow = false; }
        /** @type {?} */
        var req = this.env.sceibaApi + this.prefix + '/permission/' + user + '/term/' + uuid + ((allow) ? '/allow' : '/deny');
        return this.http.post(req, null, this.httpOptions);
    };
    SourceService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    SourceService.ctorParameters = function () { return [
        { type: Environment },
        { type: HttpClient },
        { type: HttpBackend },
        { type: OAuthStorage }
    ]; };
    return SourceService;
}());
export { SourceService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.prefix;
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.httpOptions;
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.token;
    /** @type {?} */
    SourceService.prototype.httpSearch;
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.env;
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.handler;
    /**
     * @type {?}
     * @private
     */
    SourceService.prototype.oauthStorage;
}
var SourceServiceNoAuth = /** @class */ (function () {
    function SourceServiceNoAuth(env, handler) {
        // TODO: hay una mejor manera de hacer esto, creando diferentes y propios HttpClients que
        // tengan un comportamiento especifico (eg: sin/con autenticacion)
        // ver: https://github.com/angular/angular/issues/20203#issuecomment-369754776
        // otra solucion seria pasar parametros especiales como {ignore_auth = true} y que el
        // interceptor actue en consecuencia... .
        // https://github.com/angular/angular/issues/18155#issuecomment-382438006
        this.env = env;
        this.handler = handler;
        this.http = new HttpClient(handler);
    }
    /**
     * @param {?} uuid
     * @return {?}
     */
    SourceServiceNoAuth.prototype.getSourceByUUID = /**
     * @param {?} uuid
     * @return {?}
     */
    function (uuid) {
        // const req = this.env.sceibaApi + this.prefix + "/" + uuid;
        /** @type {?} */
        var req = this.env.sceibaApi + "/pid/source/" + uuid;
        return this.http.get(req);
    };
    /**
     * @param {?} issn
     * @return {?}
     */
    SourceServiceNoAuth.prototype.getSourceByISSN = /**
     * @param {?} issn
     * @return {?}
     */
    function (issn) {
        // const req = this.env.sceibaApi + this.prefix + "/" + uuid;
        /** @type {?} */
        var req = this.env.sceibaApi + "source/byissn/" + issn;
        return this.http.get(req);
    };
    /**
     * @param {?} pid
     * @return {?}
     */
    SourceServiceNoAuth.prototype.getSourceByPID = /**
     * @param {?} pid
     * @return {?}
     */
    function (pid) {
        // const req = this.env.sceibaApi + this.prefix + "/" + uuid;
        /** @type {?} */
        var params = new HttpParams();
        params = params.set('value', pid);
        /** @type {?} */
        var options = {
            params: params,
        };
        /** @type {?} */
        var req = this.env.sceibaApi + 'source/pid';
        return this.http.get(req, options);
    };
    /**
     * @param {?} params
     * @return {?}
     */
    SourceServiceNoAuth.prototype.getSources = /**
     * @param {?} params
     * @return {?}
     */
    function (params) {
        /** @type {?} */
        var options = {
            params: params,
        };
        console.log(params);
        /** @type {?} */
        var req = this.env.sceibaApi + 'search/sources';
        return this.http.get(req, options);
    };
    /**
     * @param {?} topOrgId
     * @return {?}
     */
    SourceServiceNoAuth.prototype.getSourcesStats = /**
     * @param {?} topOrgId
     * @return {?}
     */
    function (topOrgId) {
        /** @type {?} */
        var params = new HttpParams();
        params = params.set('org', topOrgId);
        /** @type {?} */
        var options = {
            params: params,
        };
        /** @type {?} */
        var req = this.env.sceibaApi + 'source/stats';
        return this.http.get(req, options);
    };
    SourceServiceNoAuth.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    SourceServiceNoAuth.ctorParameters = function () { return [
        { type: Environment },
        { type: HttpBackend }
    ]; };
    return SourceServiceNoAuth;
}());
export { SourceServiceNoAuth };
if (false) {
    /** @type {?} */
    SourceServiceNoAuth.prototype.http;
    /**
     * @type {?}
     * @private
     */
    SourceServiceNoAuth.prototype.env;
    /**
     * @type {?}
     * @private
     */
    SourceServiceNoAuth.prototype.handler;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90b2NvLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9iYWNrZW5kL3NvdXJjZS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUtBLE9BQU8sRUFDTCxXQUFXLEVBQUUsVUFBVSxFQUN2QixXQUFXLEVBQ1gsVUFBVSxFQUNYLE1BQU0sc0JBQXNCLENBQUM7QUFDOUIsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFbkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQVMxQztJQWFFLHVCQUNVLEdBQWdCLEVBQ2hCLElBQWdCLEVBQ2hCLE9BQW9CLEVBQ3BCLFlBQTBCO1FBSDFCLFFBQUcsR0FBSCxHQUFHLENBQWE7UUFDaEIsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQ3BCLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBZjVCLFdBQU0sR0FBRyxRQUFRLENBQUM7UUFFbEIsZ0JBQVcsR0FBRztZQUNwQixPQUFPLEVBQUUsSUFBSSxXQUFXLENBQUM7Z0JBQ3ZCLGNBQWMsRUFBRSxrQkFBa0I7Z0JBQ2xDLGFBQWEsRUFBRSxTQUFTO2FBQ3pCLENBQUM7U0FDSCxDQUFDO1FBRU0sVUFBSyxHQUFHLEVBQUUsQ0FBQztRQVFqQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBRXZELHlGQUF5RjtRQUN6RixrRUFBa0U7UUFDbEUsOEVBQThFO1FBQzlFLHFGQUFxRjtRQUNyRix5Q0FBeUM7UUFDekMseUVBQXlFO1FBRXpFLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQzs7Ozs7OztJQUVE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LENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDOztZQUUvQixPQUFPLEdBQUc7WUFDZCxNQUFNLEVBQUUsTUFBTTtTQUVmOztZQUNLLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxjQUFjO1FBQy9DLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQWdCLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNwRCxDQUFDOztnQkEvREYsVUFBVTs7OztnQkFqUEYsV0FBVztnQkFQbEIsV0FBVzs7SUF5VGIsMEJBQUM7Q0FBQSxBQWpFRCxJQWlFQztTQWhFWSxtQkFBbUI7OztJQUU5QixtQ0FBaUI7Ozs7O0lBQ0wsa0NBQXdCOzs7OztJQUFFLHNDQUE0QiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiAgIENvcHlyaWdodCAoYykgMjAyMCBVbml2ZXJzaWRhZCBkZSBQaW5hciBkZWwgUsOtbyBcIkhlcm1hbm9zIFNhw616IE1vbnRlcyBkZSBPY2FcIlxuICogICBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICovXG5cbmltcG9ydCB7XG4gIEh0dHBCYWNrZW5kLCBIdHRwQ2xpZW50LFxuICBIdHRwSGVhZGVycyxcbiAgSHR0cFBhcmFtc1xufSBmcm9tIFwiQGFuZ3VsYXIvY29tbW9uL2h0dHBcIjtcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgT0F1dGhTdG9yYWdlIH0gZnJvbSBcImFuZ3VsYXItb2F1dGgyLW9pZGNcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqc1wiO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tIFwiLi4vY29yZS9lbnZcIjtcbmltcG9ydCB7IFJlc3BvbnNlIH0gZnJvbSAnLi4vY29yZS9wdWJsaWMtYXBpJztcbmltcG9ydCB7XG4gIEhpdCwgU2VhcmNoUmVzcG9uc2UsIFNvdXJjZSwgU291cmNlRGF0YSwgU291cmNlVmVyc2lvblxufSBmcm9tIFwiLi4vZW50aXRpZXMvcHVibGljLWFwaVwiO1xuXG5cblxuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgU291cmNlU2VydmljZSB7XG4gIHByaXZhdGUgcHJlZml4ID0gXCJzb3VyY2VcIjtcblxuICBwcml2YXRlIGh0dHBPcHRpb25zID0ge1xuICAgIGhlYWRlcnM6IG5ldyBIdHRwSGVhZGVycyh7XG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIEF1dGhvcml6YXRpb246IFwiQmVhcmVyIFwiLFxuICAgIH0pLFxuICB9O1xuXG4gIHByaXZhdGUgdG9rZW4gPSBcIlwiO1xuICBodHRwU2VhcmNoOiBIdHRwQ2xpZW50O1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVudjogRW52aXJvbm1lbnQsXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxuICAgIHByaXZhdGUgaGFuZGxlcjogSHR0cEJhY2tlbmQsXG4gICAgcHJpdmF0ZSBvYXV0aFN0b3JhZ2U6IE9BdXRoU3RvcmFnZVxuICApIHtcbiAgICB0aGlzLnRva2VuID0gdGhpcy5vYXV0aFN0b3JhZ2UuZ2V0SXRlbShcImFjY2Vzc190b2tlblwiKTtcblxuICAgIC8vIFRPRE86IGhheSB1bmEgbWVqb3IgbWFuZXJhIGRlIGhhY2VyIGVzdG8sIGNyZWFuZG8gZGlmZXJlbnRlcyB5IHByb3Bpb3MgSHR0cENsaWVudHMgcXVlXG4gICAgLy8gdGVuZ2FuIHVuIGNvbXBvcnRhbWllbnRvIGVzcGVjaWZpY28gKGVnOiBzaW4vY29uIGF1dGVudGljYWNpb24pXG4gICAgLy8gdmVyOiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyL2lzc3Vlcy8yMDIwMyNpc3N1ZWNvbW1lbnQtMzY5NzU0Nzc2XG4gICAgLy8gb3RyYSBzb2x1Y2lvbiBzZXJpYSBwYXNhciBwYXJhbWV0cm9zIGVzcGVjaWFsZXMgY29tbyB7aWdub3JlX2F1dGggPSB0cnVlfSB5IHF1ZSBlbFxuICAgIC8vIGludGVyY2VwdG9yIGFjdHVlIGVuIGNvbnNlY3VlbmNpYS4uLiAuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci9pc3N1ZXMvMTgxNTUjaXNzdWVjb21tZW50LTM4MjQzODAwNlxuXG4gICAgdGhpcy5odHRwU2VhcmNoID0gbmV3IEh0dHBDbGllbnQoaGFuZGxlcik7XG4gIH1cblxuICBnZXRNeVNvdXJjZXMoc2l6ZTogbnVtYmVyID0gMTAsIHBhZ2U6IG51bWJlciA9IDEsIHJvbGU9J21hbmFnZXInKTogT2JzZXJ2YWJsZTxSZXNwb25zZTxhbnk+PiB7XG4gICAgbGV0IHBhcmFtcyA9IG5ldyBIdHRwUGFyYW1zKCk7XG4gICAgcGFyYW1zID0gcGFyYW1zLnNldChcInNpemVcIiwgc2l6ZS50b1N0cmluZygxMCkpO1xuICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoXCJwYWdlXCIsIHBhZ2UudG9TdHJpbmcoMTApKTtcblxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgIC8vIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xuICAgIH07XG4gICAgLy8gdGhpcy5odHRwT3B0aW9ucy5oZWFkZXJzID0gdGhpcy5odHRwT3B0aW9ucy5oZWFkZXJzLnNldCgnQXV0aG9yaXphdGlvbicsICdCZWFyZXIgJyArIHRoaXMudG9rZW4pO1xuXG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICsgdGhpcy5wcmVmaXggKyBcIi9tZS9cIisgcm9sZSArIFwiL0FMTFwiO1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PFJlc3BvbnNlPGFueT4+KHJlcSwgb3B0aW9ucyk7XG4gIH1cblxuICBnZXRNeVNvdXJjZXNBbGxSb2xlcygpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL21lL0FMTFwiO1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PFJlc3BvbnNlPGFueT4+KHJlcSk7XG4gIH1cblxuXG4gIHByaXZhdGUgYWRob2NzdHJpbmdnaWZ5KHNvdXJjZTogU291cmNlVmVyc2lvbikge1xuICAgIGxldCBvcmdzOiBzdHJpbmcgPSBKU09OLnN0cmluZ2lmeShzb3VyY2UuZGF0YS5vcmdhbml6YXRpb25zKTtcbiAgICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS1cIiwgb3Jncyk7XG5cbiAgICBsZXQgYWxsID0gc291cmNlLmVudGl0eXN0cmluZ2lmeSgpO1xuICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS0tLS0tLS0tLVwiLCBhbGwpO1xuXG4gICAgbGV0IGZyb20gPSBhbGwuc2VhcmNoKCdcIm9yZ2FuaXphdGlvbnNcIicpICsgMTY7XG5cbiAgICBsZXQgcDEgPSBhbGwuc3Vic3RyKDAsIGZyb20pO1xuICAgIGNvbnNvbGUubG9nKHAxKTtcblxuICAgIGxldCBwMiA9IGFsbC5zdWJzdHIoZnJvbSk7XG4gICAgY29uc29sZS5sb2cocDIpO1xuXG4gICAgbGV0IGxlbiA9IHRoaXMuY291bnRfdG9fbGVuKHAyKTtcbiAgICBjb25zb2xlLmxvZyhsZW4pO1xuXG4gICAgbGV0IHAzID0gYWxsLnN1YnN0cihmcm9tICsgbGVuKTtcbiAgICBjb25zb2xlLmxvZyhwMyk7XG5cbiAgICByZXR1cm4gcDEgKyBvcmdzICsgcDM7XG4gIH1cbiAgcHJpdmF0ZSBjb3VudF90b19sZW4ocDI6IHN0cmluZykge1xuICAgIGlmIChwMlswXSA9PSBcIltcIikge1xuICAgICAgbGV0IGxlbiA9IDE7XG4gICAgICBsZXQgY291bnQgPSAxO1xuICAgICAgZm9yIChsZXQgaW5kZXggPSAxOyBpbmRleCA8IHAyLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gcDJbaW5kZXhdO1xuICAgICAgICBsZW4rKztcbiAgICAgICAgaWYgKHAyW2luZGV4XSA9PT0gXCJbXCIpIGNvdW50Kys7XG4gICAgICAgIGlmIChwMltpbmRleF0gPT09IFwiXVwiKSBjb3VudC0tO1xuICAgICAgICBpZiAoY291bnQgPT09IDApIHJldHVybiBsZW47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGVkaXRTb3VyY2Uoc291cmNlOiBTb3VyY2VWZXJzaW9uLCB1dWlkOiBhbnkpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICAvLyB0aGlzLmFkaG9jc3RyaW5nZ2lmeShzb3VyY2UpXG4gICAgLy8gY29uc29sZS5sb2coc291cmNlKVxuICAgIC8vIGxldCB2YWx1ID0gc291cmNlLmVudGl0eXN0cmluZ2lmeSgpO1xuICAgIC8vIGNvbnNvbGUubG9nKFwiczogXCIsIHZhbHUpXG5cbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL1wiICsgdXVpZCArIFwiL2VkaXRcIjtcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8UmVzcG9uc2U8YW55Pj4oXG4gICAgICByZXEsXG4gICAgICB0aGlzLmFkaG9jc3RyaW5nZ2lmeShzb3VyY2UpLFxuICAgICAgdGhpcy5odHRwT3B0aW9uc1xuICAgICk7XG4gIH1cblxuICBtYWtlU291cmNlQXNBcHByb3ZlZChzb3VyY2U6IFNvdXJjZVZlcnNpb24sdXVpZCk6IE9ic2VydmFibGU8UmVzcG9uc2U8YW55Pj4ge1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucHJlZml4ICsgXCIvXCIgKyB1dWlkICsgXCIvcHVibGlzaFwiO1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxSZXNwb25zZTxhbnk+PihcbiAgICAgIHJlcSxcbiAgICAgIHRoaXMuYWRob2NzdHJpbmdnaWZ5KHNvdXJjZSksXG4gICAgICB0aGlzLmh0dHBPcHRpb25zXG4gICAgKTtcbiAgfVxuXG4gIG1ha2VTb3VyY2VBc1VuQXBwcm92ZWQoc291cmNlOiBTb3VyY2VWZXJzaW9uLHV1aWQpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL1wiICsgdXVpZCArIFwiL3VucHVibGlzaFwiO1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxSZXNwb25zZTxhbnk+PihcbiAgICAgIHJlcSxcbiAgICAgIHRoaXMuYWRob2NzdHJpbmdnaWZ5KHNvdXJjZSksXG4gICAgICB0aGlzLmh0dHBPcHRpb25zXG4gICAgKTtcbiAgfVxuXG4gIG5ld1NvdXJjZShzb3VyY2U6IFNvdXJjZVZlcnNpb24sIHV1aWQsIHJvbGUpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBsZXQgcGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcbiAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KFwicGlkXCIsIHV1aWQudG9TdHJpbmcoKSk7XG4gICAgcGFyYW1zID0gcGFyYW1zLnNldChcInJvbGVcIiwgcm9sZS50b1N0cmluZygpKTtcblxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgIC8vIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xuICAgIH07XG5cbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL25ld1wiO1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxSZXNwb25zZTxhbnk+PihcbiAgICAgIHJlcSxcbiAgICAgIHRoaXMuYWRob2NzdHJpbmdnaWZ5KHNvdXJjZSksXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgfVxuXG4gIGdldElzc25JbmZvKGlzc24pOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL2pvdXJuYWwvaXNzbi9cIiArIGlzc247XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UmVzcG9uc2U8YW55Pj4ocmVxKTtcbiAgfVxuXG4gIGdldFNvdXJjZXNCeVRlcm1VVUlEKHV1aWQpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL3JlbGF0aW9ucy9cIiArIHV1aWQ7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UmVzcG9uc2U8YW55Pj4ocmVxKTtcbiAgfVxuXG4gIGdldFNvdXJjZVZlcnNpb25zKHV1aWQpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICB0aGlzLmh0dHBPcHRpb25zLmhlYWRlcnMgPSB0aGlzLmh0dHBPcHRpb25zLmhlYWRlcnMuc2V0KFxuICAgICAgXCJBdXRob3JpemF0aW9uXCIsXG4gICAgICBcIkJlYXJlciBcIiArIHRoaXMudG9rZW5cbiAgICApO1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucHJlZml4ICsgXCIvXCIgKyB1dWlkICsgXCIvdmVyc2lvbnNcIjtcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZTxhbnk+PihyZXEsIHRoaXMuaHR0cE9wdGlvbnMpO1xuICB9XG5cbiAgY291bnRTb3VyY2VzQnlUZXJtKHV1aWQsIGxldmVsID0gMCk6IE9ic2VydmFibGU8UmVzcG9uc2U8YW55Pj4ge1xuICAgIGxldCBwYXJhbXMgPSBuZXcgSHR0cFBhcmFtcygpO1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBwYXJhbXM6IHBhcmFtcy5zZXQoXCJsZXZlbFwiLCBsZXZlbC50b1N0cmluZygxMCkpLFxuICAgIH07XG4gICAgY29uc3QgcmVxID1cbiAgICAgIHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucHJlZml4ICsgXCIvcmVsYXRpb25zL1wiICsgdXVpZCArIFwiL2NvdW50XCI7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UmVzcG9uc2U8YW55Pj4ocmVxLCBvcHRpb25zKTtcbiAgfVxuXG4gIGdldFNvdXJjZUJ5VVVJRCh1dWlkKTogT2JzZXJ2YWJsZTxSZXNwb25zZTxhbnk+PiB7XG4gICAgLy8gY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICsgdGhpcy5wcmVmaXggKyBcIi9cIiArIHV1aWQ7XG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICArIHRoaXMucHJlZml4ICsgJy8nICsgdXVpZDtcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZTxTb3VyY2VEYXRhPj4ocmVxKTtcbiAgfVxuXG4gIHBlcm1pc3Npb25HZXRTb3VyY2VFZGl0b3JzKHV1aWQpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgICsgdGhpcy5wcmVmaXggKyAnL3Blcm1pc3Npb24vZWRpdG9yLycgKyB1dWlkICsnL3VzZXJzJztcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZTxhbnk+PihyZXEpO1xuICB9XG5cbiAgcGVybWlzc2lvblNldFNvdXJjZUVkaXRvcih1dWlkLCB1c2VyLCBhbGxvdz0gZmFsc2UpOiBPYnNlcnZhYmxlPFJlc3BvbnNlPGFueT4+IHtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgICsgdGhpcy5wcmVmaXggKyAnL3Blcm1pc3Npb24vJyArIHVzZXIgKyAnL2VkaXRvci8nICsgdXVpZCArICgoYWxsb3cpID8gJy9hbGxvdycgOiAnL2RlbnknKTtcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8UmVzcG9uc2U8YW55Pj4oXG4gICAgICByZXEsXG4gICAgICBudWxsLFxuICAgICAgdGhpcy5odHRwT3B0aW9uc1xuICAgICk7XG4gIH1cblxuICBwZXJtaXNzaW9uR2V0U291cmNlTWFuYWdlcnModXVpZCk6IE9ic2VydmFibGU8UmVzcG9uc2U8YW55Pj4ge1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSAgKyB0aGlzLnByZWZpeCArICcvcGVybWlzc2lvbi9tYW5hZ2VyLycgKyB1dWlkICsnL3VzZXJzJztcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZTxhbnk+PihyZXEpO1xuICB9XG5cbiAgcGVybWlzc2lvblNldFNvdXJjZU1hbmFnZXIodXVpZCwgdXNlciwgYWxsb3c9IGZhbHNlKTogT2JzZXJ2YWJsZTxSZXNwb25zZTxhbnk+PiB7XG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICArIHRoaXMucHJlZml4ICsgJy9wZXJtaXNzaW9uLycgKyB1c2VyICsgJy9tYW5hZ2VyLycgKyB1dWlkICsgKChhbGxvdykgPyAnL2FsbG93JyA6ICcvZGVueScpO1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxSZXNwb25zZTxhbnk+PihcbiAgICAgIHJlcSxcbiAgICAgIG51bGwsXG4gICAgICB0aGlzLmh0dHBPcHRpb25zXG4gICAgKTtcbiAgfVxuXG4gIHBlcm1pc3Npb25HZXRPcmdhbml6YXRpb25NYW5hZ2Vycyh1dWlkKTogT2JzZXJ2YWJsZTxSZXNwb25zZTxhbnk+PiB7XG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICArIHRoaXMucHJlZml4ICsgJy9wZXJtaXNzaW9uL29yZ2FuaXphdGlvbi8nICsgdXVpZCArJy91c2Vycyc7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UmVzcG9uc2U8YW55Pj4ocmVxKTtcbiAgfVxuXG4gIHBlcm1pc3Npb25TZXRPcmdhbml6YXRpb25NYW5hZ2VyKHV1aWQsIHVzZXIsIGFsbG93PSBmYWxzZSk6IE9ic2VydmFibGU8UmVzcG9uc2U8YW55Pj4ge1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSAgKyB0aGlzLnByZWZpeCArICcvcGVybWlzc2lvbi8nICsgdXNlciArICcvb3JnYW5pemF0aW9uLycgKyB1dWlkICsgKChhbGxvdykgPyAnL2FsbG93JyA6ICcvZGVueScpO1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxSZXNwb25zZTxhbnk+PihcbiAgICAgIHJlcSxcbiAgICAgIG51bGwsXG4gICAgICB0aGlzLmh0dHBPcHRpb25zXG4gICAgKTtcbiAgfVxuXG4gIHBlcm1pc3Npb25HZXRUZXJtTWFuYWdlcnModXVpZCk6IE9ic2VydmFibGU8UmVzcG9uc2U8YW55Pj4ge1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSAgKyB0aGlzLnByZWZpeCArICcvcGVybWlzc2lvbi90ZXJtLycgKyB1dWlkICsnL3VzZXJzJztcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZTxhbnk+PihyZXEpO1xuICB9XG5cbiAgcGVybWlzc2lvblNldFRlcm1NYW5hZ2VyKHV1aWQsIHVzZXIsIGFsbG93PSBmYWxzZSk6IE9ic2VydmFibGU8UmVzcG9uc2U8YW55Pj4ge1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSAgKyB0aGlzLnByZWZpeCArICcvcGVybWlzc2lvbi8nICsgdXNlciArICcvdGVybS8nICsgdXVpZCArICgoYWxsb3cpID8gJy9hbGxvdycgOiAnL2RlbnknKTtcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8UmVzcG9uc2U8YW55Pj4oXG4gICAgICByZXEsXG4gICAgICBudWxsLFxuICAgICAgdGhpcy5odHRwT3B0aW9uc1xuICAgICk7XG4gIH1cblxufVxuXG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBTb3VyY2VTZXJ2aWNlTm9BdXRoIHtcblxuICBodHRwOiBIdHRwQ2xpZW50O1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVudjogRW52aXJvbm1lbnQsIHByaXZhdGUgaGFuZGxlcjogSHR0cEJhY2tlbmQpIHtcblxuICAgIC8vIFRPRE86IGhheSB1bmEgbWVqb3IgbWFuZXJhIGRlIGhhY2VyIGVzdG8sIGNyZWFuZG8gZGlmZXJlbnRlcyB5IHByb3Bpb3MgSHR0cENsaWVudHMgcXVlXG4gICAgLy8gdGVuZ2FuIHVuIGNvbXBvcnRhbWllbnRvIGVzcGVjaWZpY28gKGVnOiBzaW4vY29uIGF1dGVudGljYWNpb24pXG4gICAgLy8gdmVyOiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyL2lzc3Vlcy8yMDIwMyNpc3N1ZWNvbW1lbnQtMzY5NzU0Nzc2XG4gICAgLy8gb3RyYSBzb2x1Y2lvbiBzZXJpYSBwYXNhciBwYXJhbWV0cm9zIGVzcGVjaWFsZXMgY29tbyB7aWdub3JlX2F1dGggPSB0cnVlfSB5IHF1ZSBlbFxuICAgIC8vIGludGVyY2VwdG9yIGFjdHVlIGVuIGNvbnNlY3VlbmNpYS4uLiAuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci9pc3N1ZXMvMTgxNTUjaXNzdWVjb21tZW50LTM4MjQzODAwNlxuXG4gICAgdGhpcy5odHRwID0gbmV3IEh0dHBDbGllbnQoaGFuZGxlcik7XG4gIH1cblxuICBnZXRTb3VyY2VCeVVVSUQodXVpZCk6IE9ic2VydmFibGU8SGl0PFNvdXJjZURhdGE+PiB7XG4gICAgLy8gY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICsgdGhpcy5wcmVmaXggKyBcIi9cIiArIHV1aWQ7XG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICsgXCIvcGlkL3NvdXJjZS9cIiArIHV1aWQ7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8SGl0PFNvdXJjZURhdGE+PihyZXEpO1xuICB9XG5cbiAgZ2V0U291cmNlQnlJU1NOKGlzc24pOiBPYnNlcnZhYmxlPEhpdDxTb3VyY2VEYXRhPj4ge1xuICAgIC8vIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucHJlZml4ICsgXCIvXCIgKyB1dWlkO1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIFwic291cmNlL2J5aXNzbi9cIiArIGlzc247XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8SGl0PFNvdXJjZURhdGE+PihyZXEpO1xuICB9XG5cbiAgZ2V0U291cmNlQnlQSUQocGlkKTogT2JzZXJ2YWJsZTxIaXQ8U291cmNlRGF0YT4+IHtcbiAgICAvLyBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnByZWZpeCArIFwiL1wiICsgdXVpZDtcbiAgICBsZXQgcGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcbiAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCd2YWx1ZScsIHBpZCk7XG5cbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAvLyBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcbiAgICB9O1xuXG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICsgJ3NvdXJjZS9waWQnO1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PEhpdDxTb3VyY2VEYXRhPj4ocmVxLCBvcHRpb25zKTtcbiAgfVxuXG5cbiAgZ2V0U291cmNlcyhwYXJhbXM6IEh0dHBQYXJhbXMpOiBPYnNlcnZhYmxlPFNlYXJjaFJlc3BvbnNlPFNvdXJjZT4+IHtcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAvLyBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcbiAgICB9O1xuICAgIGNvbnNvbGUubG9nKHBhcmFtcyk7XG4gICAgY29uc3QgcmVxID0gdGhpcy5lbnYuc2NlaWJhQXBpICsgJ3NlYXJjaC9zb3VyY2VzJztcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxTZWFyY2hSZXNwb25zZTxTb3VyY2U+PihyZXEsIG9wdGlvbnMpO1xuICB9XG5cbiAgZ2V0U291cmNlc1N0YXRzKHRvcE9yZ0lkKTogT2JzZXJ2YWJsZTxSZXNwb25zZTxhbnk+PiB7XG4gICAgbGV0IHBhcmFtcyA9IG5ldyBIdHRwUGFyYW1zKCk7XG4gICAgcGFyYW1zID0gcGFyYW1zLnNldCgnb3JnJywgdG9wT3JnSWQpO1xuXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgLy8gaGVhZGVyczogdGhpcy5oZWFkZXJzXG4gICAgfTtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyAnc291cmNlL3N0YXRzJztcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZTxhbnk+PihyZXEsIG9wdGlvbnMpO1xuICB9XG5cbn1cbiJdfQ==