/**
 * @fileoverview added by tsickle
 * Generated from: lib/sources/catalog/catalog.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 *   Copyright (c) 2020 Universidad de Pinar del Río "Hermanos Saíz Montes de Oca"
 *   All rights reserved.
 */
import { Component, ViewChild, Inject } from '@angular/core';
import { animate, state, style, transition, trigger } from '@angular/animations';
import { merge, of as observableOf } from 'rxjs';
import { startWith, switchMap, map, catchError } from 'rxjs/operators';
import { MatPaginator } from '@angular/material/paginator';
import { MatTableDataSource } from '@angular/material/table';
import { MetadataService, MessageHandler, StatusCode } from '../../core/public-api';
import { Journal, JournalData, ISSN, JournalVersion } from '../../entities/public-api';
import { FiltersService } from '../../filters/public-api';
import { Environment } from '../../core/env';
import { CatalogService } from '../../backend/public-api';
import { CatalogFiltersComponent } from '../catalog-filters/catalog-filters.component';
import { MatSnackBar, MatDialog, MatDialogRef, MAT_DIALOG_DATA } from '@angular/material';
export class CatalogComponent {
    /**
     * @param {?} service
     * @param {?} metadata
     * @param {?} filterService
     * @param {?} env
     * @param {?} _snackBar
     * @param {?} dialog
     */
    constructor(service, metadata, filterService, env, _snackBar, dialog) {
        this.service = service;
        this.metadata = metadata;
        this.filterService = filterService;
        this.env = env;
        this._snackBar = _snackBar;
        this.dialog = dialog;
        // journalList: Journal[] = [];
        this.loading = true;
        this.hasErrors = false;
        this.dataSource = new MatTableDataSource();
        this.columnsToDisplay = ['title', 'rnps', 'p-issn', 'url'];
        this.length = 0;
        this.pageSize = 5;
        this.pageSizeOptions = [5, 10, 15, 20];
        this.sceibaHost = '';
        this.layoutPosition = [
            {
                name: 'Derecha',
                layout: 'row-reverse',
                aling: 'center baseline',
                width: '22'
            },
            {
                name: 'Izquierda',
                layout: 'row',
                aling: 'center baseline',
                width: '22'
            },
            {
                name: 'Arriba',
                layout: 'column',
                aling: 'center center',
                width: '90'
            },
            {
                name: 'Abajo',
                layout: 'column-reverse',
                aling: 'center center',
                width: '90'
            }
        ];
        this.currentlayout = this.layoutPosition[1];
        this.sceibaHost = env.sceibaHost + '/catalog';
        env.topOrganizationPID;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.metadata.setStandardMeta("Catálogo de Revistas Científicas", "", "");
        this.paginator.firstPage();
        this.paginator.pageSize = 5;
        try {
            this.fetchJournalData();
            this.filterService.paramsChanged.pipe(catchError((/**
             * @param {?} error
             * @return {?}
             */
            error => {
                /** @type {?} */
                const m = new MessageHandler(this._snackBar);
                m.showMessage(StatusCode.serverError, error.message);
                return observableOf([]);
            })))
                .subscribe((/**
             * @param {?} params
             * @return {?}
             */
            params => {
                this.params = params;
                this.fetchJournalData();
            }));
        }
        catch (err) {
            /** @type {?} */
            const m = new MessageHandler(this._snackBar);
            m.showMessage(StatusCode.serverError, err.message);
        }
    }
    // onPaginatorChanged(){
    //   this.filterService.changeFilter('count',this.paginator.pageSize, false);
    //   this.filterService.changeFilter('page',this.paginator.pageIndex);
    // }
    /**
     * @return {?}
     */
    fetchJournalData() {
        /** @type {?} */
        const arr = new Array();
        merge().pipe(startWith({}), switchMap((/**
         * @return {?}
         */
        () => {
            //this.loading = true;
            return (/** @type {?} */ (this.service)).getJournalsPage(this.paginator.pageSize, this.paginator.pageIndex, this.params);
        })), map((/**
         * @param {?} response
         * @return {?}
         */
        response => {
            // Flip flag to show that loading has finished.
            this.loading = false;
            this.length = response.data.sources.count;
            response.data.sources.data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                const j = new Journal();
                j.id = item.id;
                j.uuid = item.uuid;
                /** @type {?} */
                const info = new JournalData();
                info.url = item.data != null ? item.data.url : '';
                info.title = item.name;
                info.subtitle = item.subtitle;
                info.shortname = item.shortname;
                /** @type {?} */
                const issn = new ISSN();
                issn.e = item.data != null ? item.data.issn.e : '';
                issn.l = item.data != null ? item.data.issn.l : '';
                issn.p = item.data != null ? item.data.issn.p : '';
                info.issn = issn;
                info.rnps = item.data != null ? item.data.rnps : '';
                info.logo = item.data != null ? item.data.logo : '';
                info.purpose = item.purpose;
                info.description = item.data != null ? item.data.description : '';
                j.data = info;
                arr.push(j);
            }));
            return arr;
        })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.loading = false;
            this.hasErrors = true;
            /** @type {?} */
            const m = new MessageHandler(this._snackBar);
            m.showMessage(StatusCode.serverError, error.message);
            // Catch if the GitHub API has reached its rate limit. Return empty data.
            // this.isRateLimitReached = true;
            return observableOf([]);
        }))).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => this.dataSource.data = data));
    }
    /**
     * @return {?}
     */
    onScrollUp() {
        // console.log("scrolled up!!");
    }
    /**
     * @return {?}
     */
    isEmpty() {
        if (this.dataSource.data.length === 0 && this.hasErrors) {
            //this.loading = false;
            return true;
        }
        return false;
    }
    /**
     * @return {?}
     */
    isLoading() {
        return this.loading;
    }
    /**
     * @return {?}
     */
    openme() {
        /** @type {?} */
        const a = navigator.userAgent.match(/Android/i);
        /** @type {?} */
        const b = navigator.userAgent.match(/BlackBerry/i);
        /** @type {?} */
        const apple = navigator.userAgent.match(/iPhone|iPad|iPod/i);
        /** @type {?} */
        const o = navigator.userAgent.match(/Opera Mini/i);
        /** @type {?} */
        const i = navigator.userAgent.match(/IEMobile/i);
        if (a != null || b != null || apple != null || o != null || i != null) {
            return false;
        }
        return true;
    }
    /**
     * @param {?} index
     * @return {?}
     */
    changeLayoutPosition(index) {
        this.currentlayout = this.layoutPosition[index];
    }
    /**
     * @param {?} uuid
     * @return {?}
     */
    viewJournal(uuid) {
        this.service.getSourceByUUID(uuid).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        (response) => {
            console.log(response);
            if (response.status == "success") {
                /** @type {?} */
                let journalVersion = new JournalVersion();
                journalVersion.deepcopy(response.data.sources);
                /** @type {?} */
                const dialogRef = this.dialog.open(DialogCatalogJournalInfoDialog, {
                    data: {
                        journalVersion: journalVersion,
                        journalUUID: uuid
                    }
                });
                dialogRef.afterClosed();
            }
            else {
                /** @type {?} */
                const m = new MessageHandler(this._snackBar);
                m.showMessage(StatusCode.serverError, 'No fue posible encontrar la Revista');
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            console.log('error');
        }), (/**
         * @return {?}
         */
        () => { }));
    }
}
CatalogComponent.decorators = [
    { type: Component, args: [{
                selector: 'toco-catalog',
                template: "<!-- <div infiniteScroll [infiniteScrollDistance]=\"0\" [infiniteScrollUpDistance]=\"0.5\" [infiniteScrollThrottle]=\"10\" (scrolled)=\"onScrollDown()\"\n  (scrolledUp)=\"onScrollUp()\"> -->\n\n<!-- <toco-page-header [info]=\"['Cat\u00E1logo de Revistas Cient\u00EDficas Cubanas']\">\n    </toco-page-header> -->\n<div fxLayoutAlign=\"end center\" fxLayout=\"row\">\n    <button mat-icon-button [matMenuTriggerFor]=\"menu\">\n        <mat-icon>view_quilt</mat-icon>\n    </button>\n    <mat-menu #menu=\"matMenu\">\n        <button mat-menu-item (click)=\"changeLayoutPosition(0)\">\n            <mat-icon>arrow_forward</mat-icon>\n            <span>{{layoutPosition[0].name}}</span>\n        </button>\n        <button mat-menu-item (click)=\"changeLayoutPosition(1)\">\n            <mat-icon>arrow_back</mat-icon>\n            <span>{{layoutPosition[1].name}}</span>\n        </button>\n        <button mat-menu-item (click)=\"changeLayoutPosition(2)\">\n            <mat-icon>arrow_upward</mat-icon>\n            <span>{{layoutPosition[2].name}}</span>\n        </button>\n        <button mat-menu-item (click)=\"changeLayoutPosition(3)\">\n            <mat-icon>arrow_downward</mat-icon>\n            <span>{{layoutPosition[3].name}}</span>\n        </button>\n    </mat-menu>\n</div>\n\n\n<div fxLayout=\"{{currentlayout.layout}}\" fxLayout.xs=\"column nowrap\"\n    fxLayoutAlign=\"{{currentlayout.aling}}\">\n\n    <toco-catalog-filters-container *ngIf=\"!isEmpty()\" fxLayout=\"row wrap\" fxLayout.xs=\"column wrap\" fxFlex=\"{{currentlayout.width}}\"\n        fxLayoutAlign=\"start center\" fxLayoutAlign.xs=\"center center\" fxLayoutGap=\"1em\"\n        class=\"width-90 back-grey mat-elevation-z8\">\n    </toco-catalog-filters-container>\n\n\n\n    <div class=\"mat-elevation-z8 width-90 margin1em\">\n        <table *ngIf=\"!isEmpty()\" mat-table [dataSource]=\"dataSource\" multiTemplateDataRows>\n            <ng-container matColumnDef=\"title\">\n                <th mat-header-cell *matHeaderCellDef>Titulo</th>\n                <td mat-cell *matCellDef=\"let element\"> {{element.data.title}} </td>\n            </ng-container>\n            <ng-container matColumnDef=\"rnps\">\n                <th mat-header-cell *matHeaderCellDef>RNPS</th>\n                <td mat-cell *matCellDef=\"let element\"> {{element.data.rnps}} </td>\n            </ng-container>\n            <ng-container matColumnDef=\"p-issn\">\n                <th mat-header-cell *matHeaderCellDef>P-ISSN</th>\n                <td mat-cell *matCellDef=\"let element\"> {{element.data.issn.p}} </td>\n            </ng-container>\n            <ng-container matColumnDef=\"url\">\n                <th mat-header-cell *matHeaderCellDef>URL</th>\n                <td mat-cell *matCellDef=\"let element\"> {{element.data.url}} </td>\n            </ng-container>\n\n            <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->\n            <ng-container matColumnDef=\"expandedDetail\">\n                <td mat-cell *matCellDef=\"let element\" [attr.colspan]=\"columnsToDisplay.length\">\n                    <div class=\"example-element-detail\"\n                        [@detailExpand]=\"element == expandedElement ? 'expanded' : 'collapsed'\">\n                        <div class=\"example-element-description e2e-inner-html-bound\"\n                            [innerHTML]=\"element.data.description\"></div>\n                        <div class=\"example-element-description\" fxLayout=\"row\" fxLayoutAlign=\"center end\">\n                            <button mat-stroked-button color=\"primary\" (click)=\"viewJournal(element.uuid)\">\n                                Ver\n                            </button>\n                        </div>\n\n                    </div>\n                </td>\n            </ng-container>\n\n            <tr mat-header-row *matHeaderRowDef=\"columnsToDisplay\"></tr>\n            <tr mat-row *matRowDef=\"let element; columns: columnsToDisplay;\" class=\"example-element-row\"\n                [class.example-expanded-row]=\"expandedElement === element\" (click)=\"expandedElement = element\">\n            </tr>\n            <tr mat-row *matRowDef=\"let row; columns: ['expandedDetail']\" class=\"example-detail-row\"></tr>\n        </table>\n\n        <h1 *ngIf=\"isEmpty()\">No hay Informaci\u00F3n para Mostrar</h1>\n\n        <mat-paginator [length]=\"length\" [pageSize]=\"pageSize\" [pageSizeOptions]=\"pageSizeOptions\"\n            (page)=\"fetchJournalData()\">\n        </mat-paginator>\n    </div>\n\n\n</div>\n<mat-card *ngIf=\"isLoading()\" class=\"center-spinner\" fxLayout=\"row\" fxLayoutAlign=\"center center\" fxLayoutGap=\"gappx\">\n    <mat-spinner></mat-spinner>\n    <!--<mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>-->\n</mat-card>\n\n\n<!--\n      </mat-drawer-content>\n\n    </mat-drawer-container> -->\n\n<!-- </div> -->",
                animations: [
                    trigger('detailExpand', [
                        state('collapsed', style({ height: '0px', minHeight: '0', display: 'none' })),
                        state('expanded', style({ height: '*' })),
                        transition('expanded <=> collapsed', animate('225ms cubic-bezier(0.4, 0.0, 0.2, 1)')),
                    ]),
                ],
                styles: [".width-card{width:30%;min-width:240px;margin-left:24px;margin-top:24px}.card-float-left{float:left}.center-spinner{width:90.5%;min-width:240px;margin-left:24px;margin-right:24px;margin-top:24px}.back-grey{background:rgba(0,0,0,.01);margin:1.5em 1em;padding:1em;min-width:18em}.width-90{width:90%}.width-93{width:93.5%}table{width:90%}.margin1em{margin:1em}.menu-pull-right{flex:1 1 auto}table.mat-table{width:100%}tr.example-detail-row{height:0}tr.example-element-row:not(.example-expanded-row):hover{background:#f5f5f5}tr.example-element-row:not(.example-expanded-row):active{background:#efefef}.example-element-row td{border-bottom-width:0}.example-element-detail{overflow:hidden;display:flex}.example-element-diagram{min-width:80px;border:2px solid #000;padding:8px;font-weight:lighter;margin:8px 0;height:104px}.example-element-symbol{font-weight:700;font-size:40px;line-height:normal}.example-element-description{padding:16px}.example-element-description-attribution{opacity:.5}.height-auto{height:auto!important}"]
            }] }
];
/** @nocollapse */
CatalogComponent.ctorParameters = () => [
    { type: CatalogService },
    { type: MetadataService },
    { type: FiltersService },
    { type: Environment },
    { type: MatSnackBar },
    { type: MatDialog }
];
CatalogComponent.propDecorators = {
    paginator: [{ type: ViewChild, args: [MatPaginator, { static: true },] }],
    filter_component: [{ type: ViewChild, args: [CatalogFiltersComponent, { static: true },] }]
};
if (false) {
    /** @type {?} */
    CatalogComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    CatalogComponent.prototype.hasErrors;
    /** @type {?} */
    CatalogComponent.prototype.dataSource;
    /** @type {?} */
    CatalogComponent.prototype.columnsToDisplay;
    /** @type {?} */
    CatalogComponent.prototype.expandedElement;
    /** @type {?} */
    CatalogComponent.prototype.length;
    /** @type {?} */
    CatalogComponent.prototype.pageSize;
    /** @type {?} */
    CatalogComponent.prototype.pageSizeOptions;
    /** @type {?} */
    CatalogComponent.prototype.pageEvent;
    /** @type {?} */
    CatalogComponent.prototype.params;
    /** @type {?} */
    CatalogComponent.prototype.sceibaHost;
    /** @type {?} */
    CatalogComponent.prototype.layoutPosition;
    /** @type {?} */
    CatalogComponent.prototype.currentlayout;
    /** @type {?} */
    CatalogComponent.prototype.paginator;
    /** @type {?} */
    CatalogComponent.prototype.filter_component;
    /**
     * @type {?}
     * @private
     */
    CatalogComponent.prototype.service;
    /**
     * @type {?}
     * @private
     */
    CatalogComponent.prototype.metadata;
    /**
     * @type {?}
     * @private
     */
    CatalogComponent.prototype.filterService;
    /**
     * @type {?}
     * @private
     */
    CatalogComponent.prototype.env;
    /**
     * @type {?}
     * @private
     */
    CatalogComponent.prototype._snackBar;
    /** @type {?} */
    CatalogComponent.prototype.dialog;
}
export class DialogCatalogJournalInfoDialog {
    /**
     * @param {?} dialogRef
     * @param {?} data
     */
    constructor(dialogRef, data) {
        this.dialogRef = dialogRef;
        this.data = data;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        console.log(this.data);
    }
    /**
     * @return {?}
     */
    onNoClick() {
        this.dialogRef.close();
    }
}
DialogCatalogJournalInfoDialog.decorators = [
    { type: Component, args: [{
                selector: 'dialog-catalog-journal-info',
                template: `<mat-dialog-content class="height-auto">
                    <toco-journal-view-info
                        [journalVersion]="data.journalVersion"
                    >
                    </toco-journal-view-info>
                </mat-dialog-content>`
            }] }
];
/** @nocollapse */
DialogCatalogJournalInfoDialog.ctorParameters = () => [
    { type: MatDialogRef },
    { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
];
if (false) {
    /** @type {?} */
    DialogCatalogJournalInfoDialog.prototype.dialogRef;
    /** @type {?} */
    DialogCatalogJournalInfoDialog.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2F0YWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90b2NvLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9zb3VyY2VzL2NhdGFsb2cvY2F0YWxvZy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBTUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3JFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDakYsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLElBQUksWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pELE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN2RSxPQUFPLEVBQUUsWUFBWSxFQUFhLE1BQU0sNkJBQTZCLENBQUM7QUFDdEUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFN0QsT0FBTyxFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsVUFBVSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDcEYsT0FBTyxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3ZGLE9BQU8sRUFBaUIsY0FBYyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFFekUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTdDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQztBQUN2RixPQUFPLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJB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OztJQXBEcEQsbUNBQWU7Ozs7O0lBQ2YscUNBQTBCOztJQUMxQixzQ0FBK0M7O0lBQy9DLDRDQUFzRDs7SUFDdEQsMkNBQXlCOztJQUN6QixrQ0FBVzs7SUFDWCxvQ0FBYTs7SUFDYiwyQ0FBNEM7O0lBQzVDLHFDQUFxQjs7SUFDckIsa0NBQTZCOztJQUU3QixzQ0FBZ0I7O0lBRWhCLDBDQXlCRTs7SUFDRix5Q0FBdUM7O0lBWXZDLHFDQUFtRTs7SUFDbkUsNENBQWdHOzs7OztJQVhwRixtQ0FBK0I7Ozs7O0lBQ3pDLG9DQUFpQzs7Ozs7SUFDakMseUNBQXFDOzs7OztJQUNyQywrQkFBd0I7Ozs7O0lBQ3hCLHFDQUE4Qjs7SUFDOUIsa0NBQXdCOztBQW9LNUIsTUFBTSxPQUFPLDhCQUE4Qjs7Ozs7SUFHekMsWUFDUyxTQUF1RCxFQUM5QixJQUFTO1FBRGxDLGNBQVMsR0FBVCxTQUFTLENBQThDO1FBQzlCLFNBQUksR0FBSixJQUFJLENBQUs7SUFBSSxDQUFDOzs7O0lBRWhELFFBQVE7UUFDTixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUV6QixDQUFDOzs7O0lBQ0QsU0FBUztRQUNQLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDekIsQ0FBQzs7O1lBdEJGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsNkJBQTZCO2dCQUN2QyxRQUFRLEVBQUU7Ozs7O3NDQUswQjthQUNyQzs7OztZQXBPZ0MsWUFBWTs0Q0EwT3hDLE1BQU0sU0FBQyxlQUFlOzs7O0lBRHZCLG1EQUE4RDs7SUFDOUQsOENBQXlDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqICAgQ29weXJpZ2h0IChjKSAyMDIwIFVuaXZlcnNpZGFkIGRlIFBpbmFyIGRlbCBSw61vIFwiSGVybWFub3MgU2HDrXogTW9udGVzIGRlIE9jYVwiXG4gKiAgIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cblxuXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBJbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGFuaW1hdGUsIHN0YXRlLCBzdHlsZSwgdHJhbnNpdGlvbiwgdHJpZ2dlciB9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgbWVyZ2UsIG9mIGFzIG9ic2VydmFibGVPZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgc3RhcnRXaXRoLCBzd2l0Y2hNYXAsIG1hcCwgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE1hdFBhZ2luYXRvciwgUGFnZUV2ZW50IH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvcGFnaW5hdG9yJztcbmltcG9ydCB7IE1hdFRhYmxlRGF0YVNvdXJjZSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL3RhYmxlJztcblxuaW1wb3J0IHsgTWV0YWRhdGFTZXJ2aWNlLCBNZXNzYWdlSGFuZGxlciwgU3RhdHVzQ29kZSB9IGZyb20gJy4uLy4uL2NvcmUvcHVibGljLWFwaSc7XG5pbXBvcnQgeyBKb3VybmFsLCBKb3VybmFsRGF0YSwgSVNTTiwgSm91cm5hbFZlcnNpb24gfSBmcm9tICcuLi8uLi9lbnRpdGllcy9wdWJsaWMtYXBpJztcbmltcG9ydCB7IEZpbHRlckh0dHBNYXAsIEZpbHRlcnNTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vZmlsdGVycy9wdWJsaWMtYXBpJztcblxuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL2Vudic7XG5cbmltcG9ydCB7IENhdGFsb2dTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vYmFja2VuZC9wdWJsaWMtYXBpJztcbmltcG9ydCB7IENhdGFsb2dGaWx0ZXJzQ29tcG9uZW50IH0gZnJvbSAnLi4vY2F0YWxvZy1maWx0ZXJzL2NhdGFsb2ctZmlsdGVycy5jb21wb25lbnQnO1xuaW1wb3J0IHsgTWF0U25hY2tCYXIsIE1hdERpYWxvZywgTWF0RGlhbG9nUmVmLCBNQVRfRElBTE9HX0RBVEEgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbCc7XG5pbXBvcnQgeyBKb3VybmFsVmlld0luZm9Db21wb25lbnQgfSBmcm9tICcuLi8uLi9zb3VyY2VzL2pvdXJuYWwtdmlldy9qb3VybmFsLXZpZXctaW5mby5jb21wb25lbnQnO1xuaW1wb3J0IHsgU2Nyb2xsU3RyYXRlZ3lPcHRpb25zIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL292ZXJsYXknO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0b2NvLWNhdGFsb2cnLFxuICB0ZW1wbGF0ZVVybDogJy4vY2F0YWxvZy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2NhdGFsb2cuY29tcG9uZW50LnNjc3MnXSxcbiAgYW5pbWF0aW9uczogW1xuICAgIHRyaWdnZXIoJ2RldGFpbEV4cGFuZCcsIFtcbiAgICAgIHN0YXRlKCdjb2xsYXBzZWQnLCBzdHlsZSh7IGhlaWdodDogJzBweCcsIG1pbkhlaWdodDogJzAnLCBkaXNwbGF5OiAnbm9uZScgfSkpLFxuICAgICAgc3RhdGUoJ2V4cGFuZGVkJywgc3R5bGUoeyBoZWlnaHQ6ICcqJyB9KSksXG4gICAgICB0cmFuc2l0aW9uKCdleHBhbmRlZCA8PT4gY29sbGFwc2VkJywgYW5pbWF0ZSgnMjI1bXMgY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAwLjIsIDEpJykpLFxuICAgIF0pLFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBDYXRhbG9nQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAvLyBqb3VybmFsTGlzdDogSm91cm5hbFtdID0gW107XG4gIGxvYWRpbmcgPSB0cnVlO1xuICBwcml2YXRlIGhhc0Vycm9ycyA9IGZhbHNlO1xuICBkYXRhU291cmNlID0gbmV3IE1hdFRhYmxlRGF0YVNvdXJjZTxKb3VybmFsPigpO1xuICBjb2x1bW5zVG9EaXNwbGF5ID0gWyd0aXRsZScsICdybnBzJywgJ3AtaXNzbicsICd1cmwnXTtcbiAgZXhwYW5kZWRFbGVtZW50OiBKb3VybmFsO1xuICBsZW5ndGggPSAwO1xuICBwYWdlU2l6ZSA9IDU7XG4gIHBhZ2VTaXplT3B0aW9uczogbnVtYmVyW10gPSBbNSwgMTAsIDE1LCAyMF07XG4gIHBhZ2VFdmVudDogUGFnZUV2ZW50O1xuICBwYXJhbXM6IEFycmF5PEZpbHRlckh0dHBNYXA+O1xuXG4gIHNjZWliYUhvc3QgPSAnJztcblxuICBsYXlvdXRQb3NpdGlvbiA9IFtcbiAgICB7XG4gICAgICBuYW1lOiAnRGVyZWNoYScsXG4gICAgICBsYXlvdXQ6ICdyb3ctcmV2ZXJzZScsXG4gICAgICBhbGluZzogJ2NlbnRlciBiYXNlbGluZScsXG4gICAgICB3aWR0aDogJzIyJ1xuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ0l6cXVpZXJkYScsXG4gICAgICBsYXlvdXQ6ICdyb3cnLFxuICAgICAgYWxpbmc6ICdjZW50ZXIgYmFzZWxpbmUnLFxuICAgICAgd2lkdGg6ICcyMidcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdBcnJpYmEnLFxuICAgICAgbGF5b3V0OiAnY29sdW1uJyxcbiAgICAgIGFsaW5nOiAnY2VudGVyIGNlbnRlcicsXG4gICAgICB3aWR0aDogJzkwJ1xuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ0FiYWpvJyxcbiAgICAgIGxheW91dDogJ2NvbHVtbi1yZXZlcnNlJyxcbiAgICAgIGFsaW5nOiAnY2VudGVyIGNlbnRlcicsXG4gICAgICB3aWR0aDogJzkwJ1xuICAgIH1cbiAgXTtcbiAgY3VycmVudGxheW91dCA9IHRoaXMubGF5b3V0UG9zaXRpb25bMV07XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzZXJ2aWNlOiBDYXRhbG9nU2VydmljZSxcbiAgICBwcml2YXRlIG1ldGFkYXRhOiBNZXRhZGF0YVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBmaWx0ZXJTZXJ2aWNlOiBGaWx0ZXJzU2VydmljZSxcbiAgICBwcml2YXRlIGVudjogRW52aXJvbm1lbnQsXG4gICAgcHJpdmF0ZSBfc25hY2tCYXI6IE1hdFNuYWNrQmFyLFxuICAgIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZykge1xuICAgIHRoaXMuc2NlaWJhSG9zdCA9IGVudi5zY2VpYmFIb3N0ICsgJy9jYXRhbG9nJztcbiAgICBlbnYudG9wT3JnYW5pemF0aW9uUElEXG4gIH1cblxuICBAVmlld0NoaWxkKE1hdFBhZ2luYXRvciwgeyBzdGF0aWM6IHRydWUgfSkgcGFnaW5hdG9yOiBNYXRQYWdpbmF0b3I7XG4gIEBWaWV3Q2hpbGQoQ2F0YWxvZ0ZpbHRlcnNDb21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pIGZpbHRlcl9jb21wb25lbnQ6IENhdGFsb2dGaWx0ZXJzQ29tcG9uZW50O1xuXG4gIG5nT25Jbml0KCkge1xuXG4gICAgdGhpcy5tZXRhZGF0YS5zZXRTdGFuZGFyZE1ldGEoXCJDYXTDoWxvZ28gZGUgUmV2aXN0YXMgQ2llbnTDrWZpY2FzXCIsIFwiXCIsIFwiXCIpO1xuICAgIHRoaXMucGFnaW5hdG9yLmZpcnN0UGFnZSgpO1xuICAgIHRoaXMucGFnaW5hdG9yLnBhZ2VTaXplID0gNTtcblxuICAgIHRyeSB7XG5cbiAgICAgIHRoaXMuZmV0Y2hKb3VybmFsRGF0YSgpO1xuXG4gICAgICB0aGlzLmZpbHRlclNlcnZpY2UucGFyYW1zQ2hhbmdlZC5waXBlKFxuICAgICAgICBjYXRjaEVycm9yKGVycm9yID0+IHtcbiAgICAgICAgICBjb25zdCBtID0gbmV3IE1lc3NhZ2VIYW5kbGVyKHRoaXMuX3NuYWNrQmFyKTtcbiAgICAgICAgICBtLnNob3dNZXNzYWdlKFN0YXR1c0NvZGUuc2VydmVyRXJyb3IsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgIHJldHVybiBvYnNlcnZhYmxlT2YoW10pO1xuICAgICAgICB9KVxuICAgICAgKVxuICAgICAgICAuc3Vic2NyaWJlKHBhcmFtcyA9PiB7XG4gICAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XG4gICAgICAgICAgdGhpcy5mZXRjaEpvdXJuYWxEYXRhKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zdCBtID0gbmV3IE1lc3NhZ2VIYW5kbGVyKHRoaXMuX3NuYWNrQmFyKTtcbiAgICAgIG0uc2hvd01lc3NhZ2UoU3RhdHVzQ29kZS5zZXJ2ZXJFcnJvciwgZXJyLm1lc3NhZ2UpO1xuICAgIH1cblxuICB9XG5cbiAgLy8gb25QYWdpbmF0b3JDaGFuZ2VkKCl7XG4gIC8vICAgdGhpcy5maWx0ZXJTZXJ2aWNlLmNoYW5nZUZpbHRlcignY291bnQnLHRoaXMucGFnaW5hdG9yLnBhZ2VTaXplLCBmYWxzZSk7XG4gIC8vICAgdGhpcy5maWx0ZXJTZXJ2aWNlLmNoYW5nZUZpbHRlcigncGFnZScsdGhpcy5wYWdpbmF0b3IucGFnZUluZGV4KTtcbiAgLy8gfVxuXG4gIHB1YmxpYyBmZXRjaEpvdXJuYWxEYXRhKCkge1xuICAgIGNvbnN0IGFyciA9IG5ldyBBcnJheTxKb3VybmFsPigpO1xuXG4gICAgbWVyZ2UoKS5waXBlKFxuICAgICAgc3RhcnRXaXRoKHt9KSxcbiAgICAgIHN3aXRjaE1hcCgoKSA9PiB7XG4gICAgICAgIC8vdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZSEuZ2V0Sm91cm5hbHNQYWdlKHRoaXMucGFnaW5hdG9yLnBhZ2VTaXplLCB0aGlzLnBhZ2luYXRvci5wYWdlSW5kZXgsIHRoaXMucGFyYW1zKTtcbiAgICAgIH0pLFxuICAgICAgbWFwKHJlc3BvbnNlID0+IHtcbiAgICAgICAgLy8gRmxpcCBmbGFnIHRvIHNob3cgdGhhdCBsb2FkaW5nIGhhcyBmaW5pc2hlZC5cbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5sZW5ndGggPSByZXNwb25zZS5kYXRhLnNvdXJjZXMuY291bnQ7XG5cbiAgICAgICAgcmVzcG9uc2UuZGF0YS5zb3VyY2VzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICBjb25zdCBqID0gbmV3IEpvdXJuYWwoKTtcbiAgICAgICAgICBqLmlkID0gaXRlbS5pZDtcbiAgICAgICAgICBqLnV1aWQgPSBpdGVtLnV1aWQ7XG4gICAgICAgICAgY29uc3QgaW5mbyA9IG5ldyBKb3VybmFsRGF0YSgpO1xuICAgICAgICAgIGluZm8udXJsID0gaXRlbS5kYXRhICE9IG51bGwgPyBpdGVtLmRhdGEudXJsIDogJyc7XG4gICAgICAgICAgaW5mby50aXRsZSA9IGl0ZW0ubmFtZTtcbiAgICAgICAgICBpbmZvLnN1YnRpdGxlID0gaXRlbS5zdWJ0aXRsZTtcbiAgICAgICAgICBpbmZvLnNob3J0bmFtZSA9IGl0ZW0uc2hvcnRuYW1lO1xuICAgICAgICAgIGNvbnN0IGlzc24gPSBuZXcgSVNTTigpO1xuICAgICAgICAgIGlzc24uZSA9IGl0ZW0uZGF0YSAhPSBudWxsID8gaXRlbS5kYXRhLmlzc24uZSA6ICcnO1xuICAgICAgICAgIGlzc24ubCA9IGl0ZW0uZGF0YSAhPSBudWxsID8gaXRlbS5kYXRhLmlzc24ubCA6ICcnO1xuICAgICAgICAgIGlzc24ucCA9IGl0ZW0uZGF0YSAhPSBudWxsID8gaXRlbS5kYXRhLmlzc24ucCA6ICcnO1xuICAgICAgICAgIGluZm8uaXNzbiA9IGlzc247XG4gICAgICAgICAgaW5mby5ybnBzID0gaXRlbS5kYXRhICE9IG51bGwgPyBpdGVtLmRhdGEucm5wcyA6ICcnO1xuICAgICAgICAgIGluZm8ubG9nbyA9IGl0ZW0uZGF0YSAhPSBudWxsID8gaXRlbS5kYXRhLmxvZ28gOiAnJztcbiAgICAgICAgICBpbmZvLnB1cnBvc2UgPSBpdGVtLnB1cnBvc2U7XG4gICAgICAgICAgaW5mby5kZXNjcmlwdGlvbiA9IGl0ZW0uZGF0YSAhPSBudWxsID8gaXRlbS5kYXRhLmRlc2NyaXB0aW9uIDogJyc7XG4gICAgICAgICAgai5kYXRhID0gaW5mbztcbiAgICAgICAgICBhcnIucHVzaChqKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgICB9KSxcbiAgICAgIGNhdGNoRXJyb3IoZXJyb3IgPT4ge1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5oYXNFcnJvcnMgPSB0cnVlO1xuICAgICAgICBjb25zdCBtID0gbmV3IE1lc3NhZ2VIYW5kbGVyKHRoaXMuX3NuYWNrQmFyKTtcbiAgICAgICAgbS5zaG93TWVzc2FnZShTdGF0dXNDb2RlLnNlcnZlckVycm9yLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgLy8gQ2F0Y2ggaWYgdGhlIEdpdEh1YiBBUEkgaGFzIHJlYWNoZWQgaXRzIHJhdGUgbGltaXQuIFJldHVybiBlbXB0eSBkYXRhLlxuICAgICAgICAvLyB0aGlzLmlzUmF0ZUxpbWl0UmVhY2hlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiBvYnNlcnZhYmxlT2YoW10pO1xuXG4gICAgICB9KVxuICAgICkuc3Vic2NyaWJlKGRhdGEgPT4gdGhpcy5kYXRhU291cmNlLmRhdGEgPSBkYXRhKTtcblxuICB9XG5cbiAgcHVibGljIG9uU2Nyb2xsVXAoKSB7XG4gICAgLy8gY29uc29sZS5sb2coXCJzY3JvbGxlZCB1cCEhXCIpO1xuICB9XG5cbiAgcHVibGljIGlzRW1wdHkoKSB7XG4gICAgaWYgKHRoaXMuZGF0YVNvdXJjZS5kYXRhLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmhhc0Vycm9ycykge1xuICAgICAgLy90aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBwdWJsaWMgaXNMb2FkaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmxvYWRpbmc7XG4gIH1cblxuICBwdWJsaWMgb3Blbm1lKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGEgPSBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpO1xuICAgIGNvbnN0IGIgPSBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9CbGFja0JlcnJ5L2kpO1xuICAgIGNvbnN0IGFwcGxlID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lfGlQYWR8aVBvZC9pKTtcbiAgICBjb25zdCBvID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvT3BlcmEgTWluaS9pKTtcbiAgICBjb25zdCBpID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvSUVNb2JpbGUvaSk7XG4gICAgaWYgKGEgIT0gbnVsbCB8fCBiICE9IG51bGwgfHwgYXBwbGUgIT0gbnVsbCB8fCBvICE9IG51bGwgfHwgaSAhPSBudWxsKSB7IHJldHVybiBmYWxzZTsgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcHVibGljIGNoYW5nZUxheW91dFBvc2l0aW9uKGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmN1cnJlbnRsYXlvdXQgPSB0aGlzLmxheW91dFBvc2l0aW9uW2luZGV4XTtcbiAgfVxuXG4gIHZpZXdKb3VybmFsKHV1aWQ6IHN0cmluZyk6IHZvaWQge1xuXG4gICAgdGhpcy5zZXJ2aWNlLmdldFNvdXJjZUJ5VVVJRCh1dWlkKS5zdWJzY3JpYmUoXG4gICAgICAocmVzcG9uc2UpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgbGV0IGpvdXJuYWxWZXJzaW9uID0gbmV3IEpvdXJuYWxWZXJzaW9uKCk7XG4gICAgICAgICAgam91cm5hbFZlcnNpb24uZGVlcGNvcHkocmVzcG9uc2UuZGF0YS5zb3VyY2VzKTtcbiAgICAgICAgICBjb25zdCBkaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKERpYWxvZ0NhdGFsb2dKb3VybmFsSW5mb0RpYWxvZywge1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBqb3VybmFsVmVyc2lvbjogam91cm5hbFZlcnNpb24sXG4gICAgICAgICAgICAgIGpvdXJuYWxVVUlEOiB1dWlkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBkaWFsb2dSZWYuYWZ0ZXJDbG9zZWQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBtID0gbmV3IE1lc3NhZ2VIYW5kbGVyKHRoaXMuX3NuYWNrQmFyKTtcbiAgICAgICAgICBtLnNob3dNZXNzYWdlKFN0YXR1c0NvZGUuc2VydmVyRXJyb3IsICdObyBmdWUgcG9zaWJsZSBlbmNvbnRyYXIgbGEgUmV2aXN0YScpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicpO1xuICAgICAgfSxcbiAgICAgICgpID0+IHsgfVxuICAgICk7XG5cblxuICB9XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2RpYWxvZy1jYXRhbG9nLWpvdXJuYWwtaW5mbycsXG4gIHRlbXBsYXRlOiBgPG1hdC1kaWFsb2ctY29udGVudCBjbGFzcz1cImhlaWdodC1hdXRvXCI+XG4gICAgICAgICAgICAgICAgICAgIDx0b2NvLWpvdXJuYWwtdmlldy1pbmZvXG4gICAgICAgICAgICAgICAgICAgICAgICBbam91cm5hbFZlcnNpb25dPVwiZGF0YS5qb3VybmFsVmVyc2lvblwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPC90b2NvLWpvdXJuYWwtdmlldy1pbmZvPlxuICAgICAgICAgICAgICAgIDwvbWF0LWRpYWxvZy1jb250ZW50PmAsXG59KVxuZXhwb3J0IGNsYXNzIERpYWxvZ0NhdGFsb2dKb3VybmFsSW5mb0RpYWxvZyBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgZGlhbG9nUmVmOiBNYXREaWFsb2dSZWY8RGlhbG9nQ2F0YWxvZ0pvdXJuYWxJbmZvRGlhbG9nPixcbiAgICBASW5qZWN0KE1BVF9ESUFMT0dfREFUQSkgcHVibGljIGRhdGE6IGFueSkgeyB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgY29uc29sZS5sb2codGhpcy5kYXRhKTtcblxuICB9XG4gIG9uTm9DbGljaygpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICB9XG5cbn1cbiJdfQ==