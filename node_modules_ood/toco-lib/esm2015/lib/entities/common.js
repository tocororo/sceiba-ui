/**
 * @fileoverview added by tsickle
 * Generated from: lib/entities/common.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 *   Copyright (c) 2020 Universidad de Pinar del Río "Hermanos Saíz Montes de Oca"
 *   All rights reserved.
 */
/**
 * La idea de esta clase es tener un deserializador.
 */
export class EntityBase extends Object {
    /**
     * @param {?} data
     * @param {?=} exclude
     * @return {?}
     */
    deepcopy(data, exclude = []) {
        /** @type {?} */
        const keys = Object.keys(this);
        for (const key of keys) {
            if (data[key] && !exclude.includes(key)) {
                // console.log('DEEEPCOPY OF : ', key, data[key])
                // if(this.toBoolean(data[key])){
                //   console.log('TO BOOLEAN IS TRUE !!!!!! ');
                //   this[key] = data[key].toLowerCase() === 'true';
                // } else {
                // if (this[key] instanceof EntityBaseList) {
                //   console.log('RECUSIVE CALL ON EntityBaseList',  this[key]);
                //   this[key].deepcopy(data[key], exclude);
                // } else{
                if (this[key] instanceof EntityBase) {
                    console.log('RECUSIVE CALL ON EntityBase', this[key]);
                    this[key].deepcopy(data[key], exclude);
                }
                else {
                    this[key] = data[key];
                }
                // }
            }
        }
    }
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    toBoolean(value) {
        if (typeof value === 'string' || value instanceof String) {
            console.log('DEEPCOPY ----------  TO BOOLEAN ------------ VAL=', value);
            console.log(value.toLowerCase() === 'true' || value.toLowerCase() === 'false');
            return value.toLowerCase() === 'true' || value.toLowerCase() === 'false';
        }
        return false;
    }
}
// export class EntityBaseList<T extends EntityBase> extends Array<T> {
//   constructor(private entityType: new () => T ){
//     super();
//   }
//   getNew() : T {
//     return new this.entityType();
//   }
//   public deepcopy(data: any[]): void {
//     for (let i = 0; i < data.length; i++) {
//       const element = data[i];
//       let e  = this.getNew();
//       e.deepcopy(element);
//       this.push(e);
//     }
//   }
//   public concat(list: EntityBaseList<T>){
//     this.concat(list);
//     return this;
//   }
// }
/**
 * Created by Edel on 02/04/2018.
 */
export class Entity extends EntityBase {
    constructor() {
        super();
        this.id = '';
        /**
         * By default is FALSE. If TRUE, means that the entity does not have valid identifiers or has not been saved to the backend.
         */
        this.isNew = false;
        // raw_data: String;
        // created_at: String;
        // updated_at: String;
        this.identifiers = new Array();
    }
    /**
     * @param {?} idtype
     * @return {?}
     */
    getIdentifierValue(idtype) {
        /** @type {?} */
        const id = this.identifiers.find((/**
         * @param {?} value
         * @return {?}
         */
        (value) => value.idtype == idtype));
        return id != undefined ? id.value : '';
    }
    /**
     * @param {?} idtype
     * @param {?} value
     * @return {?}
     */
    setIdentifierValue(idtype, value) {
        if (value != '') {
            /** @type {?} */
            let added = false;
            for (let index = 0; index < this.identifiers.length; index++) {
                if (this.identifiers[index].idtype == idtype) {
                    this.identifiers[index].value = value;
                    added = true;
                }
            }
            if (!added) {
                /** @type {?} */
                const id = new Identifier();
                id.idtype = idtype;
                id.value = value;
                this.identifiers.push(id);
            }
        }
    }
    /**
     * return JSON.stringify, using a function to exclude object fields id and uuid
     * @return {?}
     */
    entitystringify() {
        return JSON.stringify(this, (/**
         * @param {?} k
         * @param {?} v
         * @return {?}
         */
        (k, v) => {
            // if (k !== "id" && k !== "uuid" && k !== "isNew") {
            if (k !== "isNew" && k !== "entityType" && (v != null && v != '' && v != undefined && v != [])) {
                return v;
            }
        }));
    }
}
if (false) {
    /** @type {?} */
    Entity.prototype.id;
    /**
     * By default is FALSE. If TRUE, means that the entity does not have valid identifiers or has not been saved to the backend.
     * @type {?}
     */
    Entity.prototype.isNew;
    /** @type {?} */
    Entity.prototype.identifiers;
}
/**
 * Entity for `Identifier` based on schema `organization-v1.0.0.json`.
 * Organization Identifier, different from GRID mapping.
 */
export class Identifier extends EntityBase {
    constructor() {
        super(...arguments);
        /**
         * Identifier value.
         */
        this.value = "";
    }
}
if (false) {
    /**
     * Identifier type.
     * @type {?}
     */
    Identifier.prototype.idtype;
    /**
     * Identifier value.
     * @type {?}
     */
    Identifier.prototype.value;
}
/** @enum {string} */
const IdentifierSchemas = {
    ark: "ark",
    arxiv: "arxiv",
    doi: "doi",
    bibcode: "bibcode",
    ean8: "ean8",
    ean13: "ean13",
    handle: "handle",
    isbn: "isbn",
    issn_p: "issn_p",
    issn_l: "issn_l",
    issn_e: "issn_e",
    issn_c: "issn_c",
    issn_o: "issn_o",
    istc: "istc",
    lsid: "lsid",
    pmid: "pmid",
    pmcid: "pmcid",
    purl: "purl",
    upc: "upc",
    url: "url",
    urn: "urn",
    orcid: "orcid",
    gnd: "gnd",
    ads: "ads",
    oai: "oai",
    prnps: "prnps",
    ernps: "ernps",
    oaiurl: "oaiurl",
    grid: "grid",
    wkdata: "wkdata",
    ror: "ror",
    isni: "isni",
    fudref: "fudref",
    orgref: "orgref",
    reup: "reup",
};
export { IdentifierSchemas };
export class Links extends EntityBase {
    constructor() {
        super(...arguments);
        this.self = "";
        this.next = "";
        this.prev = "";
    }
}
if (false) {
    /** @type {?} */
    Links.prototype.self;
    /** @type {?} */
    Links.prototype.next;
    /** @type {?} */
    Links.prototype.prev;
}
export class AggrBucket extends EntityBase {
    constructor() {
        super(...arguments);
        this.doc_count = 0;
        this.key = "";
    }
}
if (false) {
    /** @type {?} */
    AggrBucket.prototype.doc_count;
    /** @type {?} */
    AggrBucket.prototype.key;
}
class AggrMeta extends EntityBase {
    constructor() {
        super(...arguments);
        this.order = 0;
        this.title = "";
    }
}
if (false) {
    /** @type {?} */
    AggrMeta.prototype.order;
    /** @type {?} */
    AggrMeta.prototype.title;
}
export class Aggr extends EntityBase {
    constructor() {
        super(...arguments);
        this.buckets = new Array();
        this.meta = new AggrMeta();
        this.doc_count_error_upper_bound = 0;
        this.sum_other_doc_count = 0;
    }
}
if (false) {
    /** @type {?} */
    Aggr.prototype.buckets;
    /** @type {?} */
    Aggr.prototype.meta;
    /** @type {?} */
    Aggr.prototype.doc_count_error_upper_bound;
    /** @type {?} */
    Aggr.prototype.sum_other_doc_count;
}
/**
 * @template T
 */
export class Hit extends EntityBase {
    constructor() {
        super(...arguments);
        this.id = "";
        this.created = "";
        this.updated = "";
        this.links = new Links();
        this.revision = 0;
    }
}
if (false) {
    /** @type {?} */
    Hit.prototype.id;
    /** @type {?} */
    Hit.prototype.created;
    /** @type {?} */
    Hit.prototype.updated;
    /** @type {?} */
    Hit.prototype.links;
    /** @type {?} */
    Hit.prototype.metadata;
    /** @type {?} */
    Hit.prototype.revision;
    /** @type {?} */
    Hit.prototype.revisions;
}
/**
 * @template T
 */
export class HitList extends EntityBase {
    constructor() {
        super(...arguments);
        this.hits = new Array();
    }
}
if (false) {
    /** @type {?} */
    HitList.prototype.hits;
    /** @type {?} */
    HitList.prototype.total;
}
/**
 * @template T
 */
export class SearchResponse extends EntityBase {
    constructor() {
        super(...arguments);
        this.aggregations = {};
        this.hits = new HitList();
        this.links = new Links();
    }
}
if (false) {
    /** @type {?} */
    SearchResponse.prototype.aggregations;
    /** @type {?} */
    SearchResponse.prototype.hits;
    /** @type {?} */
    SearchResponse.prototype.links;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbW9uLmpzIiwic291cmNlUm9vdCI6Im5nOi8vdG9jby1saWIvIiwic291cmNlcyI6WyJsaWIvZW50aXRpZXMvY29tbW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQU1BLE1BQU0sT0FBTyxVQUFXLFNBQVEsTUFBTTs7Ozs7O0lBQzdCLFFBQVEsQ0FBQyxJQUFTLEVBQUUsVUFBb0IsRUFBRTs7Y0FDekMsSUFBSSxHQUFhLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBRXhDLEtBQUssTUFBTSxHQUFHLElBQUksSUFBSSxFQUFFO1lBQ3RCLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDdkMsaURBQWlEO2dCQUNqRCxpQ0FBaUM7Z0JBQ2pDLCtDQUErQztnQkFDL0Msb0RBQW9EO2dCQUNwRCxXQUFXO2dCQUNULDZDQUE2QztnQkFDN0MsZ0VBQWdFO2dCQUNoRSw0Q0FBNEM7Z0JBQzVDLFVBQVU7Z0JBQ1IsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksVUFBVSxFQUFFO29CQUNuQyxPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixFQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO29CQUN2RCxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztpQkFDeEM7cUJBQU87b0JBQ04sSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztpQkFDdkI7Z0JBQ0gsSUFBSTthQUVQO1NBQ0Y7SUFDSCxDQUFDOzs7Ozs7SUFDTyxTQUFTLENBQUMsS0FBSztRQUNyQixJQUFHLE9BQU8sS0FBSyxLQUFLLFFBQVEsSUFBSSxLQUFLLFlBQVksTUFBTSxFQUFDO1lBQ3RELE9BQU8sQ0FBQyxHQUFHLENBQUMsbURB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QUNFLFlBQU8sR0FBc0IsSUFBSSxLQUFLLEVBQWMsQ0FBQztRQUNyRCxTQUFJLEdBQUksSUFBSSxRQUFRLEVBQUUsQ0FBQztRQUN2QixnQ0FBMkIsR0FBRyxDQUFDLENBQUM7UUFDaEMsd0JBQW1CLEdBQUcsQ0FBQyxDQUFDO0lBQzFCLENBQUM7Q0FBQTs7O0lBSkMsdUJBQXFEOztJQUNyRCxvQkFBdUI7O0lBQ3ZCLDJDQUFnQzs7SUFDaEMsbUNBQXdCOzs7OztBQUcxQixNQUFNLE9BQU8sR0FBTyxTQUFRLFVBQVU7SUFBdEM7O1FBQ0UsT0FBRSxHQUFHLEVBQUUsQ0FBQztRQUNSLFlBQU8sR0FBRyxFQUFFLENBQUM7UUFDYixZQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2IsVUFBSyxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7UUFFcEIsYUFBUSxHQUFHLENBQUMsQ0FBQztJQUdmLENBQUM7Q0FBQTs7O0lBUkMsaUJBQVE7O0lBQ1Isc0JBQWE7O0lBQ2Isc0JBQWE7O0lBQ2Isb0JBQW9COztJQUNwQix1QkFBWTs7SUFDWix1QkFBYTs7SUFFYix3QkFBMkI7Ozs7O0FBRzdCLE1BQU0sT0FBTyxPQUFXLFNBQVEsVUFBVTtJQUExQzs7UUFDRSxTQUFJLEdBQUcsSUFBSSxLQUFLLEVBQVUsQ0FBQztJQUU3QixDQUFDO0NBQUE7OztJQUZDLHVCQUEyQjs7SUFDM0Isd0JBQVM7Ozs7O0FBR1gsTUFBTSxPQUFPLGNBQWtCLFNBQVEsVUFBVTtJQUFqRDs7UUFDRSxpQkFBWSxHQUEyQixFQUFFLENBQUM7UUFDMUMsU0FBSSxHQUFHLElBQUksT0FBTyxFQUFLLENBQUM7UUFDeEIsVUFBSyxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7SUFDdEIsQ0FBQztDQUFBOzs7SUFIQyxzQ0FBMEM7O0lBQzFDLDhCQUF3Qjs7SUFDeEIsK0JBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqICAgQ29weXJpZ2h0IChjKSAyMDIwIFVuaXZlcnNpZGFkIGRlIFBpbmFyIGRlbCBSw61vIFwiSGVybWFub3MgU2HDrXogTW9udGVzIGRlIE9jYVwiXG4gKiAgIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cblxuLyoqKiBMYSBpZGVhIGRlIGVzdGEgY2xhc2UgZXMgdGVuZXIgdW4gZGVzZXJpYWxpemFkb3IuICovXG5leHBvcnQgY2xhc3MgRW50aXR5QmFzZSBleHRlbmRzIE9iamVjdCB7XG4gIHB1YmxpYyBkZWVwY29weShkYXRhOiBhbnksIGV4Y2x1ZGU6IHN0cmluZ1tdID0gW10pOiB2b2lkIHtcbiAgICBjb25zdCBrZXlzOiBzdHJpbmdbXSA9IE9iamVjdC5rZXlzKHRoaXMpO1xuXG4gICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgICAgaWYgKGRhdGFba2V5XSAmJiAhZXhjbHVkZS5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdERUVFUENPUFkgT0YgOiAnLCBrZXksIGRhdGFba2V5XSlcbiAgICAgICAgLy8gaWYodGhpcy50b0Jvb2xlYW4oZGF0YVtrZXldKSl7XG4gICAgICAgIC8vICAgY29uc29sZS5sb2coJ1RPIEJPT0xFQU4gSVMgVFJVRSAhISEhISEgJyk7XG4gICAgICAgIC8vICAgdGhpc1trZXldID0gZGF0YVtrZXldLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJztcbiAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAvLyBpZiAodGhpc1trZXldIGluc3RhbmNlb2YgRW50aXR5QmFzZUxpc3QpIHtcbiAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKCdSRUNVU0lWRSBDQUxMIE9OIEVudGl0eUJhc2VMaXN0JywgIHRoaXNba2V5XSk7XG4gICAgICAgICAgLy8gICB0aGlzW2tleV0uZGVlcGNvcHkoZGF0YVtrZXldLCBleGNsdWRlKTtcbiAgICAgICAgICAvLyB9IGVsc2V7XG4gICAgICAgICAgICBpZiAodGhpc1trZXldIGluc3RhbmNlb2YgRW50aXR5QmFzZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUkVDVVNJVkUgQ0FMTCBPTiBFbnRpdHlCYXNlJywgIHRoaXNba2V5XSk7XG4gICAgICAgICAgICAgIHRoaXNba2V5XS5kZWVwY29weShkYXRhW2tleV0sIGV4Y2x1ZGUpO1xuICAgICAgICAgICAgfSAgZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXNba2V5XSA9IGRhdGFba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAvLyB9XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcHJpdmF0ZSB0b0Jvb2xlYW4odmFsdWUpe1xuICAgIGlmKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpe1xuICAgICAgY29uc29sZS5sb2coJ0RFRVBDT1BZIC0tLS0tLS0tLS0gIFRPIEJPT0xFQU4gLS0tLS0tLS0tLS0tIFZBTD0nLHZhbHVlKVxuICAgICAgY29uc29sZS5sb2codmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnIHx8IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICdmYWxzZScpXG4gICAgICByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnIHx8IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICdmYWxzZSc7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBleHBvcnQgY2xhc3MgRW50aXR5QmFzZUxpc3Q8VCBleHRlbmRzIEVudGl0eUJhc2U+IGV4dGVuZHMgQXJyYXk8VD4ge1xuXG4vLyAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZW50aXR5VHlwZTogbmV3ICgpID0+IFQgKXtcbi8vICAgICBzdXBlcigpO1xuLy8gICB9XG5cbi8vICAgZ2V0TmV3KCkgOiBUIHtcbi8vICAgICByZXR1cm4gbmV3IHRoaXMuZW50aXR5VHlwZSgpO1xuLy8gICB9XG5cbi8vICAgcHVibGljIGRlZXBjb3B5KGRhdGE6IGFueVtdKTogdm9pZCB7XG4vLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgICBjb25zdCBlbGVtZW50ID0gZGF0YVtpXTtcbi8vICAgICAgIGxldCBlICA9IHRoaXMuZ2V0TmV3KCk7XG4vLyAgICAgICBlLmRlZXBjb3B5KGVsZW1lbnQpO1xuLy8gICAgICAgdGhpcy5wdXNoKGUpO1xuLy8gICAgIH1cbi8vICAgfVxuLy8gICBwdWJsaWMgY29uY2F0KGxpc3Q6IEVudGl0eUJhc2VMaXN0PFQ+KXtcbi8vICAgICB0aGlzLmNvbmNhdChsaXN0KTtcbi8vICAgICByZXR1cm4gdGhpcztcbi8vICAgfVxuLy8gfVxuXG4vKipcbiAqIENyZWF0ZWQgYnkgRWRlbCBvbiAwMi8wNC8yMDE4LlxuICovXG5leHBvcnQgY2xhc3MgRW50aXR5IGV4dGVuZHMgRW50aXR5QmFzZSB7XG4gIGlkOiBzdHJpbmcgPSAnJztcblxuICAvKiogQnkgZGVmYXVsdCBpcyBGQUxTRS4gSWYgVFJVRSwgbWVhbnMgdGhhdCB0aGUgZW50aXR5IGRvZXMgbm90IGhhdmUgdmFsaWQgaWRlbnRpZmllcnMgb3IgaGFzIG5vdCBiZWVuIHNhdmVkIHRvIHRoZSBiYWNrZW5kLiAgKi9cbiAgaXNOZXcgPSBmYWxzZTtcbiAgLy8gcmF3X2RhdGE6IFN0cmluZztcbiAgLy8gY3JlYXRlZF9hdDogU3RyaW5nO1xuICAvLyB1cGRhdGVkX2F0OiBTdHJpbmc7XG5cbiAgaWRlbnRpZmllcnM6QXJyYXk8SWRlbnRpZmllcj4gPSBuZXcgQXJyYXk8SWRlbnRpZmllcj4oKTtcbiAgZ2V0SWRlbnRpZmllclZhbHVlKGlkdHlwZTogSWRlbnRpZmllclNjaGVtYXMpOiBzdHJpbmcge1xuICAgIGNvbnN0IGlkID0gdGhpcy5pZGVudGlmaWVycy5maW5kKCh2YWx1ZSkgPT4gdmFsdWUuaWR0eXBlID09IGlkdHlwZSk7XG4gICAgcmV0dXJuIGlkICE9IHVuZGVmaW5lZCA/IGlkLnZhbHVlIDogJyc7XG4gIH1cblxuICBzZXRJZGVudGlmaWVyVmFsdWUoaWR0eXBlOiBJZGVudGlmaWVyU2NoZW1hcywgdmFsdWU6IHN0cmluZykge1xuICAgIGlmKHZhbHVlICE9ICcnKXtcbiAgICAgIGxldCBhZGRlZCA9IGZhbHNlO1xuICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuaWRlbnRpZmllcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIGlmKHRoaXMuaWRlbnRpZmllcnNbaW5kZXhdLmlkdHlwZSA9PSBpZHR5cGUpe1xuICAgICAgICAgIHRoaXMuaWRlbnRpZmllcnNbaW5kZXhdLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgYWRkZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIWFkZGVkKSB7XG4gICAgICAgIGNvbnN0IGlkID0gbmV3IElkZW50aWZpZXIoKTtcbiAgICAgICAgaWQuaWR0eXBlID0gaWR0eXBlO1xuICAgICAgICBpZC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmlkZW50aWZpZXJzLnB1c2goaWQpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIHJldHVybiBKU09OLnN0cmluZ2lmeSwgdXNpbmcgYSBmdW5jdGlvbiB0byBleGNsdWRlIG9iamVjdCBmaWVsZHMgaWQgYW5kIHV1aWRcbiAgICovXG4gIGVudGl0eXN0cmluZ2lmeSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLCAoaywgdikgPT4ge1xuICAgICAgLy8gaWYgKGsgIT09IFwiaWRcIiAmJiBrICE9PSBcInV1aWRcIiAmJiBrICE9PSBcImlzTmV3XCIpIHtcbiAgICAgIGlmIChrICE9PSBcImlzTmV3XCIgJiYgayAhPT0gXCJlbnRpdHlUeXBlXCIgJiYgKHYgIT0gbnVsbCAmJiB2ICE9ICcnICYmIHYgIT0gdW5kZWZpbmVkICYmIHYgIT0gW10pKSB7XG4gICAgICAgIHJldHVybiB2O1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogRW50aXR5IGZvciBgSWRlbnRpZmllcmAgYmFzZWQgb24gc2NoZW1hIGBvcmdhbml6YXRpb24tdjEuMC4wLmpzb25gLlxuICogT3JnYW5pemF0aW9uIElkZW50aWZpZXIsIGRpZmZlcmVudCBmcm9tIEdSSUQgbWFwcGluZy5cbiAqL1xuZXhwb3J0IGNsYXNzIElkZW50aWZpZXIgZXh0ZW5kcyBFbnRpdHlCYXNlIHtcbiAgLyoqXG4gICAqIElkZW50aWZpZXIgdHlwZS5cbiAgICovXG4gIGlkdHlwZTogSWRlbnRpZmllclNjaGVtYXM7XG5cbiAgLyoqXG4gICAqIElkZW50aWZpZXIgdmFsdWUuXG4gICAqL1xuICB2YWx1ZTogc3RyaW5nID0gXCJcIjtcbn1cblxuXG5leHBvcnQgZW51bSBJZGVudGlmaWVyU2NoZW1hcyB7XG4gIGFyayA9IFwiYXJrXCIsXG4gIGFyeGl2ID0gXCJhcnhpdlwiLFxuICBkb2kgPSBcImRvaVwiLFxuICBiaWJjb2RlID0gXCJiaWJjb2RlXCIsXG4gIGVhbjggPSBcImVhbjhcIixcbiAgZWFuMTMgPSBcImVhbjEzXCIsXG4gIGhhbmRsZSA9IFwiaGFuZGxlXCIsXG4gIGlzYm4gPSBcImlzYm5cIixcbiAgaXNzbl9wID0gXCJpc3NuX3BcIixcbiAgaXNzbl9sID0gXCJpc3NuX2xcIixcbiAgaXNzbl9lID0gXCJpc3NuX2VcIixcbiAgaXNzbl9jID0gXCJpc3NuX2NcIixcbiAgaXNzbl9vID0gXCJpc3NuX29cIixcbiAgaXN0YyA9IFwiaXN0Y1wiLFxuICBsc2lkID0gXCJsc2lkXCIsXG4gIHBtaWQgPSBcInBtaWRcIixcbiAgcG1jaWQgPSBcInBtY2lkXCIsXG4gIHB1cmwgPSBcInB1cmxcIixcbiAgdXBjID0gXCJ1cGNcIixcbiAgdXJsID0gXCJ1cmxcIixcbiAgdXJuID0gXCJ1cm5cIixcbiAgb3JjaWQgPSBcIm9yY2lkXCIsXG4gIGduZCA9IFwiZ25kXCIsXG4gIGFkcyA9IFwiYWRzXCIsXG4gIG9haSA9IFwib2FpXCIsXG4gIHBybnBzID0gXCJwcm5wc1wiLFxuICBlcm5wcyA9IFwiZXJucHNcIixcbiAgb2FpdXJsID0gXCJvYWl1cmxcIixcbiAgZ3JpZCA9IFwiZ3JpZFwiLFxuICB3a2RhdGEgPSBcIndrZGF0YVwiLFxuICByb3IgPSBcInJvclwiLFxuICBpc25pID0gXCJpc25pXCIsXG4gIGZ1ZHJlZiA9IFwiZnVkcmVmXCIsXG4gIG9yZ3JlZiA9IFwib3JncmVmXCIsXG4gIHJldXAgPSBcInJldXBcIixcbn1cblxuZXhwb3J0IGNsYXNzIExpbmtzIGV4dGVuZHMgRW50aXR5QmFzZSB7XG4gIHNlbGYgPSBcIlwiO1xuICBuZXh0ID0gXCJcIjtcbiAgcHJldiA9IFwiXCI7XG59XG5cbmV4cG9ydCBjbGFzcyBBZ2dyQnVja2V0IGV4dGVuZHMgRW50aXR5QmFzZSB7XG4gIGRvY19jb3VudCA9IDA7XG4gIGtleSA9IFwiXCI7XG59XG5jbGFzcyBBZ2dyTWV0YSBleHRlbmRzIEVudGl0eUJhc2Uge1xuICBvcmRlciA9IDA7XG4gIHRpdGxlID0gXCJcIjtcbn1cblxuZXhwb3J0IGNsYXNzIEFnZ3IgZXh0ZW5kcyBFbnRpdHlCYXNlIHtcbiAgYnVja2V0czogQXJyYXk8QWdnckJ1Y2tldD4gPSBuZXcgQXJyYXk8QWdnckJ1Y2tldD4oKTtcbiAgbWV0YT8gPSBuZXcgQWdnck1ldGEoKTtcbiAgZG9jX2NvdW50X2Vycm9yX3VwcGVyX2JvdW5kID0gMDtcbiAgc3VtX290aGVyX2RvY19jb3VudCA9IDA7XG59XG5cbmV4cG9ydCBjbGFzcyBIaXQ8VD4gZXh0ZW5kcyBFbnRpdHlCYXNlIHtcbiAgaWQgPSBcIlwiO1xuICBjcmVhdGVkID0gXCJcIjtcbiAgdXBkYXRlZCA9IFwiXCI7XG4gIGxpbmtzID0gbmV3IExpbmtzKCk7XG4gIG1ldGFkYXRhOiBUO1xuICByZXZpc2lvbiA9IDA7XG5cbiAgcmV2aXNpb25zPyA6IEFycmF5PEhpdDxUPj47XG59XG5cbmV4cG9ydCBjbGFzcyBIaXRMaXN0PFQ+IGV4dGVuZHMgRW50aXR5QmFzZSB7XG4gIGhpdHMgPSBuZXcgQXJyYXk8SGl0PFQ+PigpO1xuICB0b3RhbDogMDtcbn1cblxuZXhwb3J0IGNsYXNzIFNlYXJjaFJlc3BvbnNlPFQ+IGV4dGVuZHMgRW50aXR5QmFzZSB7XG4gIGFnZ3JlZ2F0aW9uczogeyBbaWQ6IHN0cmluZ106IEFnZ3IgfSA9IHt9O1xuICBoaXRzID0gbmV3IEhpdExpc3Q8VD4oKTtcbiAgbGlua3MgPSBuZXcgTGlua3MoKTtcbn1cbiJdfQ==