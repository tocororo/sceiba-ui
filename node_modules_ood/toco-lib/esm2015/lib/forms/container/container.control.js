/**
 * @fileoverview added by tsickle
 * Generated from: lib/forms/container/container.control.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 *   Copyright (c) 2020 Universidad de Pinar del Río "Hermanos Saíz Montes de Oca"
 *   All rights reserved.
 */
import { Input, ViewChild } from '@angular/core';
import { FormArray, FormGroup } from '@angular/forms';
import { GetViewContainerDirective } from '../../core/utils/get-view-container.directive';
import { FormFieldControl, cloneFormControl, cloneFormSection } from '../form-field.control';
/**
 * A base interface that represents the content of a `ContainerControl`.
 * @record
 */
export function ContainerContent() { }
if (false) {
    /**
     * Returns an array of controls that represents the `ContainerControl`'s child controls that are
     * stored in the `content.formSection`; that is, `content.containerControlChildren` and `content.formSection`
     * have the same length.
     * It is always set internally.
     * By default, its value is `[]`.
     * @type {?|undefined}
     */
    ContainerContent.prototype.containerControlChildren;
    /**
     * Returns the `FormSection` that tracks the value and validity state of the internal
     * child controls that contains this control.
     * Implementation notes:
     *  - Represents the `FormGroup` or `FormArray` that contains the child controls.
     *  - The `content.containerControlChildren` and `content.formSection` have the same length.
     *  - It must be specified; otherwise, an exception is thrown.
     * @type {?|undefined}
     */
    ContainerContent.prototype.formSection;
    /**
     * Returns an array of contents that represents the `ContainerControl`'s child controls that are
     * stored in the `ViewContainer`; that is, `content.formSectionContent` and container's `ViewContainer`
     * have the same length.
     * Implementation notes:
     *  - It must be specified, and must have at least one element; otherwise, an exception is thrown.
     *  - If the `content.formSection` field represents a `FormArray`, then the `name` field
     * of all elements in the `content.formSectionContent` array represents the position
     * in the array like string.
     * @type {?|undefined}
     */
    ContainerContent.prototype.formSectionContent;
    /**
     * Returns true if the container control has a dynamic length, that is, the `content.formSection` field
     * represents a `FormArray` and its length is not fixed; otherwise, false.
     * This field has sense only when the `content.formSection` field represents a `FormArray`.
     * By default, its value is `true`.
     * @type {?|undefined}
     */
    ContainerContent.prototype.isDynamic;
}
/**
 * Represents the base abstract class for a control that contains one or more controls.
 * @abstract
 */
export class ContainerControl extends FormFieldControl {
    /**
     * Constructs a new instance of this class.
     */
    constructor() {
        super();
        this._isFormArray = false;
        this._formArrayPatternContent = [];
        this._formArrayPatternValue = undefined;
        this._formArrayLength = 0;
    }
    /**
     * Returns a `FormGroup` by default.
     * Its value is empty object, and does not have validators.
     * @return {?}
     */
    static getFormGroupByDefault() {
        return new FormGroup({}, []);
    }
    /**
     * Returns a `FormArray` by default.
     * Its value is empty array, and does not have validators.
     * @return {?}
     */
    static getFormArrayByDefault() {
        return new FormArray([], []);
    }
    /**
     * Initializes the `content` input property.
     * @protected
     * @param {?} label The default label to use. It is used if the `content.label` is not specified.
     * @param {?=} placeholder It is NOT used here. Fix that.
     * @return {?}
     */
    init(label, placeholder = '') {
        /* Sets the default values. */
        super.init(label, placeholder);
        if (this.content.formSection == undefined) {
            throw new Error(`For the '${this.content.name}' control, the 'content.formSection' value can not be undefined; it must be a 'FormGroup' or 'FormArray' value.`);
        }
        if ((this.content.formSectionContent == undefined) || (this.content.formSectionContent.length == 0)) {
            throw new Error(`For the '${this.content.name}' control, the 'content.formSectionContent' array can not be undefined, and must have at least one element.`);
        }
        this._isFormArray = this.content.formSection instanceof FormArray;
        if (this._isFormArray) {
            if (this.content.isDynamic == undefined)
                this.content.isDynamic = true; /* By default, its value is `true`. */
            if (this.content.required == undefined)
                this.content.required = false; /* By default, its value is `false`. */
        }
        else {
            if (this.content.isDynamic != undefined)
                throw new Error(`For the '${this.content.name}' control, the 'content.isDynamic' value must not exist because the 'content.formSection' value is a 'FormGroup'.`);
            if (this.content.required != undefined)
                throw new Error(`For the '${this.content.name}' control, the 'content.required' value must not exist because the 'content.formSection' value is a 'FormGroup'.`);
            if (this.content.value != undefined)
                throw new Error(`For the '${this.content.name}' control, the 'content.value' value must not exist because the 'content.formSection' value is a 'FormGroup'.`);
        }
        this._viewContainerRef = this._componentHost.viewContainerRef;
        this._componentFactoryResolver = this._componentHost.componentFactoryResolver;
        /* Initializes the `content.containerControlChildren`. */
        this.content.containerControlChildren = [];
        if (this._isFormArray) {
            if (this.content.value == undefined) {
                throw new Error(`The '${this.content.name}' control is constructed dynamically using 'FormArray'. Its 'content.value' array can not be undefined.`);
            }
            if ((this.content.value.length == 0) && (!this.content.isDynamic) && (this.content.required)) {
                throw new Error(`The '${this.content.name}' control has not sense because its 'content.value' array length is zero, and its 'content.isDynamic' value is false, and its 'content.required' value is true.`);
            }
            this.initFormSectionContentToFormArray();
        }
        else {
            /* Sets the parent control to its children. */
            this.setParentToChildren();
        }
        // let temp: string = (isAbbreviation) ? this.content.label : this.content.label.toLowerCase();
        // this.validationError_required = `The ${ temp } can not be empty.`;
        /************************** `mat-form-field` properties. **************************/
        // if (this.content.appearance == undefined) this.content.appearance = TextInputAppearance.standard;
        /***************************** `mat-hint` properties. *****************************/
        // if (alwaysHint && (this.content.startHint == undefined) && (this.content.endHint == undefined))
        // {
        //     this.content.startHint = new HintValue(HintPosition.start, `Write a valid ${ temp }.`);
        // }
        // else
        // {
        //     if (this.content.startHint != undefined) this.content.startHint.setDefaultValueIfUndefined_setPosition(HintPosition.start);
        //     if (this.content.endHint != undefined) this.content.endHint.setDefaultValueIfUndefined_setPosition(HintPosition.end);
        // }
        /* Adds this control as a child to the `content.parentFormSection`.
        It must be called at the end before calling `createChildComponents` method. */
        if (this.content.parentFormSection != undefined) {
            this.addAsChildControl(this, this.content.formSection);
        }
        /* Creates the child components. */
        this.createChildComponents(this.content.formSectionContent);
    }
    /**
     * Initializes the `content.formSectionContent` array correctly depending on the `content.value`.
     * In this case, `content.value` is an array. For each element in the `content.value`, a cloning
     * is done to the `_formArrayPatternContent` array, and it is added in the `content.formSectionContent`;
     * therefore one element is added in the `content.formSection` `FormArray`.
     * @protected
     * @return {?}
     */
    initFormSectionContentToFormArray() {
        /* At this point, `content.formSectionContent` has at least one element. */
        /* Saves the pattern content, that is, `content.formSectionContent`.
        It is shared among controls. */
        this._formArrayPatternContent = this.content.formSectionContent;
        /* The `FormArray` is empty initially. */
        this.content.formSectionContent = [];
        /* Saves the pattern value, that is, creates the pattern value following the `_formArrayPatternContent` structure.
        The result value represents a copy of one value that can contain the `content.value` array, and
        sets all its properties/values of built-in type to `undefined`.
        It does not clone a value from the `content.value` array because the array can be empty.
        It creates in deep until the next `FormArray`, then the next `FormArray` creates in deep until the next `FormArray`, and so on.
        It is the first time that the `_formArrayPatternContent` is travelled, therefore the `createValueToUndefined` method does verifications. */
        this._formArrayPatternValue = this.createValueToUndefined();
        /* If the `content.required` field is true, then the container control must have one child control at least. */
        if ((this.content.required) && (this.content.value.length == 0)) {
            /* It can push the `_formArrayPatternValue` and does not push its clone because
            both values have the same properties and there is not problem. */
            this.content.value[0] = this._formArrayPatternValue;
        }
        /* The `FormArray` will contain one element for each element in the `content.value`. */
        for (let val of this.content.value) {
            this._initElemFormSectionContentToFormArray(val);
        }
    }
    /**
     * Sets the parent control to its children.
     * @protected
     * @return {?}
     */
    setParentToChildren() {
        this.content.formSectionContent.forEach(this.setParentToChild, this);
    }
    /**
     * Sets the parent control to one child.
     * @protected
     * @param {?} ffc The child to set the parent control.
     * @return {?}
     */
    setParentToChild(ffc) {
        /* Sets the parent `ContainerControl` to its children. */
        ffc.parentContainerControl = this;
        /* Sets the parent `FormSection` to its children if they have got nothing. */
        ffc.parentFormSection = this.content.formSection;
    }
    /**
     * Returns a new value that is created following the `_formArrayPatternContent` structure.
     * It also sets all its properties/values of built-in type to `undefined`.
     * It creates the value smartly depending on the type of content.
     * It creates in deep until the next `FormArray`, then the next `FormArray` creates in deep until the next `FormArray`, and so on.
     * It is the first time that the `_formArrayPatternContent` is travelled, therefore the `createValueToUndefined` method does verifications.
     * @protected
     * @return {?}
     */
    createValueToUndefined() {
        /** @type {?} */
        let result;
        /* The `_formArrayPatternContent` array can have one element only with the `content.formSection` field. */
        /** @type {?} */
        let alreadyHasFormSection = false;
        for (let content of this._formArrayPatternContent) {
            if (content.formControl) {
                if (alreadyHasFormSection)
                    throw new Error(`For the '${this.content.name}' control, the 'content.formSectionContent' array can have one element only with the 'content.formControl' or 'content.formSection' field.`);
                alreadyHasFormSection = true;
                result = undefined;
            }
            else if (content.formSection) {
                if (alreadyHasFormSection)
                    throw new Error(`For the '${this.content.name}' control, the 'content.formSectionContent' array can have one element only with the 'content.formControl' or 'content.formSection' field.`);
                alreadyHasFormSection = true;
                result = this._createValueToUndefined(content);
            }
            /* The rest of `content`s do not contain a `value` field of interest. */
        }
        if (!alreadyHasFormSection)
            throw new Error(`For the '${this.content.name}' control, the 'content.formSectionContent' array must have one element only among all with the 'content.formControl' or 'content.formSection' field.`);
        return result;
    }
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    _createValueToUndefined(target) {
        if (target.formSection instanceof FormArray) {
            return [];
        }
        else {
            /** @type {?} */
            let result = {};
            for (let content of target.formSectionContent) {
                if (content.formControl)
                    result[content.name] = undefined;
                else if (content.formSection)
                    result[content.name] = this._createValueToUndefined(content);
                /* The rest of `content`s do not contain a `value` field of interest. */
            }
            return result;
        }
    }
    /**
     * Initializes and returns a clone of the `_formArrayPatternContent` array correctly
     * depending on the specified `value`.
     * This clone is also added in the `content.formSectionContent` array.
     * @private
     * @param {?} value The initial `value` field of each content representing a `FormControl`.
     * @return {?}
     */
    _initElemFormSectionContentToFormArray(value) {
        /* The content array cloned. */
        /** @type {?} */
        let result = [];
        /** @type {?} */
        let refContent;
        for (let content of this._formArrayPatternContent) {
            /* Clones in deep until the next `FormArray`, then the next `FormArray` clones in deep until the next `FormArray`, and so on. */
            if (content.formSection instanceof FormArray) {
                /* This `content.formSectionContent` will not be cloned because it belongs to a `FormArray` and it will be cloned when the `FormArray` is analyzed in the `ContainerControl` class. */
                refContent = this._cloneContent(content, undefined /* It is not used in this case. */, false);
                refContent.value = value;
            }
            else {
                refContent = this._cloneContent(content, value, true);
            }
            /* Sets the parent control to its child. */
            this.setParentToChild(refContent);
            /* Overwrites some properties for the content cloned. */
            refContent.name = this._formArrayLength.toString(10); /* The element is added in the `FormArray` after the last position. */
            /* Overwrites some properties for the content cloned if it contains the `content.formControl` or `content.formSection` field. */
            if ((content.formControl) || (content.formSection)) {
                // refContent.label = ((refContent.label == undefined) ? (refContent.name) : (refContent.label + refContent.name));
                // refContent.ariaLabel = refContent.label;
            }
            /* Save the content cloned. */
            this.content.formSectionContent.push(refContent);
            result.push(refContent);
        }
        this._formArrayLength++;
        return result;
    }
    /**
     * Returns a new content that represents the clone of the specified content target.
     * It also sets the initial `value` field of each content representing a `FormControl`.
     * It clones the content smartly depending on the type of property.
     * It clones in deep until the next `FormArray`, then the next `FormArray` clones in deep until the next `FormArray`, and so on.
     * @private
     * @param {?} target The content object to clone.
     * @param {?} value The initial `value` field of each content representing a `FormControl`.
     * @param {?} canClone It is true if the function can clone the `formSectionContent` field; otherwise, false.
     * @return {?}
     */
    _cloneContent(target, value, canClone) {
        /* The content cloned. */
        /** @type {?} */
        let result = {};
        for (let prop in target) {
            switch (prop) {
                /* The `formControl` property special case. */
                case 'formControl':
                    {
                        result[prop] = cloneFormControl(target.formControl);
                        /* If this content (`result`) represents a `FormControl`, then the `value` field is initialized. */
                        result['value'] = value;
                        break;
                    }
                /* The `formSection` property special case. */
                case 'formSection':
                    {
                        result[prop] = cloneFormSection(target.formSection);
                        break;
                    }
                /* The `formSectionContent` property special case. */
                case 'formSectionContent':
                    {
                        if (canClone) /* Clones the `target.formSectionContent`. */ {
                            result[prop] = [];
                            for (let content of target.formSectionContent) {
                                if (content.formSection instanceof FormArray) {
                                    content.value = value[content.name];
                                    /* This `content.formSectionContent` will not be cloned because it belongs to a `FormArray` and it will be cloned when the `FormArray` is analyzed in the `ContainerControl` class. */
                                    result[prop].push(this._cloneContent(content, undefined /* It is not used in this case. */, false));
                                    content.value = undefined;
                                }
                                else {
                                    result[prop].push(this._cloneContent(content, value[content.name], canClone));
                                }
                            }
                        }
                        else /* Takes the same `target.formSectionContent` reference because `target` is a `FormArray` and its `formSectionContent` will be taken like a pattern. */ {
                            result[prop] = target.formSectionContent;
                        }
                        break;
                    }
                /* Copies the property without problem. */
                default:
                    {
                        result[prop] = target[prop];
                        break;
                    }
            }
        }
        return result;
    }
    /**
     * Creates the child components.
     * @protected
     * @param {?} componentsContent Components content array for creating the components.
     * @return {?}
     */
    createChildComponents(componentsContent) {
        for (let componentContent of componentsContent) {
            /* Creates a child component. */
            this.createChildComponent(componentContent);
        }
    }
    /**
     * Creates a child component.
     * @protected
     * @param {?} componentContent Component content for creating the component.
     * @return {?}
     */
    createChildComponent(componentContent) {
        this._cr = this._viewContainerRef.createComponent(this._componentFactoryResolver.resolveComponentFactory(componentContent.controlType));
        ((/** @type {?} */ (this._cr.instance))).content = componentContent;
    }
    /**
     * Initializes the control's value. It uses the `content.value` and it is already different of `undefined`.
     * It also checks if the specified `content.value` is correct. For internal use only.
     * @protected
     * @return {?}
     */
    initValue() {
        /* It does not need to do something because the child controls are already initialized. */
        // /* In this way, checks if the specified `content.value` is correct. */
        // this.content.formControl.setValue(this.content.value);
        // /* Marks the control as `touched`. */
        // this.content.formControl.markAsTouched({
        //     onlySelf: true
        // });
    }
    /**
     * Returns this instance.
     * @return {?}
     */
    get getInstance() {
        return this;
    }
    /**
     * Returns an array of controls that represents the `ContainerControl`'s child controls.
     * It is always set internally.
     * @return {?}
     */
    get containerControlChildren() {
        return this.content.containerControlChildren;
    }
    /**
     * If the `content.formSection` represents a `FormArray`, then this field returns
     * a pattern content that is `content.formSectionContent[0]` value; otherwise, returns `undefined`.
     * It is shared among controls.
     * It is used for adding a new element in the `content.formSectionContent`, that is,
     * for adding a new control in the `FormArray`.
     * By default, its value is `undefined`.
     * @return {?}
     */
    get formArrayPatternContent() {
        return this._formArrayPatternContent;
    }
    /**
     * If the `content.formSection` represents a `FormArray`, then this field returns
     * a pattern value that is a clone of the `content.value[0]` value, and sets all
     * its properties/values of built-in type to `undefined`; otherwise, returns `undefined`.
     * It is used for adding a new element in the `content.formSectionContent`.
     * By default, its value is `undefined`.
     * @return {?}
     */
    get formArrayPatternValue() {
        return this._formArrayPatternValue;
    }
    /**
     * Returns true if the container control has a dynamic length, that is, the `content.formSection` field
     * represents a `FormArray` and its length is not fixed; otherwise, false.
     * This property has sense only when the `content.formSection` field represents a `FormArray`.
     * @return {?}
     */
    get isDynamic() {
        return this.content.isDynamic;
    }
    /**
     * Returns true if the container control is a `FormArray`, that is, the `content.formSection` field
     * represents a `FormArray`; otherwise, false.
     * @return {?}
     */
    get isFormArray() {
        return this._isFormArray;
    }
    /**
     * Returns true if this container is empty; otherwise, false.
     * @return {?}
     */
    get isEmpty() {
        return (this.content.formSectionContent.length == 0);
    }
    /**
     * Returns true if an element can be removed from the `content.formSection`; otherwise, false.
     * Use along with `removeFromFormArray` and `clearFormArray` methods.
     * The `content.formSection` must be an instance of `FormArray`.
     * @return {?}
     */
    get canRemoveFromFormArray() {
        /* The method uses the `_formArrayLength` instead of `content.formSection` because
        the first one field is updated first and it has the answer more accurate than the second one field. */
        if (this.content.required) {
            return (this._formArrayLength > 1);
        }
        else {
            return (this._formArrayLength != 0);
        }
    }
    /**
     * Adds an empty element at the end of the `content.formSectionContent`; therefore one element
     * is added at the end of the `content.formSection` `FormArray`.
     * The `content.formSection` must be an instance of `FormArray`.
     * @return {?}
     */
    addToFormArray() {
        console.log('addToFormArray');
        if (this._isFormArray) {
            this.createChildComponents(this._initElemFormSectionContentToFormArray(this._formArrayPatternValue));
        }
        else {
            throw new Error(`For the '${this.content.name}' control, the 'content.formSection' value must be an instance of 'FormArray'.`);
        }
    }
    /**
     * Removes the element at the given `index` in the `content.formSectionContent`; therefore
     * the element at the given `index` is removed in the `content.formSection` `FormArray`.
     * The `content.formSection` must be an instance of `FormArray`.
     * @param {?} index Index in the array to remove the element.
     * @return {?}
     */
    removeFromFormArray(index) {
        console.log('removeFromFormArray', index);
        if (this._isFormArray) {
            //TODO: la variable `formArrayPatternContentLength` podría ser un campo de la clase. 
            /** @type {?} */
            let formArrayPatternContentLength = this._formArrayPatternContent.length;
            /** @type {?} */
            let i;
            /** @type {?} */
            let j;
            /** @type {?} */
            let k;
            this.content.containerControlChildren.splice(index, 1);
            this.content.formSectionContent.splice((index * formArrayPatternContentLength), formArrayPatternContentLength);
            ((/** @type {?} */ (this.content.formSection))).removeAt(index);
            for (i = formArrayPatternContentLength, j = index * formArrayPatternContentLength; i != 0; i--) {
                this._viewContainerRef.remove(j);
            }
            this._formArrayLength--;
            /* Updates the elements' index in the `content.formSectionContent` array from
            the specified `index` onwards. */
            for (k = (i = index * formArrayPatternContentLength) + formArrayPatternContentLength, j = this.content.formSectionContent.length; i < j; i++) {
                if (i == k) {
                    index++;
                    k += formArrayPatternContentLength;
                }
                this.content.formSectionContent[i].name = index.toString(10);
            }
        }
        else {
            throw new Error(`For the '${this.content.name}' control, the 'content.formSection' value must be an instance of 'FormArray'.`);
        }
    }
    /**
     * Removes all elements in the `content.formSectionContent`; therefore
     * all elements are removed in the `content.formSection` `FormArray`.
     * The `content.formSection` must be an instance of `FormArray`.
     * @return {?}
     */
    clearFormArray() {
        console.log('clearFormArray');
        if (this._isFormArray) {
            this.content.containerControlChildren = [];
            this.content.formSectionContent = [];
            ((/** @type {?} */ (this.content.formSection))).clear();
            this._viewContainerRef.clear();
            this._formArrayLength = 0;
            if (this.content.required) {
                /* The `FormArray` always has one element at least. */
                this.addToFormArray();
            }
        }
        else {
            throw new Error(`For the '${this.content.name}' control, the 'content.formSection' value must be an instance of 'FormArray'.`);
        }
    }
}
ContainerControl.propDecorators = {
    content: [{ type: Input }],
    _componentHost: [{ type: ViewChild, args: [GetViewContainerDirective, { static: true },] }]
};
if (false) {
    /**
     * Input field that contains the content of this class.
     * @type {?}
     */
    ContainerControl.prototype.content;
    /**
     * Returns the helper directive to mark valid insertion point in the `ContainerControl`'s template.
     * @type {?}
     * @protected
     */
    ContainerControl.prototype._componentHost;
    /**
     * Returns the view container of the element that will host the child components in the `ContainerControl`'s template.
     * This field can only be assigned in the `ContainerControl` class.
     * The `content.formSectionContent` and container's `_viewContainerRef` have the same length.
     * @type {?}
     * @protected
     */
    ContainerControl.prototype._viewContainerRef;
    /**
     * Returns the factory for a given component type.
     * This field can only be assigned in the `ContainerControl` class.
     * @type {?}
     * @protected
     */
    ContainerControl.prototype._componentFactoryResolver;
    /**
     * Returns the component created by a `ComponentFactory`.
     * For only internal use by the `createChildComponent` method.
     * @type {?}
     * @protected
     */
    ContainerControl.prototype._cr;
    /**
     * Returns true if the container control is a `FormArray`, that is, the `content.formSection` field
     * represents a `FormArray`; otherwise, false.
     * By default, its value is `false`.
     * @type {?}
     * @private
     */
    ContainerControl.prototype._isFormArray;
    /**
     * If the `content.formSection` represents a `FormArray`, then this field returns
     * a pattern content that is `content.formSectionContent` value; otherwise, returns `undefined`.
     * It is shared among controls.
     * It is used for adding a new element in the `content.formSectionContent`, that is,
     * for adding a new control in the `FormArray`.
     * By default, its value is `[]`.
     * @type {?}
     * @private
     */
    ContainerControl.prototype._formArrayPatternContent;
    /**
     * If the `content.formSection` represents a `FormArray`, then this field returns
     * a pattern value that is a copy of one value that can contain the `content.value` array, and sets all
     * its properties/values of built-in type to `undefined`; otherwise, returns `undefined`.
     * It is used for adding a new element in the `content.formSectionContent`, that is,
     * for adding a new control in the `FormArray`.
     * By default, its value is `undefined`.
     * @type {?}
     * @private
     */
    ContainerControl.prototype._formArrayPatternValue;
    /**
     * Returns the current `FormArray` length.
     * This field has sense only when the `content.formSection` field represents a `FormArray`.
     * By default, its value is `0`.
     * @type {?}
     * @private
     */
    ContainerControl.prototype._formArrayLength;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGFpbmVyLmNvbnRyb2wuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90b2NvLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9mb3Jtcy9jb250YWluZXIvY29udGFpbmVyLmNvbnRyb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBTUEsT0FBTyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQTRELE1BQU0sZUFBZSxDQUFDO0FBQzNHLE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFHdEQsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFFMUYsT0FBTyxFQUFpQyxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7OztBQUs1SCxzQ0F5REM7Ozs7Ozs7Ozs7SUFoREcsb0RBQWlDOzs7Ozs7Ozs7O0lBWWpDLHVDQUEwQjs7Ozs7Ozs7Ozs7O0lBWTFCLDhDQUFtQzs7Ozs7Ozs7SUFVbkMscUNBQW9COzs7Ozs7QUFtQnhCLE1BQU0sT0FBZ0IsZ0JBQWlCLFNBQVEsZ0JBQWdCOzs7O0lBNEYzRDtRQUVJLEtBQUssRUFBRSxDQUFDO1FBRVIsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUM7UUFDMUIsSUFBSSxDQUFDLHdCQUF3QixHQUFHLEVBQUcsQ0FBQztRQUNwQyxJQUFJLENBQUMsc0JBQXNCLEdBQUcsU0FBUyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7SUFDOUIsQ0FBQzs7Ozs7O0lBOUZNLE1BQU0sQ0FBQyxxQkFBcUI7UUFFL0IsT0FBTyxJQUFJLFNBQVMsQ0FBQyxFQUFHLEVBQUUsRUFBRyxDQUFDLENBQUM7SUFDbkMsQ0FBQzs7Ozs7O0lBTU0sTUFBTSxDQUFDLHFCQUFxQjtRQUUvQixPQUFPLElBQUksU0FBUyxDQUFDLEVBQUcsRUFBRSxFQUFHLENBQUMsQ0FBQztJQUNuQyxDQUFDOzs7Ozs7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QUFBLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFhLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNoRCxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDL0IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsQ0FBQztZQUUxQixJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUN6QjtnQkFDSSxzREFBc0Q7Z0JBQ3RELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQzthQUN6QjtTQUNKO2FBRUQ7WUFDSSxNQUFNLElBQUksS0FBSyxDQUFDLFlBQWEsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFLLGdGQUFnRixDQUFDLENBQUM7U0FDcEk7SUFDTCxDQUFDOzs7c0JBbm5CQSxLQUFLOzZCQVFMLFNBQVMsU0FBQyx5QkFBeUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Ozs7Ozs7SUFSdEQsbUNBQ2lDOzs7Ozs7SUFPakMsMENBQ29EOzs7Ozs7OztJQU9wRCw2Q0FBOEM7Ozs7Ozs7SUFNOUMscURBQThEOzs7Ozs7O0lBTTlELCtCQUFpQzs7Ozs7Ozs7SUFTakMsd0NBQThCOzs7Ozs7Ozs7OztJQVU5QixvREFBZ0Q7Ozs7Ozs7Ozs7O0lBVWhELGtEQUFvQzs7Ozs7Ozs7SUFPcEMsNENBQWlDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqICAgQ29weXJpZ2h0IChjKSAyMDIwIFVuaXZlcnNpZGFkIGRlIFBpbmFyIGRlbCBSw61vIFwiSGVybWFub3MgU2HDrXogTW9udGVzIGRlIE9jYVwiXG4gKiAgIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cblxuXG5pbXBvcnQgeyBJbnB1dCwgVmlld0NoaWxkLCBWaWV3Q29udGFpbmVyUmVmLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIENvbXBvbmVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRm9ybUFycmF5LCBGb3JtR3JvdXAgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbHMvaGVscGVycyc7XG5pbXBvcnQgeyBHZXRWaWV3Q29udGFpbmVyRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vY29yZS91dGlscy9nZXQtdmlldy1jb250YWluZXIuZGlyZWN0aXZlJztcblxuaW1wb3J0IHsgRm9ybVNlY3Rpb24sIEZvcm1GaWVsZENvbnRlbnQsIEZvcm1GaWVsZENvbnRyb2wsIGNsb25lRm9ybUNvbnRyb2wsIGNsb25lRm9ybVNlY3Rpb24gfSBmcm9tICcuLi9mb3JtLWZpZWxkLmNvbnRyb2wnO1xuXG4vKipcbiAqIEEgYmFzZSBpbnRlcmZhY2UgdGhhdCByZXByZXNlbnRzIHRoZSBjb250ZW50IG9mIGEgYENvbnRhaW5lckNvbnRyb2xgLiBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDb250YWluZXJDb250ZW50IGV4dGVuZHMgRm9ybUZpZWxkQ29udGVudFxue1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gYXJyYXkgb2YgY29udHJvbHMgdGhhdCByZXByZXNlbnRzIHRoZSBgQ29udGFpbmVyQ29udHJvbGAncyBjaGlsZCBjb250cm9scyB0aGF0IGFyZSBcbiAgICAgKiBzdG9yZWQgaW4gdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYDsgdGhhdCBpcywgYGNvbnRlbnQuY29udGFpbmVyQ29udHJvbENoaWxkcmVuYCBhbmQgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIFxuICAgICAqIGhhdmUgdGhlIHNhbWUgbGVuZ3RoLiBcbiAgICAgKiBJdCBpcyBhbHdheXMgc2V0IGludGVybmFsbHkuIFxuICAgICAqIEJ5IGRlZmF1bHQsIGl0cyB2YWx1ZSBpcyBgW11gLiBcbiAgICAgKi9cbiAgICBjb250YWluZXJDb250cm9sQ2hpbGRyZW4/OiBhbnlbXTtcblxuXG5cblx0LyoqXG5cdCAqIFJldHVybnMgdGhlIGBGb3JtU2VjdGlvbmAgdGhhdCB0cmFja3MgdGhlIHZhbHVlIGFuZCB2YWxpZGl0eSBzdGF0ZSBvZiB0aGUgaW50ZXJuYWwgXG4gICAgICogY2hpbGQgY29udHJvbHMgdGhhdCBjb250YWlucyB0aGlzIGNvbnRyb2wuIFxuICAgICAqIEltcGxlbWVudGF0aW9uIG5vdGVzOiBcbiAgICAgKiAgLSBSZXByZXNlbnRzIHRoZSBgRm9ybUdyb3VwYCBvciBgRm9ybUFycmF5YCB0aGF0IGNvbnRhaW5zIHRoZSBjaGlsZCBjb250cm9scy4gXG4gICAgICogIC0gVGhlIGBjb250ZW50LmNvbnRhaW5lckNvbnRyb2xDaGlsZHJlbmAgYW5kIGBjb250ZW50LmZvcm1TZWN0aW9uYCBoYXZlIHRoZSBzYW1lIGxlbmd0aC4gXG4gICAgICogIC0gSXQgbXVzdCBiZSBzcGVjaWZpZWQ7IG90aGVyd2lzZSwgYW4gZXhjZXB0aW9uIGlzIHRocm93bi4gXG5cdCAqL1xuICAgIGZvcm1TZWN0aW9uPzogRm9ybVNlY3Rpb247XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGNvbnRlbnRzIHRoYXQgcmVwcmVzZW50cyB0aGUgYENvbnRhaW5lckNvbnRyb2xgJ3MgY2hpbGQgY29udHJvbHMgdGhhdCBhcmUgXG4gICAgICogc3RvcmVkIGluIHRoZSBgVmlld0NvbnRhaW5lcmA7IHRoYXQgaXMsIGBjb250ZW50LmZvcm1TZWN0aW9uQ29udGVudGAgYW5kIGNvbnRhaW5lcidzIGBWaWV3Q29udGFpbmVyYCBcbiAgICAgKiBoYXZlIHRoZSBzYW1lIGxlbmd0aC4gXG4gICAgICogSW1wbGVtZW50YXRpb24gbm90ZXM6IFxuICAgICAqICAtIEl0IG11c3QgYmUgc3BlY2lmaWVkLCBhbmQgbXVzdCBoYXZlIGF0IGxlYXN0IG9uZSBlbGVtZW50OyBvdGhlcndpc2UsIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24uIFxuICAgICAqICAtIElmIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgZmllbGQgcmVwcmVzZW50cyBhIGBGb3JtQXJyYXlgLCB0aGVuIHRoZSBgbmFtZWAgZmllbGQgXG4gICAgICogb2YgYWxsIGVsZW1lbnRzIGluIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgIGFycmF5IHJlcHJlc2VudHMgdGhlIHBvc2l0aW9uIFxuICAgICAqIGluIHRoZSBhcnJheSBsaWtlIHN0cmluZy4gXG4gICAgICovXG4gICAgZm9ybVNlY3Rpb25Db250ZW50PzogUGFyYW1zPGFueT5bXTtcblxuXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGNvbnRhaW5lciBjb250cm9sIGhhcyBhIGR5bmFtaWMgbGVuZ3RoLCB0aGF0IGlzLCB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIGZpZWxkIFxuICAgICAqIHJlcHJlc2VudHMgYSBgRm9ybUFycmF5YCBhbmQgaXRzIGxlbmd0aCBpcyBub3QgZml4ZWQ7IG90aGVyd2lzZSwgZmFsc2UuIFxuICAgICAqIFRoaXMgZmllbGQgaGFzIHNlbnNlIG9ubHkgd2hlbiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIGZpZWxkIHJlcHJlc2VudHMgYSBgRm9ybUFycmF5YC4gXG4gICAgICogQnkgZGVmYXVsdCwgaXRzIHZhbHVlIGlzIGB0cnVlYC4gXG4gICAgICovXG4gICAgaXNEeW5hbWljPzogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEluIHRoaXMgY2FzZSwgdGhlIGBsYWJlbD86IHN0cmluZ2AgZmllbGQgaW5oZXJpdGVkIGZyb20gYEZvcm1GaWVsZENvbnRlbnRgIGlzIGludGVycHJldGVkIGFzOiBcbiAgICAgKiBSZXR1cm5zIHRoZSBjb250cm9sJ3MgdGl0bGUuIFxuICAgICAqIEJ5IGRlZmF1bHQsIGl0cyB2YWx1ZSBpcyBgJydgLiBFYWNoIGNvbnRyb2wgc2V0cyBpdHMgb3duIGxhYmVsICh0aXRsZSkuIFxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogSW4gdGhpcyBjYXNlLCB0aGUgYHJlcXVpcmVkPzogYm9vbGVhbmAgZmllbGQgaW5oZXJpdGVkIGZyb20gYEZvcm1GaWVsZENvbnRlbnRgIGlzIGludGVycHJldGVkIGFzOiBcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGNvbnRhaW5lciBjb250cm9sIG11c3QgaGF2ZSBvbmUgY2hpbGQgY29udHJvbCBhdCBsZWFzdDsgb3RoZXJ3aXNlLCBmYWxzZS4gXG4gICAgICogVGhpcyBmaWVsZCBoYXMgc2Vuc2Ugb25seSB3aGVuIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgZmllbGQgcmVwcmVzZW50cyBhIGBGb3JtQXJyYXlgLiBcbiAgICAgKiBCeSBkZWZhdWx0LCBpdHMgdmFsdWUgaXMgYGZhbHNlYC4gXG4gICAgICovXG59XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgYmFzZSBhYnN0cmFjdCBjbGFzcyBmb3IgYSBjb250cm9sIHRoYXQgY29udGFpbnMgb25lIG9yIG1vcmUgY29udHJvbHMuIFxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29udGFpbmVyQ29udHJvbCBleHRlbmRzIEZvcm1GaWVsZENvbnRyb2xcbntcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgYEZvcm1Hcm91cGAgYnkgZGVmYXVsdC4gXG4gICAgICogSXRzIHZhbHVlIGlzIGVtcHR5IG9iamVjdCwgYW5kIGRvZXMgbm90IGhhdmUgdmFsaWRhdG9ycy4gXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXRGb3JtR3JvdXBCeURlZmF1bHQoKTogRm9ybUdyb3VwXG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IEZvcm1Hcm91cCh7IH0sIFsgXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGBGb3JtQXJyYXlgIGJ5IGRlZmF1bHQuIFxuICAgICAqIEl0cyB2YWx1ZSBpcyBlbXB0eSBhcnJheSwgYW5kIGRvZXMgbm90IGhhdmUgdmFsaWRhdG9ycy4gXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXRGb3JtQXJyYXlCeURlZmF1bHQoKTogRm9ybUFycmF5XG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IEZvcm1BcnJheShbIF0sIFsgXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5wdXQgZmllbGQgdGhhdCBjb250YWlucyB0aGUgY29udGVudCBvZiB0aGlzIGNsYXNzLiBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBjb250ZW50OiBDb250YWluZXJDb250ZW50O1xuXG5cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGhlbHBlciBkaXJlY3RpdmUgdG8gbWFyayB2YWxpZCBpbnNlcnRpb24gcG9pbnQgaW4gdGhlIGBDb250YWluZXJDb250cm9sYCdzIHRlbXBsYXRlLiBcbiAgICAgKi9cbiAgICBAVmlld0NoaWxkKEdldFZpZXdDb250YWluZXJEaXJlY3RpdmUsIHsgc3RhdGljOiB0cnVlIH0pXG4gICAgcHJvdGVjdGVkIF9jb21wb25lbnRIb3N0OiBHZXRWaWV3Q29udGFpbmVyRGlyZWN0aXZlO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmlldyBjb250YWluZXIgb2YgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGhvc3QgdGhlIGNoaWxkIGNvbXBvbmVudHMgaW4gdGhlIGBDb250YWluZXJDb250cm9sYCdzIHRlbXBsYXRlLiBcbiAgICAgKiBUaGlzIGZpZWxkIGNhbiBvbmx5IGJlIGFzc2lnbmVkIGluIHRoZSBgQ29udGFpbmVyQ29udHJvbGAgY2xhc3MuIFxuICAgICAqIFRoZSBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgIGFuZCBjb250YWluZXIncyBgX3ZpZXdDb250YWluZXJSZWZgIGhhdmUgdGhlIHNhbWUgbGVuZ3RoLiBcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3ZpZXdDb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWY7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBmYWN0b3J5IGZvciBhIGdpdmVuIGNvbXBvbmVudCB0eXBlLiBcbiAgICAgKiBUaGlzIGZpZWxkIGNhbiBvbmx5IGJlIGFzc2lnbmVkIGluIHRoZSBgQ29udGFpbmVyQ29udHJvbGAgY2xhc3MuIFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfY29tcG9uZW50RmFjdG9yeVJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXI7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjb21wb25lbnQgY3JlYXRlZCBieSBhIGBDb21wb25lbnRGYWN0b3J5YC4gXG4gICAgICogRm9yIG9ubHkgaW50ZXJuYWwgdXNlIGJ5IHRoZSBgY3JlYXRlQ2hpbGRDb21wb25lbnRgIG1ldGhvZC4gXG4gICAgICovXG4gICAgcHJvdGVjdGVkIF9jcjogQ29tcG9uZW50UmVmPGFueT47XG5cblxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBjb250YWluZXIgY29udHJvbCBpcyBhIGBGb3JtQXJyYXlgLCB0aGF0IGlzLCB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIGZpZWxkIFxuICAgICAqIHJlcHJlc2VudHMgYSBgRm9ybUFycmF5YDsgb3RoZXJ3aXNlLCBmYWxzZS4gXG4gICAgICogQnkgZGVmYXVsdCwgaXRzIHZhbHVlIGlzIGBmYWxzZWAuIFxuICAgICAqL1xuICAgIHByaXZhdGUgX2lzRm9ybUFycmF5OiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogSWYgdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCByZXByZXNlbnRzIGEgYEZvcm1BcnJheWAsIHRoZW4gdGhpcyBmaWVsZCByZXR1cm5zIFxuICAgICAqIGEgcGF0dGVybiBjb250ZW50IHRoYXQgaXMgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YCB2YWx1ZTsgb3RoZXJ3aXNlLCByZXR1cm5zIGB1bmRlZmluZWRgLiBcbiAgICAgKiBJdCBpcyBzaGFyZWQgYW1vbmcgY29udHJvbHMuIFxuICAgICAqIEl0IGlzIHVzZWQgZm9yIGFkZGluZyBhIG5ldyBlbGVtZW50IGluIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgLCB0aGF0IGlzLCBcbiAgICAgKiBmb3IgYWRkaW5nIGEgbmV3IGNvbnRyb2wgaW4gdGhlIGBGb3JtQXJyYXlgLiBcbiAgICAgKiBCeSBkZWZhdWx0LCBpdHMgdmFsdWUgaXMgYFtdYC4gXG4gICAgICovXG4gICAgcHJpdmF0ZSBfZm9ybUFycmF5UGF0dGVybkNvbnRlbnQ6IFBhcmFtczxhbnk+W107XG5cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIHJlcHJlc2VudHMgYSBgRm9ybUFycmF5YCwgdGhlbiB0aGlzIGZpZWxkIHJldHVybnMgXG4gICAgICogYSBwYXR0ZXJuIHZhbHVlIHRoYXQgaXMgYSBjb3B5IG9mIG9uZSB2YWx1ZSB0aGF0IGNhbiBjb250YWluIHRoZSBgY29udGVudC52YWx1ZWAgYXJyYXksIGFuZCBzZXRzIGFsbCBcbiAgICAgKiBpdHMgcHJvcGVydGllcy92YWx1ZXMgb2YgYnVpbHQtaW4gdHlwZSB0byBgdW5kZWZpbmVkYDsgb3RoZXJ3aXNlLCByZXR1cm5zIGB1bmRlZmluZWRgLiBcbiAgICAgKiBJdCBpcyB1c2VkIGZvciBhZGRpbmcgYSBuZXcgZWxlbWVudCBpbiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YCwgdGhhdCBpcywgXG4gICAgICogZm9yIGFkZGluZyBhIG5ldyBjb250cm9sIGluIHRoZSBgRm9ybUFycmF5YC4gXG4gICAgICogQnkgZGVmYXVsdCwgaXRzIHZhbHVlIGlzIGB1bmRlZmluZWRgLiBcbiAgICAgKi9cbiAgICBwcml2YXRlIF9mb3JtQXJyYXlQYXR0ZXJuVmFsdWU6IGFueTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgYEZvcm1BcnJheWAgbGVuZ3RoLiBcbiAgICAgKiBUaGlzIGZpZWxkIGhhcyBzZW5zZSBvbmx5IHdoZW4gdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBmaWVsZCByZXByZXNlbnRzIGEgYEZvcm1BcnJheWAuIFxuICAgICAqIEJ5IGRlZmF1bHQsIGl0cyB2YWx1ZSBpcyBgMGAuIFxuICAgICAqL1xuICAgIHByaXZhdGUgX2Zvcm1BcnJheUxlbmd0aDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0cyBhIG5ldyBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLiBcbiAgICAgKi9cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLl9pc0Zvcm1BcnJheSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9mb3JtQXJyYXlQYXR0ZXJuQ29udGVudCA9IFsgXTtcbiAgICAgICAgdGhpcy5fZm9ybUFycmF5UGF0dGVyblZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9mb3JtQXJyYXlMZW5ndGggPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSBgY29udGVudGAgaW5wdXQgcHJvcGVydHkuIFxuICAgICAqIEBwYXJhbSBsYWJlbCBUaGUgZGVmYXVsdCBsYWJlbCB0byB1c2UuIEl0IGlzIHVzZWQgaWYgdGhlIGBjb250ZW50LmxhYmVsYCBpcyBub3Qgc3BlY2lmaWVkLiBcbiAgICAgKiBAcGFyYW0gcGxhY2Vob2xkZXIgSXQgaXMgTk9UIHVzZWQgaGVyZS4gRml4IHRoYXQuIFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBpbml0KGxhYmVsOiBzdHJpbmcsIHBsYWNlaG9sZGVyOiBzdHJpbmcgPSAnJyk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8qIFNldHMgdGhlIGRlZmF1bHQgdmFsdWVzLiAqL1xuXG4gICAgICAgIHN1cGVyLmluaXQobGFiZWwsIHBsYWNlaG9sZGVyKTtcblxuICAgICAgICBpZiAodGhpcy5jb250ZW50LmZvcm1TZWN0aW9uID09IHVuZGVmaW5lZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGb3IgdGhlICckeyB0aGlzLmNvbnRlbnQubmFtZSB9JyBjb250cm9sLCB0aGUgJ2NvbnRlbnQuZm9ybVNlY3Rpb24nIHZhbHVlIGNhbiBub3QgYmUgdW5kZWZpbmVkOyBpdCBtdXN0IGJlIGEgJ0Zvcm1Hcm91cCcgb3IgJ0Zvcm1BcnJheScgdmFsdWUuYCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoKHRoaXMuY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnQgPT0gdW5kZWZpbmVkKSB8fCAodGhpcy5jb250ZW50LmZvcm1TZWN0aW9uQ29udGVudC5sZW5ndGggPT0gMCkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRm9yIHRoZSAnJHsgdGhpcy5jb250ZW50Lm5hbWUgfScgY29udHJvbCwgdGhlICdjb250ZW50LmZvcm1TZWN0aW9uQ29udGVudCcgYXJyYXkgY2FuIG5vdCBiZSB1bmRlZmluZWQsIGFuZCBtdXN0IGhhdmUgYXQgbGVhc3Qgb25lIGVsZW1lbnQuYCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pc0Zvcm1BcnJheSA9IHRoaXMuY29udGVudC5mb3JtU2VjdGlvbiBpbnN0YW5jZW9mIEZvcm1BcnJheTtcbiAgICAgICAgaWYgKHRoaXMuX2lzRm9ybUFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb250ZW50LmlzRHluYW1pYyA9PSB1bmRlZmluZWQpIHRoaXMuY29udGVudC5pc0R5bmFtaWMgPSB0cnVlOyAgLyogQnkgZGVmYXVsdCwgaXRzIHZhbHVlIGlzIGB0cnVlYC4gKi9cbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnQucmVxdWlyZWQgPT0gdW5kZWZpbmVkKSB0aGlzLmNvbnRlbnQucmVxdWlyZWQgPSBmYWxzZTsgICAvKiBCeSBkZWZhdWx0LCBpdHMgdmFsdWUgaXMgYGZhbHNlYC4gKi9cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnQuaXNEeW5hbWljICE9IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKGBGb3IgdGhlICckeyB0aGlzLmNvbnRlbnQubmFtZSB9JyBjb250cm9sLCB0aGUgJ2NvbnRlbnQuaXNEeW5hbWljJyB2YWx1ZSBtdXN0IG5vdCBleGlzdCBiZWNhdXNlIHRoZSAnY29udGVudC5mb3JtU2VjdGlvbicgdmFsdWUgaXMgYSAnRm9ybUdyb3VwJy5gKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnQucmVxdWlyZWQgIT0gdW5kZWZpbmVkKSB0aHJvdyBuZXcgRXJyb3IoYEZvciB0aGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wsIHRoZSAnY29udGVudC5yZXF1aXJlZCcgdmFsdWUgbXVzdCBub3QgZXhpc3QgYmVjYXVzZSB0aGUgJ2NvbnRlbnQuZm9ybVNlY3Rpb24nIHZhbHVlIGlzIGEgJ0Zvcm1Hcm91cCcuYCk7XG4gICAgICAgICAgICBpZiAodGhpcy5jb250ZW50LnZhbHVlICE9IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKGBGb3IgdGhlICckeyB0aGlzLmNvbnRlbnQubmFtZSB9JyBjb250cm9sLCB0aGUgJ2NvbnRlbnQudmFsdWUnIHZhbHVlIG11c3Qgbm90IGV4aXN0IGJlY2F1c2UgdGhlICdjb250ZW50LmZvcm1TZWN0aW9uJyB2YWx1ZSBpcyBhICdGb3JtR3JvdXAnLmApO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdmlld0NvbnRhaW5lclJlZiA9IHRoaXMuX2NvbXBvbmVudEhvc3Qudmlld0NvbnRhaW5lclJlZjtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50RmFjdG9yeVJlc29sdmVyID0gdGhpcy5fY29tcG9uZW50SG9zdC5jb21wb25lbnRGYWN0b3J5UmVzb2x2ZXI7XG5cbiAgICAgICAgLyogSW5pdGlhbGl6ZXMgdGhlIGBjb250ZW50LmNvbnRhaW5lckNvbnRyb2xDaGlsZHJlbmAuICovXG4gICAgICAgIHRoaXMuY29udGVudC5jb250YWluZXJDb250cm9sQ2hpbGRyZW4gPSBbIF07XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzRm9ybUFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb250ZW50LnZhbHVlID09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAnJHsgdGhpcy5jb250ZW50Lm5hbWUgfScgY29udHJvbCBpcyBjb25zdHJ1Y3RlZCBkeW5hbWljYWxseSB1c2luZyAnRm9ybUFycmF5Jy4gSXRzICdjb250ZW50LnZhbHVlJyBhcnJheSBjYW4gbm90IGJlIHVuZGVmaW5lZC5gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCh0aGlzLmNvbnRlbnQudmFsdWUubGVuZ3RoID09IDApICYmICghdGhpcy5jb250ZW50LmlzRHluYW1pYykgJiYgKHRoaXMuY29udGVudC5yZXF1aXJlZCkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wgaGFzIG5vdCBzZW5zZSBiZWNhdXNlIGl0cyAnY29udGVudC52YWx1ZScgYXJyYXkgbGVuZ3RoIGlzIHplcm8sIGFuZCBpdHMgJ2NvbnRlbnQuaXNEeW5hbWljJyB2YWx1ZSBpcyBmYWxzZSwgYW5kIGl0cyAnY29udGVudC5yZXF1aXJlZCcgdmFsdWUgaXMgdHJ1ZS5gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5pbml0Rm9ybVNlY3Rpb25Db250ZW50VG9Gb3JtQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIFNldHMgdGhlIHBhcmVudCBjb250cm9sIHRvIGl0cyBjaGlsZHJlbi4gKi9cbiAgICAgICAgICAgIHRoaXMuc2V0UGFyZW50VG9DaGlsZHJlbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGV0IHRlbXA6IHN0cmluZyA9IChpc0FiYnJldmlhdGlvbikgPyB0aGlzLmNvbnRlbnQubGFiZWwgOiB0aGlzLmNvbnRlbnQubGFiZWwudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy8gdGhpcy52YWxpZGF0aW9uRXJyb3JfcmVxdWlyZWQgPSBgVGhlICR7IHRlbXAgfSBjYW4gbm90IGJlIGVtcHR5LmA7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqIGBtYXQtZm9ybS1maWVsZGAgcHJvcGVydGllcy4gKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8vIGlmICh0aGlzLmNvbnRlbnQuYXBwZWFyYW5jZSA9PSB1bmRlZmluZWQpIHRoaXMuY29udGVudC5hcHBlYXJhbmNlID0gVGV4dElucHV0QXBwZWFyYW5jZS5zdGFuZGFyZDtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogYG1hdC1oaW50YCBwcm9wZXJ0aWVzLiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLy8gaWYgKGFsd2F5c0hpbnQgJiYgKHRoaXMuY29udGVudC5zdGFydEhpbnQgPT0gdW5kZWZpbmVkKSAmJiAodGhpcy5jb250ZW50LmVuZEhpbnQgPT0gdW5kZWZpbmVkKSlcbiAgICAgICAgLy8ge1xuICAgICAgICAvLyAgICAgdGhpcy5jb250ZW50LnN0YXJ0SGludCA9IG5ldyBIaW50VmFsdWUoSGludFBvc2l0aW9uLnN0YXJ0LCBgV3JpdGUgYSB2YWxpZCAkeyB0ZW1wIH0uYCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gZWxzZVxuICAgICAgICAvLyB7XG4gICAgICAgIC8vICAgICBpZiAodGhpcy5jb250ZW50LnN0YXJ0SGludCAhPSB1bmRlZmluZWQpIHRoaXMuY29udGVudC5zdGFydEhpbnQuc2V0RGVmYXVsdFZhbHVlSWZVbmRlZmluZWRfc2V0UG9zaXRpb24oSGludFBvc2l0aW9uLnN0YXJ0KTtcbiAgICAgICAgLy8gICAgIGlmICh0aGlzLmNvbnRlbnQuZW5kSGludCAhPSB1bmRlZmluZWQpIHRoaXMuY29udGVudC5lbmRIaW50LnNldERlZmF1bHRWYWx1ZUlmVW5kZWZpbmVkX3NldFBvc2l0aW9uKEhpbnRQb3NpdGlvbi5lbmQpO1xuICAgICAgICAvLyB9XG5cbiAgICAgICAgLyogQWRkcyB0aGlzIGNvbnRyb2wgYXMgYSBjaGlsZCB0byB0aGUgYGNvbnRlbnQucGFyZW50Rm9ybVNlY3Rpb25gLiBcbiAgICAgICAgSXQgbXVzdCBiZSBjYWxsZWQgYXQgdGhlIGVuZCBiZWZvcmUgY2FsbGluZyBgY3JlYXRlQ2hpbGRDb21wb25lbnRzYCBtZXRob2QuICovXG4gICAgICAgIGlmICh0aGlzLmNvbnRlbnQucGFyZW50Rm9ybVNlY3Rpb24gIT0gdW5kZWZpbmVkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmFkZEFzQ2hpbGRDb250cm9sKHRoaXMsIHRoaXMuY29udGVudC5mb3JtU2VjdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBDcmVhdGVzIHRoZSBjaGlsZCBjb21wb25lbnRzLiAqL1xuICAgICAgICB0aGlzLmNyZWF0ZUNoaWxkQ29tcG9uZW50cyh0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YCBhcnJheSBjb3JyZWN0bHkgZGVwZW5kaW5nIG9uIHRoZSBgY29udGVudC52YWx1ZWAuIFxuICAgICAqIEluIHRoaXMgY2FzZSwgYGNvbnRlbnQudmFsdWVgIGlzIGFuIGFycmF5LiBGb3IgZWFjaCBlbGVtZW50IGluIHRoZSBgY29udGVudC52YWx1ZWAsIGEgY2xvbmluZyBcbiAgICAgKiBpcyBkb25lIHRvIHRoZSBgX2Zvcm1BcnJheVBhdHRlcm5Db250ZW50YCBhcnJheSwgYW5kIGl0IGlzIGFkZGVkIGluIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgOyBcbiAgICAgKiB0aGVyZWZvcmUgb25lIGVsZW1lbnQgaXMgYWRkZWQgaW4gdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBgRm9ybUFycmF5YC4gXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGluaXRGb3JtU2VjdGlvbkNvbnRlbnRUb0Zvcm1BcnJheSgpOiB2b2lkXG4gICAge1xuICAgICAgICAvKiBBdCB0aGlzIHBvaW50LCBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgIGhhcyBhdCBsZWFzdCBvbmUgZWxlbWVudC4gKi9cblxuICAgICAgICAvKiBTYXZlcyB0aGUgcGF0dGVybiBjb250ZW50LCB0aGF0IGlzLCBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgLiBcbiAgICAgICAgSXQgaXMgc2hhcmVkIGFtb25nIGNvbnRyb2xzLiAqL1xuICAgICAgICB0aGlzLl9mb3JtQXJyYXlQYXR0ZXJuQ29udGVudCA9IHRoaXMuY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnQ7XG4gICAgICAgIC8qIFRoZSBgRm9ybUFycmF5YCBpcyBlbXB0eSBpbml0aWFsbHkuICovXG4gICAgICAgIHRoaXMuY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnQgPSBbIF07XG5cbiAgICAgICAgLyogU2F2ZXMgdGhlIHBhdHRlcm4gdmFsdWUsIHRoYXQgaXMsIGNyZWF0ZXMgdGhlIHBhdHRlcm4gdmFsdWUgZm9sbG93aW5nIHRoZSBgX2Zvcm1BcnJheVBhdHRlcm5Db250ZW50YCBzdHJ1Y3R1cmUuIFxuICAgICAgICBUaGUgcmVzdWx0IHZhbHVlIHJlcHJlc2VudHMgYSBjb3B5IG9mIG9uZSB2YWx1ZSB0aGF0IGNhbiBjb250YWluIHRoZSBgY29udGVudC52YWx1ZWAgYXJyYXksIGFuZCBcbiAgICAgICAgc2V0cyBhbGwgaXRzIHByb3BlcnRpZXMvdmFsdWVzIG9mIGJ1aWx0LWluIHR5cGUgdG8gYHVuZGVmaW5lZGAuIFxuICAgICAgICBJdCBkb2VzIG5vdCBjbG9uZSBhIHZhbHVlIGZyb20gdGhlIGBjb250ZW50LnZhbHVlYCBhcnJheSBiZWNhdXNlIHRoZSBhcnJheSBjYW4gYmUgZW1wdHkuIFxuICAgICAgICBJdCBjcmVhdGVzIGluIGRlZXAgdW50aWwgdGhlIG5leHQgYEZvcm1BcnJheWAsIHRoZW4gdGhlIG5leHQgYEZvcm1BcnJheWAgY3JlYXRlcyBpbiBkZWVwIHVudGlsIHRoZSBuZXh0IGBGb3JtQXJyYXlgLCBhbmQgc28gb24uIFxuICAgICAgICBJdCBpcyB0aGUgZmlyc3QgdGltZSB0aGF0IHRoZSBgX2Zvcm1BcnJheVBhdHRlcm5Db250ZW50YCBpcyB0cmF2ZWxsZWQsIHRoZXJlZm9yZSB0aGUgYGNyZWF0ZVZhbHVlVG9VbmRlZmluZWRgIG1ldGhvZCBkb2VzIHZlcmlmaWNhdGlvbnMuICovXG4gICAgICAgIHRoaXMuX2Zvcm1BcnJheVBhdHRlcm5WYWx1ZSA9IHRoaXMuY3JlYXRlVmFsdWVUb1VuZGVmaW5lZCgpO1xuXG4gICAgICAgIC8qIElmIHRoZSBgY29udGVudC5yZXF1aXJlZGAgZmllbGQgaXMgdHJ1ZSwgdGhlbiB0aGUgY29udGFpbmVyIGNvbnRyb2wgbXVzdCBoYXZlIG9uZSBjaGlsZCBjb250cm9sIGF0IGxlYXN0LiAqL1xuICAgICAgICBpZiAoKHRoaXMuY29udGVudC5yZXF1aXJlZCkgJiYgKHRoaXMuY29udGVudC52YWx1ZS5sZW5ndGggPT0gMCkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIEl0IGNhbiBwdXNoIHRoZSBgX2Zvcm1BcnJheVBhdHRlcm5WYWx1ZWAgYW5kIGRvZXMgbm90IHB1c2ggaXRzIGNsb25lIGJlY2F1c2UgXG4gICAgICAgICAgICBib3RoIHZhbHVlcyBoYXZlIHRoZSBzYW1lIHByb3BlcnRpZXMgYW5kIHRoZXJlIGlzIG5vdCBwcm9ibGVtLiAqL1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LnZhbHVlWzBdID0gdGhpcy5fZm9ybUFycmF5UGF0dGVyblZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogVGhlIGBGb3JtQXJyYXlgIHdpbGwgY29udGFpbiBvbmUgZWxlbWVudCBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBgY29udGVudC52YWx1ZWAuICovXG4gICAgICAgIGZvcihsZXQgdmFsIG9mIHRoaXMuY29udGVudC52YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5faW5pdEVsZW1Gb3JtU2VjdGlvbkNvbnRlbnRUb0Zvcm1BcnJheSh2YWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcGFyZW50IGNvbnRyb2wgdG8gaXRzIGNoaWxkcmVuLiBcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc2V0UGFyZW50VG9DaGlsZHJlbigpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50LmZvckVhY2godGhpcy5zZXRQYXJlbnRUb0NoaWxkLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBwYXJlbnQgY29udHJvbCB0byBvbmUgY2hpbGQuIFxuICAgICAqIEBwYXJhbSBmZmMgVGhlIGNoaWxkIHRvIHNldCB0aGUgcGFyZW50IGNvbnRyb2wuIFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBzZXRQYXJlbnRUb0NoaWxkKGZmYzogRm9ybUZpZWxkQ29udGVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8qIFNldHMgdGhlIHBhcmVudCBgQ29udGFpbmVyQ29udHJvbGAgdG8gaXRzIGNoaWxkcmVuLiAqL1xuICAgICAgICBmZmMucGFyZW50Q29udGFpbmVyQ29udHJvbCA9IHRoaXM7XG5cbiAgICAgICAgLyogU2V0cyB0aGUgcGFyZW50IGBGb3JtU2VjdGlvbmAgdG8gaXRzIGNoaWxkcmVuIGlmIHRoZXkgaGF2ZSBnb3Qgbm90aGluZy4gKi9cbiAgICAgICAgZmZjLnBhcmVudEZvcm1TZWN0aW9uID0gdGhpcy5jb250ZW50LmZvcm1TZWN0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgdmFsdWUgdGhhdCBpcyBjcmVhdGVkIGZvbGxvd2luZyB0aGUgYF9mb3JtQXJyYXlQYXR0ZXJuQ29udGVudGAgc3RydWN0dXJlLiBcbiAgICAgKiBJdCBhbHNvIHNldHMgYWxsIGl0cyBwcm9wZXJ0aWVzL3ZhbHVlcyBvZiBidWlsdC1pbiB0eXBlIHRvIGB1bmRlZmluZWRgLiBcbiAgICAgKiBJdCBjcmVhdGVzIHRoZSB2YWx1ZSBzbWFydGx5IGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZiBjb250ZW50LiBcbiAgICAgKiBJdCBjcmVhdGVzIGluIGRlZXAgdW50aWwgdGhlIG5leHQgYEZvcm1BcnJheWAsIHRoZW4gdGhlIG5leHQgYEZvcm1BcnJheWAgY3JlYXRlcyBpbiBkZWVwIHVudGlsIHRoZSBuZXh0IGBGb3JtQXJyYXlgLCBhbmQgc28gb24uIFxuICAgICAqIEl0IGlzIHRoZSBmaXJzdCB0aW1lIHRoYXQgdGhlIGBfZm9ybUFycmF5UGF0dGVybkNvbnRlbnRgIGlzIHRyYXZlbGxlZCwgdGhlcmVmb3JlIHRoZSBgY3JlYXRlVmFsdWVUb1VuZGVmaW5lZGAgbWV0aG9kIGRvZXMgdmVyaWZpY2F0aW9ucy4gXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNyZWF0ZVZhbHVlVG9VbmRlZmluZWQoKTogYW55XG4gICAge1xuICAgICAgICBsZXQgcmVzdWx0OiBhbnk7XG4gICAgICAgIC8qIFRoZSBgX2Zvcm1BcnJheVBhdHRlcm5Db250ZW50YCBhcnJheSBjYW4gaGF2ZSBvbmUgZWxlbWVudCBvbmx5IHdpdGggdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBmaWVsZC4gKi9cbiAgICAgICAgbGV0IGFscmVhZHlIYXNGb3JtU2VjdGlvbjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgICAgIGZvcihsZXQgY29udGVudCBvZiB0aGlzLl9mb3JtQXJyYXlQYXR0ZXJuQ29udGVudClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQuZm9ybUNvbnRyb2wpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGFscmVhZHlIYXNGb3JtU2VjdGlvbikgdGhyb3cgbmV3IEVycm9yKGBGb3IgdGhlICckeyB0aGlzLmNvbnRlbnQubmFtZSB9JyBjb250cm9sLCB0aGUgJ2NvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50JyBhcnJheSBjYW4gaGF2ZSBvbmUgZWxlbWVudCBvbmx5IHdpdGggdGhlICdjb250ZW50LmZvcm1Db250cm9sJyBvciAnY29udGVudC5mb3JtU2VjdGlvbicgZmllbGQuYCk7XG5cbiAgICAgICAgICAgICAgICBhbHJlYWR5SGFzRm9ybVNlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbnRlbnQuZm9ybVNlY3Rpb24pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGFscmVhZHlIYXNGb3JtU2VjdGlvbikgdGhyb3cgbmV3IEVycm9yKGBGb3IgdGhlICckeyB0aGlzLmNvbnRlbnQubmFtZSB9JyBjb250cm9sLCB0aGUgJ2NvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50JyBhcnJheSBjYW4gaGF2ZSBvbmUgZWxlbWVudCBvbmx5IHdpdGggdGhlICdjb250ZW50LmZvcm1Db250cm9sJyBvciAnY29udGVudC5mb3JtU2VjdGlvbicgZmllbGQuYCk7XG5cbiAgICAgICAgICAgICAgICBhbHJlYWR5SGFzRm9ybVNlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuX2NyZWF0ZVZhbHVlVG9VbmRlZmluZWQoY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBUaGUgcmVzdCBvZiBgY29udGVudGBzIGRvIG5vdCBjb250YWluIGEgYHZhbHVlYCBmaWVsZCBvZiBpbnRlcmVzdC4gKi9cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYWxyZWFkeUhhc0Zvcm1TZWN0aW9uKSB0aHJvdyBuZXcgRXJyb3IoYEZvciB0aGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wsIHRoZSAnY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnQnIGFycmF5IG11c3QgaGF2ZSBvbmUgZWxlbWVudCBvbmx5IGFtb25nIGFsbCB3aXRoIHRoZSAnY29udGVudC5mb3JtQ29udHJvbCcgb3IgJ2NvbnRlbnQuZm9ybVNlY3Rpb24nIGZpZWxkLmApO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHByaXZhdGUgX2NyZWF0ZVZhbHVlVG9VbmRlZmluZWQodGFyZ2V0OiBQYXJhbXM8YW55Pik6IGFueVxuICAgIHtcbiAgICAgICAgaWYgKHRhcmdldC5mb3JtU2VjdGlvbiBpbnN0YW5jZW9mIEZvcm1BcnJheSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIFsgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQ6IGFueSA9IHsgfTtcblxuICAgICAgICAgICAgZm9yKGxldCBjb250ZW50IG9mIHRhcmdldC5mb3JtU2VjdGlvbkNvbnRlbnQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQuZm9ybUNvbnRyb2wpIHJlc3VsdFtjb250ZW50Lm5hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvbnRlbnQuZm9ybVNlY3Rpb24pIHJlc3VsdFtjb250ZW50Lm5hbWVdID0gdGhpcy5fY3JlYXRlVmFsdWVUb1VuZGVmaW5lZChjb250ZW50KTtcbiAgICAgICAgICAgICAgICAvKiBUaGUgcmVzdCBvZiBgY29udGVudGBzIGRvIG5vdCBjb250YWluIGEgYHZhbHVlYCBmaWVsZCBvZiBpbnRlcmVzdC4gKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGFuZCByZXR1cm5zIGEgY2xvbmUgb2YgdGhlIGBfZm9ybUFycmF5UGF0dGVybkNvbnRlbnRgIGFycmF5IGNvcnJlY3RseSBcbiAgICAgKiBkZXBlbmRpbmcgb24gdGhlIHNwZWNpZmllZCBgdmFsdWVgLiBcbiAgICAgKiBUaGlzIGNsb25lIGlzIGFsc28gYWRkZWQgaW4gdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uQ29udGVudGAgYXJyYXkuIFxuICAgICAqIEBwYXJhbSB2YWx1ZSBUaGUgaW5pdGlhbCBgdmFsdWVgIGZpZWxkIG9mIGVhY2ggY29udGVudCByZXByZXNlbnRpbmcgYSBgRm9ybUNvbnRyb2xgLiBcbiAgICAgKi9cbiAgICBwcml2YXRlIF9pbml0RWxlbUZvcm1TZWN0aW9uQ29udGVudFRvRm9ybUFycmF5KHZhbHVlOiBhbnkpOiBQYXJhbXM8YW55PltdXG4gICAge1xuICAgICAgICAvKiBUaGUgY29udGVudCBhcnJheSBjbG9uZWQuICovXG4gICAgICAgIGxldCByZXN1bHQ6IFBhcmFtczxhbnk+W10gPSBbIF07XG4gICAgICAgIGxldCByZWZDb250ZW50OiBQYXJhbXM8YW55PjtcblxuICAgICAgICBmb3IobGV0IGNvbnRlbnQgb2YgdGhpcy5fZm9ybUFycmF5UGF0dGVybkNvbnRlbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIENsb25lcyBpbiBkZWVwIHVudGlsIHRoZSBuZXh0IGBGb3JtQXJyYXlgLCB0aGVuIHRoZSBuZXh0IGBGb3JtQXJyYXlgIGNsb25lcyBpbiBkZWVwIHVudGlsIHRoZSBuZXh0IGBGb3JtQXJyYXlgLCBhbmQgc28gb24uICovXG4gICAgICAgICAgICBpZiAoY29udGVudC5mb3JtU2VjdGlvbiBpbnN0YW5jZW9mIEZvcm1BcnJheSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKiBUaGlzIGBjb250ZW50LmZvcm1TZWN0aW9uQ29udGVudGAgd2lsbCBub3QgYmUgY2xvbmVkIGJlY2F1c2UgaXQgYmVsb25ncyB0byBhIGBGb3JtQXJyYXlgIGFuZCBpdCB3aWxsIGJlIGNsb25lZCB3aGVuIHRoZSBgRm9ybUFycmF5YCBpcyBhbmFseXplZCBpbiB0aGUgYENvbnRhaW5lckNvbnRyb2xgIGNsYXNzLiAqL1xuICAgICAgICAgICAgICAgIHJlZkNvbnRlbnQgPSB0aGlzLl9jbG9uZUNvbnRlbnQoY29udGVudCwgdW5kZWZpbmVkLyogSXQgaXMgbm90IHVzZWQgaW4gdGhpcyBjYXNlLiAqLywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHJlZkNvbnRlbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZWZDb250ZW50ID0gdGhpcy5fY2xvbmVDb250ZW50KGNvbnRlbnQsIHZhbHVlLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogU2V0cyB0aGUgcGFyZW50IGNvbnRyb2wgdG8gaXRzIGNoaWxkLiAqL1xuICAgICAgICAgICAgdGhpcy5zZXRQYXJlbnRUb0NoaWxkKHJlZkNvbnRlbnQpO1xuXG4gICAgICAgICAgICAvKiBPdmVyd3JpdGVzIHNvbWUgcHJvcGVydGllcyBmb3IgdGhlIGNvbnRlbnQgY2xvbmVkLiAqL1xuICAgICAgICAgICAgcmVmQ29udGVudC5uYW1lID0gdGhpcy5fZm9ybUFycmF5TGVuZ3RoLnRvU3RyaW5nKDEwKTsgIC8qIFRoZSBlbGVtZW50IGlzIGFkZGVkIGluIHRoZSBgRm9ybUFycmF5YCBhZnRlciB0aGUgbGFzdCBwb3NpdGlvbi4gKi9cbiAgICAgICAgICAgIC8qIE92ZXJ3cml0ZXMgc29tZSBwcm9wZXJ0aWVzIGZvciB0aGUgY29udGVudCBjbG9uZWQgaWYgaXQgY29udGFpbnMgdGhlIGBjb250ZW50LmZvcm1Db250cm9sYCBvciBgY29udGVudC5mb3JtU2VjdGlvbmAgZmllbGQuICovXG4gICAgICAgICAgICBpZiAoKGNvbnRlbnQuZm9ybUNvbnRyb2wpIHx8IChjb250ZW50LmZvcm1TZWN0aW9uKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyByZWZDb250ZW50LmxhYmVsID0gKChyZWZDb250ZW50LmxhYmVsID09IHVuZGVmaW5lZCkgPyAocmVmQ29udGVudC5uYW1lKSA6IChyZWZDb250ZW50LmxhYmVsICsgcmVmQ29udGVudC5uYW1lKSk7XG4gICAgICAgICAgICAgICAgLy8gcmVmQ29udGVudC5hcmlhTGFiZWwgPSByZWZDb250ZW50LmxhYmVsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBTYXZlIHRoZSBjb250ZW50IGNsb25lZC4gKi9cbiAgICAgICAgICAgIHRoaXMuY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnQucHVzaChyZWZDb250ZW50KTtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJlZkNvbnRlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fZm9ybUFycmF5TGVuZ3RoKys7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBjb250ZW50IHRoYXQgcmVwcmVzZW50cyB0aGUgY2xvbmUgb2YgdGhlIHNwZWNpZmllZCBjb250ZW50IHRhcmdldC4gXG4gICAgICogSXQgYWxzbyBzZXRzIHRoZSBpbml0aWFsIGB2YWx1ZWAgZmllbGQgb2YgZWFjaCBjb250ZW50IHJlcHJlc2VudGluZyBhIGBGb3JtQ29udHJvbGAuIFxuICAgICAqIEl0IGNsb25lcyB0aGUgY29udGVudCBzbWFydGx5IGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZiBwcm9wZXJ0eS4gXG4gICAgICogSXQgY2xvbmVzIGluIGRlZXAgdW50aWwgdGhlIG5leHQgYEZvcm1BcnJheWAsIHRoZW4gdGhlIG5leHQgYEZvcm1BcnJheWAgY2xvbmVzIGluIGRlZXAgdW50aWwgdGhlIG5leHQgYEZvcm1BcnJheWAsIGFuZCBzbyBvbi4gXG4gICAgICogQHBhcmFtIHRhcmdldCBUaGUgY29udGVudCBvYmplY3QgdG8gY2xvbmUuIFxuICAgICAqIEBwYXJhbSB2YWx1ZSBUaGUgaW5pdGlhbCBgdmFsdWVgIGZpZWxkIG9mIGVhY2ggY29udGVudCByZXByZXNlbnRpbmcgYSBgRm9ybUNvbnRyb2xgLiBcbiAgICAgKiBAcGFyYW0gY2FuQ2xvbmUgSXQgaXMgdHJ1ZSBpZiB0aGUgZnVuY3Rpb24gY2FuIGNsb25lIHRoZSBgZm9ybVNlY3Rpb25Db250ZW50YCBmaWVsZDsgb3RoZXJ3aXNlLCBmYWxzZS4gXG4gICAgICovXG4gICAgcHJpdmF0ZSBfY2xvbmVDb250ZW50KHRhcmdldDogUGFyYW1zPGFueT4sIHZhbHVlOiBhbnksIGNhbkNsb25lOiBib29sZWFuKTogYW55XG4gICAge1xuICAgICAgICAvKiBUaGUgY29udGVudCBjbG9uZWQuICovXG4gICAgICAgIGxldCByZXN1bHQ6IGFueSA9IHsgfTtcblxuICAgICAgICBmb3IobGV0IHByb3AgaW4gdGFyZ2V0KVxuICAgICAgICB7XG4gICAgICAgICAgICBzd2l0Y2gocHJvcClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKiBUaGUgYGZvcm1Db250cm9sYCBwcm9wZXJ0eSBzcGVjaWFsIGNhc2UuICovXG4gICAgICAgICAgICAgICAgY2FzZSAnZm9ybUNvbnRyb2wnOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Byb3BdID0gY2xvbmVGb3JtQ29udHJvbCh0YXJnZXQuZm9ybUNvbnRyb2wpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qIElmIHRoaXMgY29udGVudCAoYHJlc3VsdGApIHJlcHJlc2VudHMgYSBgRm9ybUNvbnRyb2xgLCB0aGVuIHRoZSBgdmFsdWVgIGZpZWxkIGlzIGluaXRpYWxpemVkLiAqL1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ3ZhbHVlJ10gPSB2YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBUaGUgYGZvcm1TZWN0aW9uYCBwcm9wZXJ0eSBzcGVjaWFsIGNhc2UuICovXG4gICAgICAgICAgICAgICAgY2FzZSAnZm9ybVNlY3Rpb24nOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Byb3BdID0gY2xvbmVGb3JtU2VjdGlvbih0YXJnZXQuZm9ybVNlY3Rpb24pO1xuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIFRoZSBgZm9ybVNlY3Rpb25Db250ZW50YCBwcm9wZXJ0eSBzcGVjaWFsIGNhc2UuICovXG4gICAgICAgICAgICAgICAgY2FzZSAnZm9ybVNlY3Rpb25Db250ZW50JzpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYW5DbG9uZSkgIC8qIENsb25lcyB0aGUgYHRhcmdldC5mb3JtU2VjdGlvbkNvbnRlbnRgLiAqL1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0gPSBbIF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgY29udGVudCBvZiB0YXJnZXQuZm9ybVNlY3Rpb25Db250ZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50LmZvcm1TZWN0aW9uIGluc3RhbmNlb2YgRm9ybUFycmF5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC52YWx1ZSA9IHZhbHVlW2NvbnRlbnQubmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIFRoaXMgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YCB3aWxsIG5vdCBiZSBjbG9uZWQgYmVjYXVzZSBpdCBiZWxvbmdzIHRvIGEgYEZvcm1BcnJheWAgYW5kIGl0IHdpbGwgYmUgY2xvbmVkIHdoZW4gdGhlIGBGb3JtQXJyYXlgIGlzIGFuYWx5emVkIGluIHRoZSBgQ29udGFpbmVyQ29udHJvbGAgY2xhc3MuICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtwcm9wXS5wdXNoKHRoaXMuX2Nsb25lQ29udGVudChjb250ZW50LCB1bmRlZmluZWQvKiBJdCBpcyBub3QgdXNlZCBpbiB0aGlzIGNhc2UuICovLCBmYWxzZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0ucHVzaCh0aGlzLl9jbG9uZUNvbnRlbnQoY29udGVudCwgdmFsdWVbY29udGVudC5uYW1lXSwgY2FuQ2xvbmUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSAgLyogVGFrZXMgdGhlIHNhbWUgYHRhcmdldC5mb3JtU2VjdGlvbkNvbnRlbnRgIHJlZmVyZW5jZSBiZWNhdXNlIGB0YXJnZXRgIGlzIGEgYEZvcm1BcnJheWAgYW5kIGl0cyBgZm9ybVNlY3Rpb25Db250ZW50YCB3aWxsIGJlIHRha2VuIGxpa2UgYSBwYXR0ZXJuLiAqL1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0gPSB0YXJnZXQuZm9ybVNlY3Rpb25Db250ZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyogQ29waWVzIHRoZSBwcm9wZXJ0eSB3aXRob3V0IHByb2JsZW0uICovXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtwcm9wXSA9IHRhcmdldFtwcm9wXTtcblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgdGhlIGNoaWxkIGNvbXBvbmVudHMuIFxuICAgICAqIEBwYXJhbSBjb21wb25lbnRzQ29udGVudCBDb21wb25lbnRzIGNvbnRlbnQgYXJyYXkgZm9yIGNyZWF0aW5nIHRoZSBjb21wb25lbnRzLiBcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY3JlYXRlQ2hpbGRDb21wb25lbnRzKGNvbXBvbmVudHNDb250ZW50OiBQYXJhbXM8YW55PltdKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgY29tcG9uZW50Q29udGVudCBvZiBjb21wb25lbnRzQ29udGVudClcbiAgICAgICAge1xuICAgICAgICAgICAgLyogQ3JlYXRlcyBhIGNoaWxkIGNvbXBvbmVudC4gKi9cbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQ2hpbGRDb21wb25lbnQoY29tcG9uZW50Q29udGVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2hpbGQgY29tcG9uZW50LiBcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50Q29udGVudCBDb21wb25lbnQgY29udGVudCBmb3IgY3JlYXRpbmcgdGhlIGNvbXBvbmVudC4gXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUNoaWxkQ29tcG9uZW50KGNvbXBvbmVudENvbnRlbnQ6IFBhcmFtczxhbnk+KTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fY3IgPSB0aGlzLl92aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChcbiAgICAgICAgICAgIHRoaXMuX2NvbXBvbmVudEZhY3RvcnlSZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShjb21wb25lbnRDb250ZW50LmNvbnRyb2xUeXBlKVxuICAgICAgICApO1xuICAgICAgICAodGhpcy5fY3IuaW5zdGFuY2UgYXMgRm9ybUZpZWxkQ29udHJvbCkuY29udGVudCA9IGNvbXBvbmVudENvbnRlbnQ7XG4gICAgfVxuXG5cdC8qKlxuXHQgKiBJbml0aWFsaXplcyB0aGUgY29udHJvbCdzIHZhbHVlLiBJdCB1c2VzIHRoZSBgY29udGVudC52YWx1ZWAgYW5kIGl0IGlzIGFscmVhZHkgZGlmZmVyZW50IG9mIGB1bmRlZmluZWRgLiBcbiAgICAgKiBJdCBhbHNvIGNoZWNrcyBpZiB0aGUgc3BlY2lmaWVkIGBjb250ZW50LnZhbHVlYCBpcyBjb3JyZWN0LiBGb3IgaW50ZXJuYWwgdXNlIG9ubHkuIFxuXHQgKi9cblx0cHJvdGVjdGVkIGluaXRWYWx1ZSgpOiB2b2lkXG5cdHtcbiAgICAgICAgLyogSXQgZG9lcyBub3QgbmVlZCB0byBkbyBzb21ldGhpbmcgYmVjYXVzZSB0aGUgY2hpbGQgY29udHJvbHMgYXJlIGFscmVhZHkgaW5pdGlhbGl6ZWQuICovXG5cbiAgICAgICAgLy8gLyogSW4gdGhpcyB3YXksIGNoZWNrcyBpZiB0aGUgc3BlY2lmaWVkIGBjb250ZW50LnZhbHVlYCBpcyBjb3JyZWN0LiAqL1xuICAgICAgICAvLyB0aGlzLmNvbnRlbnQuZm9ybUNvbnRyb2wuc2V0VmFsdWUodGhpcy5jb250ZW50LnZhbHVlKTtcblxuICAgICAgICAvLyAvKiBNYXJrcyB0aGUgY29udHJvbCBhcyBgdG91Y2hlZGAuICovXG4gICAgICAgIC8vIHRoaXMuY29udGVudC5mb3JtQ29udHJvbC5tYXJrQXNUb3VjaGVkKHtcbiAgICAgICAgLy8gICAgIG9ubHlTZWxmOiB0cnVlXG4gICAgICAgIC8vIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhpcyBpbnN0YW5jZS4gXG4gICAgICovXG4gICAgcHVibGljIGdldCBnZXRJbnN0YW5jZSgpOiBDb250YWluZXJDb250cm9sXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGNvbnRyb2xzIHRoYXQgcmVwcmVzZW50cyB0aGUgYENvbnRhaW5lckNvbnRyb2xgJ3MgY2hpbGQgY29udHJvbHMuIFxuICAgICAqIEl0IGlzIGFsd2F5cyBzZXQgaW50ZXJuYWxseS4gXG4gICAgICovXG4gICAgcHVibGljIGdldCBjb250YWluZXJDb250cm9sQ2hpbGRyZW4oKTogYW55W11cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQuY29udGFpbmVyQ29udHJvbENoaWxkcmVuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgcmVwcmVzZW50cyBhIGBGb3JtQXJyYXlgLCB0aGVuIHRoaXMgZmllbGQgcmV0dXJucyBcbiAgICAgKiBhIHBhdHRlcm4gY29udGVudCB0aGF0IGlzIGBjb250ZW50LmZvcm1TZWN0aW9uQ29udGVudFswXWAgdmFsdWU7IG90aGVyd2lzZSwgcmV0dXJucyBgdW5kZWZpbmVkYC4gXG4gICAgICogSXQgaXMgc2hhcmVkIGFtb25nIGNvbnRyb2xzLiBcbiAgICAgKiBJdCBpcyB1c2VkIGZvciBhZGRpbmcgYSBuZXcgZWxlbWVudCBpbiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YCwgdGhhdCBpcywgXG4gICAgICogZm9yIGFkZGluZyBhIG5ldyBjb250cm9sIGluIHRoZSBgRm9ybUFycmF5YC4gXG4gICAgICogQnkgZGVmYXVsdCwgaXRzIHZhbHVlIGlzIGB1bmRlZmluZWRgLiBcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGZvcm1BcnJheVBhdHRlcm5Db250ZW50KCk6IGFueVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1BcnJheVBhdHRlcm5Db250ZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgcmVwcmVzZW50cyBhIGBGb3JtQXJyYXlgLCB0aGVuIHRoaXMgZmllbGQgcmV0dXJucyBcbiAgICAgKiBhIHBhdHRlcm4gdmFsdWUgdGhhdCBpcyBhIGNsb25lIG9mIHRoZSBgY29udGVudC52YWx1ZVswXWAgdmFsdWUsIGFuZCBzZXRzIGFsbCBcbiAgICAgKiBpdHMgcHJvcGVydGllcy92YWx1ZXMgb2YgYnVpbHQtaW4gdHlwZSB0byBgdW5kZWZpbmVkYDsgb3RoZXJ3aXNlLCByZXR1cm5zIGB1bmRlZmluZWRgLiBcbiAgICAgKiBJdCBpcyB1c2VkIGZvciBhZGRpbmcgYSBuZXcgZWxlbWVudCBpbiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YC4gXG4gICAgICogQnkgZGVmYXVsdCwgaXRzIHZhbHVlIGlzIGB1bmRlZmluZWRgLiBcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGZvcm1BcnJheVBhdHRlcm5WYWx1ZSgpOiBhbnlcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb3JtQXJyYXlQYXR0ZXJuVmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBjb250YWluZXIgY29udHJvbCBoYXMgYSBkeW5hbWljIGxlbmd0aCwgdGhhdCBpcywgdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBmaWVsZCBcbiAgICAgKiByZXByZXNlbnRzIGEgYEZvcm1BcnJheWAgYW5kIGl0cyBsZW5ndGggaXMgbm90IGZpeGVkOyBvdGhlcndpc2UsIGZhbHNlLiBcbiAgICAgKiBUaGlzIHByb3BlcnR5IGhhcyBzZW5zZSBvbmx5IHdoZW4gdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBmaWVsZCByZXByZXNlbnRzIGEgYEZvcm1BcnJheWAuIFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgaXNEeW5hbWljKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQuaXNEeW5hbWljO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY29udGFpbmVyIGNvbnRyb2wgaXMgYSBgRm9ybUFycmF5YCwgdGhhdCBpcywgdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBmaWVsZCBcbiAgICAgKiByZXByZXNlbnRzIGEgYEZvcm1BcnJheWA7IG90aGVyd2lzZSwgZmFsc2UuIFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgaXNGb3JtQXJyYXkoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRm9ybUFycmF5O1xuICAgIH1cblxuXHQvKipcblx0ICogUmV0dXJucyB0cnVlIGlmIHRoaXMgY29udGFpbmVyIGlzIGVtcHR5OyBvdGhlcndpc2UsIGZhbHNlLiBcblx0ICovXG5cdHB1YmxpYyBnZXQgaXNFbXB0eSgpOiBib29sZWFuXG5cdHtcblx0XHRyZXR1cm4gKHRoaXMuY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnQubGVuZ3RoID09IDApO1xuICAgIH1cblxuXHQvKipcblx0ICogUmV0dXJucyB0cnVlIGlmIGFuIGVsZW1lbnQgY2FuIGJlIHJlbW92ZWQgZnJvbSB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gOyBvdGhlcndpc2UsIGZhbHNlLiBcbiAgICAgKiBVc2UgYWxvbmcgd2l0aCBgcmVtb3ZlRnJvbUZvcm1BcnJheWAgYW5kIGBjbGVhckZvcm1BcnJheWAgbWV0aG9kcy4gXG4gICAgICogVGhlIGBjb250ZW50LmZvcm1TZWN0aW9uYCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIGBGb3JtQXJyYXlgLiBcblx0ICovXG5cdHB1YmxpYyBnZXQgY2FuUmVtb3ZlRnJvbUZvcm1BcnJheSgpOiBib29sZWFuXG5cdHtcbiAgICAgICAgLyogVGhlIG1ldGhvZCB1c2VzIHRoZSBgX2Zvcm1BcnJheUxlbmd0aGAgaW5zdGVhZCBvZiBgY29udGVudC5mb3JtU2VjdGlvbmAgYmVjYXVzZSBcbiAgICAgICAgdGhlIGZpcnN0IG9uZSBmaWVsZCBpcyB1cGRhdGVkIGZpcnN0IGFuZCBpdCBoYXMgdGhlIGFuc3dlciBtb3JlIGFjY3VyYXRlIHRoYW4gdGhlIHNlY29uZCBvbmUgZmllbGQuICovXG5cbiAgICAgICAgaWYgKHRoaXMuY29udGVudC5yZXF1aXJlZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9mb3JtQXJyYXlMZW5ndGggPiAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fZm9ybUFycmF5TGVuZ3RoICE9IDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBlbXB0eSBlbGVtZW50IGF0IHRoZSBlbmQgb2YgdGhlIGBjb250ZW50LmZvcm1TZWN0aW9uQ29udGVudGA7IHRoZXJlZm9yZSBvbmUgZWxlbWVudCBcbiAgICAgKiBpcyBhZGRlZCBhdCB0aGUgZW5kIG9mIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgYEZvcm1BcnJheWAuIFxuICAgICAqIFRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBgRm9ybUFycmF5YC4gXG4gICAgICovXG5cdHB1YmxpYyBhZGRUb0Zvcm1BcnJheSgpOiB2b2lkXG5cdHtcbiAgICAgICAgY29uc29sZS5sb2coJ2FkZFRvRm9ybUFycmF5Jyk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzRm9ybUFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNoaWxkQ29tcG9uZW50cyhcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0RWxlbUZvcm1TZWN0aW9uQ29udGVudFRvRm9ybUFycmF5KHRoaXMuX2Zvcm1BcnJheVBhdHRlcm5WYWx1ZSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvciB0aGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wsIHRoZSAnY29udGVudC5mb3JtU2VjdGlvbicgdmFsdWUgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiAnRm9ybUFycmF5Jy5gKTtcbiAgICAgICAgfVxuXHR9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBlbGVtZW50IGF0IHRoZSBnaXZlbiBgaW5kZXhgIGluIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgOyB0aGVyZWZvcmUgXG4gICAgICogdGhlIGVsZW1lbnQgYXQgdGhlIGdpdmVuIGBpbmRleGAgaXMgcmVtb3ZlZCBpbiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIGBGb3JtQXJyYXlgLiBcbiAgICAgKiBUaGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25gIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgYEZvcm1BcnJheWAuIFxuICAgICAqIEBwYXJhbSBpbmRleCBJbmRleCBpbiB0aGUgYXJyYXkgdG8gcmVtb3ZlIHRoZSBlbGVtZW50LiBcbiAgICAgKi9cblx0cHVibGljIHJlbW92ZUZyb21Gb3JtQXJyYXkoaW5kZXg6IG51bWJlcik6IHZvaWRcblx0e1xuICAgICAgICBjb25zb2xlLmxvZygncmVtb3ZlRnJvbUZvcm1BcnJheScsIGluZGV4KTtcblxuICAgICAgICBpZiAodGhpcy5faXNGb3JtQXJyYXkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vVE9ETzogbGEgdmFyaWFibGUgYGZvcm1BcnJheVBhdHRlcm5Db250ZW50TGVuZ3RoYCBwb2Ryw61hIHNlciB1biBjYW1wbyBkZSBsYSBjbGFzZS4gXG4gICAgICAgICAgICBsZXQgZm9ybUFycmF5UGF0dGVybkNvbnRlbnRMZW5ndGg6IG51bWJlciA9IHRoaXMuX2Zvcm1BcnJheVBhdHRlcm5Db250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgIGxldCBpOiBudW1iZXIsIGo6IG51bWJlciwgazogbnVtYmVyO1xuXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuY29udGFpbmVyQ29udHJvbENoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50LnNwbGljZSgoaW5kZXggKiBmb3JtQXJyYXlQYXR0ZXJuQ29udGVudExlbmd0aCksIGZvcm1BcnJheVBhdHRlcm5Db250ZW50TGVuZ3RoKTtcbiAgICAgICAgICAgICh0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb24gYXMgRm9ybUFycmF5KS5yZW1vdmVBdChpbmRleCk7XG4gICAgICAgICAgICBmb3IgKGkgPSBmb3JtQXJyYXlQYXR0ZXJuQ29udGVudExlbmd0aCwgaiA9IGluZGV4ICogZm9ybUFycmF5UGF0dGVybkNvbnRlbnRMZW5ndGg7IGkgIT0gMDsgaS0tKVxuICAgICAgICAgICAgeyB0aGlzLl92aWV3Q29udGFpbmVyUmVmLnJlbW92ZShqKTsgfVxuICAgICAgICAgICAgdGhpcy5fZm9ybUFycmF5TGVuZ3RoLS07XG5cbiAgICAgICAgICAgIC8qIFVwZGF0ZXMgdGhlIGVsZW1lbnRzJyBpbmRleCBpbiB0aGUgYGNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50YCBhcnJheSBmcm9tIFxuICAgICAgICAgICAgdGhlIHNwZWNpZmllZCBgaW5kZXhgIG9ud2FyZHMuICovXG4gICAgICAgICAgICBmb3IgKGsgPSAoaSA9IGluZGV4ICogZm9ybUFycmF5UGF0dGVybkNvbnRlbnRMZW5ndGgpICsgZm9ybUFycmF5UGF0dGVybkNvbnRlbnRMZW5ndGgsIGogPSB0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50Lmxlbmd0aDsgaSA8IGo7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA9PSBrKSB7IGluZGV4Kys7IGsgKz0gZm9ybUFycmF5UGF0dGVybkNvbnRlbnRMZW5ndGg7IH1cbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb25Db250ZW50W2ldLm5hbWUgPSBpbmRleC50b1N0cmluZygxMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvciB0aGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wsIHRoZSAnY29udGVudC5mb3JtU2VjdGlvbicgdmFsdWUgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiAnRm9ybUFycmF5Jy5gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYWxsIGVsZW1lbnRzIGluIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbkNvbnRlbnRgOyB0aGVyZWZvcmUgXG4gICAgICogYWxsIGVsZW1lbnRzIGFyZSByZW1vdmVkIGluIHRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgYEZvcm1BcnJheWAuIFxuICAgICAqIFRoZSBgY29udGVudC5mb3JtU2VjdGlvbmAgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBgRm9ybUFycmF5YC4gXG4gICAgICovXG5cdHB1YmxpYyBjbGVhckZvcm1BcnJheSgpOiB2b2lkXG5cdHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NsZWFyRm9ybUFycmF5Jyk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzRm9ybUFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuY29udGFpbmVyQ29udHJvbENoaWxkcmVuID0gWyBdO1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LmZvcm1TZWN0aW9uQ29udGVudCA9IFsgXTtcbiAgICAgICAgICAgICh0aGlzLmNvbnRlbnQuZm9ybVNlY3Rpb24gYXMgRm9ybUFycmF5KS5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fdmlld0NvbnRhaW5lclJlZi5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fZm9ybUFycmF5TGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY29udGVudC5yZXF1aXJlZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKiBUaGUgYEZvcm1BcnJheWAgYWx3YXlzIGhhcyBvbmUgZWxlbWVudCBhdCBsZWFzdC4gKi9cbiAgICAgICAgICAgICAgICB0aGlzLmFkZFRvRm9ybUFycmF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvciB0aGUgJyR7IHRoaXMuY29udGVudC5uYW1lIH0nIGNvbnRyb2wsIHRoZSAnY29udGVudC5mb3JtU2VjdGlvbicgdmFsdWUgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiAnRm9ybUFycmF5Jy5gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==