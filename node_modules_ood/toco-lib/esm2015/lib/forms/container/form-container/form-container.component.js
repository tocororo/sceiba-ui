/**
 * @fileoverview added by tsickle
 * Generated from: lib/forms/container/form-container/form-container.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from "@angular/core";
import { ContainerControl } from "../container.control";
/**
 * This interface is deprecated.
 * @record
 */
export function FormContainerAction() { }
if (false) {
    /**
     * @param {?} data
     * @return {?}
     */
    FormContainerAction.prototype.doit = function (data) { };
}
/**
 * This interface is deprecated.
 * An interface that represents the content of an expansion control.
 * @record
 */
export function PanelContent_Depr() { }
if (false) {
    /**
     * Returns the panel's title.
     * @type {?}
     */
    PanelContent_Depr.prototype.title;
    /**
     * Returns the panel's description.
     * @type {?}
     */
    PanelContent_Depr.prototype.description;
    /**
     * Returns the panel's icon name.
     * @type {?}
     */
    PanelContent_Depr.prototype.iconName;
    /**
     * Returns the action and action labels for each panel.
     * @type {?|undefined}
     */
    PanelContent_Depr.prototype.action;
    /** @type {?|undefined} */
    PanelContent_Depr.prototype.actionLabel;
    /**
     * Returns true is the panel is open; otherwise, false.
     * @type {?|undefined}
     */
    PanelContent_Depr.prototype.open;
}
/**
 * This component is deprecated.
 * Represents a control that contains a list of panels and sends that information to the server.
 */
export class FormContainerComponent extends ContainerControl {
    constructor() {
        super();
        this.useAccordion = true;
        this.useContainer = true;
        this.actionButtonIsStepperNext = false;
        this.deleteValuesAfterAction = true;
        /* By default, the first panel is expanded. */
        this.step = 0;
    }
    /**
     * @private
     * @return {?}
     */
    setFormGroupToPanels() {
        this.panelsContent.forEach((/**
         * @param {?} panel
         * @return {?}
         */
        (panel) => {
            panel.formSection = panel.formSection;
        }));
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        console.log("on INIT call", this.panelsContent);
        /* Sets the default values. */
        if (this.panelsContent.length > 0) {
            this.content = {
                formSection: this.panelsContent[0].formSection,
                name: "FormContainerComponent",
                label: "FormContainerComponent_Label",
                type: undefined,
                value: "FormContainerComponent",
                //            'width': '100%',
                ariaLabel: "FormContainerComponent",
                formSectionContent: this.panelsContent[0].formSectionContent,
            };
        }
        this.init(undefined);
        // if actionLabel is undefined, means that there is no actionLabel, the user must decide!!!
        // if (this.actionLabel == undefined) this.actionLabel = 'Adicionar';
        this.setFormGroupToPanels();
    }
    /**
     * @return {?}
     */
    ngOnChanges() {
        console.log("on CHANGES call", this.panelsContent);
        this.ngOnInit();
        // this.init(this.content.label, false, false);
        // this.setFormGroupToPanels();
    }
    /**
     * Sets the new expanded panel position.
     * @param {?} newStep The new position.
     * @return {?}
     */
    setStep(newStep) {
        this.step = newStep;
    }
    /**
     * Sets the expanded panel position to the next position.
     * @return {?}
     */
    nextStep() {
        this.step++;
    }
    /**
     * Sets the expanded panel position to the previous position.
     * @return {?}
     */
    prevStep() {
        this.step--;
    }
    /**
     * Sends data to the server. Collects all added information from the component.
     * Creates a JSON object based on `form.name` and `form.value` fields.
     * @return {?}
     */
    doAction() {
        //TODO: poner este method in `ContainerControl`.
        //TODO: poner este method in `ContainerControl`.
        /* Prepares all data. */
        /** @type {?} */
        const data = {};
        this.panelsContent.forEach((/**
         * @param {?} panel
         * @return {?}
         */
        (panel) => {
            panel.formSectionContent.forEach((/**
             * @param {?} controlContent
             * @return {?}
             */
            (controlContent) => {
                data[controlContent.name] = controlContent.value;
            }));
        }));
        if (this.action) {
            this.action.doit(data);
        }
        if (this.deleteValuesAfterAction) {
            this.panelsContent.forEach((/**
             * @param {?} panel
             * @return {?}
             */
            (panel) => {
                panel.formSectionContent.forEach((/**
                 * @param {?} controlContent
                 * @return {?}
                 */
                (controlContent) => {
                    controlContent.value = undefined;
                }));
            }));
        }
    }
}
FormContainerComponent.decorators = [
    { type: Component, args: [{
                selector: "toco-form-container",
                template: "\n<ng-container *ngIf=\"(panelsContent)\">\n\n    <ng-container *ngIf=\"useContainer\">\n        <mat-accordion *ngIf=\"(useAccordion)\" class=\"toco-form-container\" multi=\"true\">\n\n            <mat-expansion-panel *ngFor=\"let panel of panelsContent; let newStep = index; let count=count\"\n                [expanded]=\"panel.open\" (opened)=\"setStep(newStep)\">\n        \n                <mat-expansion-panel-header>\n                    <mat-panel-title>\n                        {{ panel.title }}\n                    </mat-panel-title>\n                    <mat-panel-description>\n                        {{ panel.description }}\n                        <mat-icon>{{ panel.iconName }}</mat-icon>\n                    </mat-panel-description>\n                </mat-expansion-panel-header>\n        \n                <component-factory-depr [componentsContent]=\"panel.formSectionContent\"></component-factory-depr>\n        \n                <mat-action-row *ngIf=\"panel.actionLabel\">\n                    <!-- <button mat-button *ngIf=\"newStep > 0\" color=\"warn\" (click)=\"prevStep()\">Anterior</button>\n                    <button mat-button *ngIf=\"newStep != count-1\" color=\"primary\" (click)=\"nextStep()\">Siguente</button> -->\n        \n                    <button *ngIf=\"panel.actionLabel\" mat-button color=\"accent\" (click)=\"panel.action.doit(newStep)\">{{ panel.actionLabel }}</button>\n                    <!-- <button *ngIf=\"i == l-1 && actionButtonIsStepperNext\" mat-button matStepperNext color=\"primary\" (click)=\"doAction()\">{{actionLabel}}</button> -->\n                </mat-action-row>\n\n            </mat-expansion-panel>\n\n            <button *ngIf=\"actionLabel\" mat-raised-button color=\"primary\" (click)=\"doAction()\">{{actionLabel}}</button>\n        </mat-accordion>\n        \n        <div *ngIf=\"(!useAccordion)\" class=\"toco-form-container\">\n            <div *ngFor=\"let panel of panelsContent; let i=index; let count=count\">\n                <mat-card [ngStyle]=\"{'margin-bottom': '1em'}\">\n                    <mat-card-header>\n                        <mat-card-title>\n                            {{ panel.title }}\n                        </mat-card-title>\n                        <mat-card-subtitle *ngIf=\"panel.description\">\n                            {{ panel.description }}\n                            <mat-icon>{{ panel.iconName }}</mat-icon>\n                        </mat-card-subtitle>\n                    </mat-card-header>\n            \n                    <mat-card-content>\n                        <component-factory-depr [componentsContent]=\"panel.formSectionContent\"></component-factory-depr>\n                    </mat-card-content>\n            \n                    <mat-card-actions *ngIf=\"i == count-1 && actionLabel\" fxLayout=\"row\" fxLayoutAlign=\"end center\">\n                        <button mat-button color=\"primary\" (click)=\"doAction()\">{{ actionLabel }}</button>\n                    </mat-card-actions>\n                </mat-card>\n            </div>\n        </div>\n    </ng-container>\n\n    <div fxLayout=\"column\" *ngIf=\"!useContainer\">\n        <div *ngFor=\"let panel of panelsContent; let i=index; let count=count\" class=\"toco-form-container\">\n            <component-factory-depr [componentsContent]=\"panel.formSectionContent\"></component-factory-depr>\n        </div>\n        <div  *ngIf=\"actionLabel\" fxLayout=\"row\" fxLayoutAlign=\"end center\">\n            <button mat-button color=\"primary\" (click)=\"doAction()\">{{ actionLabel }}</button>\n        </div>\n    </div>\n\n</ng-container>\n",
                styles: [".toco-form-container{width:100%;margin-bottom:1em}"]
            }] }
];
/** @nocollapse */
FormContainerComponent.ctorParameters = () => [];
FormContainerComponent.propDecorators = {
    panelsContent: [{ type: Input }],
    useAccordion: [{ type: Input }],
    useContainer: [{ type: Input }],
    actionButtonIsStepperNext: [{ type: Input }],
    action: [{ type: Input }],
    actionLabel: [{ type: Input }],
    deleteValuesAfterAction: [{ type: Input }]
};
if (false) {
    /**
     * Input field that contains the content of this class. The array of panels to show.
     * @type {?}
     */
    FormContainerComponent.prototype.panelsContent;
    /** @type {?} */
    FormContainerComponent.prototype.useAccordion;
    /** @type {?} */
    FormContainerComponent.prototype.useContainer;
    /** @type {?} */
    FormContainerComponent.prototype.actionButtonIsStepperNext;
    /** @type {?} */
    FormContainerComponent.prototype.action;
    /**
     * An string that represents the action label of the last panel.
     * @type {?}
     */
    FormContainerComponent.prototype.actionLabel;
    /** @type {?} */
    FormContainerComponent.prototype.deleteValuesAfterAction;
    /**
     * The current expanded panel position.
     * @type {?}
     */
    FormContainerComponent.prototype.step;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1jb250YWluZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vdG9jby1saWIvIiwic291cmNlcyI6WyJsaWIvZm9ybXMvY29udGFpbmVyL2Zvcm0tY29udGFpbmVyL2Zvcm0tY29udGFpbmVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFhLE1BQU0sZUFBZSxDQUFDO0FBRXBFLE9BQU8sRUFBb0IsZ0JBQWdCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQzs7Ozs7QUFLMUUseUNBRUM7Ozs7OztJQURDLHlEQUFzQjs7Ozs7OztBQU94Qix1Q0EwQkM7Ozs7OztJQXRCQyxrQ0FBYzs7Ozs7SUFLZCx3Q0FBb0I7Ozs7O0lBS3BCLHFDQUFpQjs7Ozs7SUFLakIsbUNBQTZCOztJQUM3Qix3Q0FBcUI7Ozs7O0lBS3JCLGlDQUFlOzs7Ozs7QUFZakIsTUFBTSxPQUFPLHNCQUF1QixTQUFRLGdCQUFnQjtJQWtDMUQ7UUFDRSxLQUFLLEVBQUUsQ0FBQztRQTFCSCxpQkFBWSxHQUFZLElBQUksQ0FBQztRQUc3QixpQkFBWSxHQUFZLElBQUksQ0FBQztRQUc3Qiw4QkFBeUIsR0FBWSxLQUFLLENBQUM7UUFZM0MsNEJBQXVCLEdBQVksSUFBSSxDQUFDO1FBVTdDLDhDQUE4QztRQUM5QyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztJQUNoQixDQUFDOzs7OztJQUVPLG9CQUFvQjtRQUMxQixJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU87Ozs7UUFBQyxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ25DLEtBQUssQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQztRQUN4QyxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7Ozs7SUFFTSxRQUFRO1FBQ2IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBRWhELDhCQUE4QjtRQUM5QixJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNqQyxJQUFJLENBQUMsT0FBTyxHQUFHO2dCQUNiLFdBQVcsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVc7Z0JBQzlDLElBQUksRUFBRSx3QkFBd0I7Z0JBQzlCLEtBQUssRUFBRSw4QkFBOEI7Z0JBQ3JDLElBQUksRUFBRSxTQUFTO2dCQUNmLEtBQUssRUFBRSx3QkFBd0I7O2dCQUUvQixTQUFTLEVBQUUsd0JBQXdCO2dCQUNuQyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLGtCQUFrQjthQUM3RCxDQUFDO1NBQ0g7UUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRXJCLDJGQUEyRjtRQUMzRixxRUFBcUU7UUFDckUsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7SUFDOUIsQ0FBQzs7OztJQUVNLFdBQVc7UUFDaEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDbkQsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBRWhCLCtDQUErQztRQUMvQywrQkFBK0I7SUFDakMsQ0FBQzs7Ozs7O0lBTU0sT0FBTyxDQUFDLE9BQWU7UUFDNUIsSUFBSSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7SUFDdEIsQ0FBQzs7Ozs7SUFLTSxRQUFRO1FBQ2IsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2QsQ0FBQzs7Ozs7SUFLTSxRQUFRO1FBQ2IsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2QsQ0FBQzs7Ozs7O0lBTU0sUUFBUTtRQUNiLGdEQUFnRDs7OztjQUkxQyxJQUFJLEdBQUcsRUFBRTtRQUVmLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTzs7OztRQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDbkMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLE9BQU87Ozs7WUFBQyxDQUFDLGNBQWMsRUFBRSxFQUFFO2dCQUNsRCxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxHQUFHLGNBQWMsQ0FBQyxLQUFLLENBQUM7WUFDbkQsQ0FBQyxFQUFDLENBQUM7UUFDTCxDQUFDLEVBQUMsQ0FBQztRQUVILElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNmLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3hCO1FBRUQsSUFBSSxJQUFJLENBQUMsdUJBQXVCLEVBQUU7WUFDaEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPOzs7O1lBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtnQkFDbkMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLE9BQU87Ozs7Z0JBQUMsQ0FBQyxjQUFjLEVBQUUsRUFBRTtvQkFDbEQsY0FBYyxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7Z0JBQ25DLENBQUMsRUFBQyxDQUFDO1lBQ0wsQ0FBQyxFQUFDLENBQUM7U0FDSjtJQUNILENBQUM7OztZQXRJRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLHFCQUFxQjtnQkFDL0Isc2tIQUE4Qzs7YUFFL0M7Ozs7OzRCQU1FLEtBQUs7MkJBR0wsS0FBSzsyQkFHTCxLQUFLO3dDQUdMLEtBQUs7cUJBR0wsS0FBSzswQkFNTCxLQUFLO3NDQUdMLEtBQUs7Ozs7Ozs7SUFyQk4sK0NBQzBDOztJQUUxQyw4Q0FDb0M7O0lBRXBDLDhDQUNvQzs7SUFFcEMsMkRBQ2tEOztJQUVsRCx3Q0FDbUM7Ozs7O0lBS25DLDZDQUMyQjs7SUFFM0IseURBQytDOzs7OztJQUsvQyxzQ0FBb0IiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT25DaGFuZ2VzIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcblxuaW1wb3J0IHsgQ29udGFpbmVyQ29udGVudCwgQ29udGFpbmVyQ29udHJvbCB9IGZyb20gXCIuLi9jb250YWluZXIuY29udHJvbFwiO1xuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIGlzIGRlcHJlY2F0ZWQuIFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1Db250YWluZXJBY3Rpb24ge1xuICBkb2l0KGRhdGE6IGFueSk6IHZvaWQ7XG59XG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgaXMgZGVwcmVjYXRlZC4gXG4gKiBBbiBpbnRlcmZhY2UgdGhhdCByZXByZXNlbnRzIHRoZSBjb250ZW50IG9mIGFuIGV4cGFuc2lvbiBjb250cm9sLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBhbmVsQ29udGVudF9EZXByIGV4dGVuZHMgQ29udGFpbmVyQ29udGVudCB7XG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBwYW5lbCdzIHRpdGxlLlxuICAgKi9cbiAgdGl0bGU6IHN0cmluZztcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcGFuZWwncyBkZXNjcmlwdGlvbi5cbiAgICovXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHBhbmVsJ3MgaWNvbiBuYW1lLlxuICAgKi9cbiAgaWNvbk5hbWU6IHN0cmluZztcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgYWN0aW9uIGFuZCBhY3Rpb24gbGFiZWxzIGZvciBlYWNoIHBhbmVsLlxuICAgKi9cbiAgYWN0aW9uPzogRm9ybUNvbnRhaW5lckFjdGlvbjtcbiAgYWN0aW9uTGFiZWw/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdHJ1ZSBpcyB0aGUgcGFuZWwgaXMgb3Blbjsgb3RoZXJ3aXNlLCBmYWxzZS5cbiAgICovXG4gIG9wZW4/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFRoaXMgY29tcG9uZW50IGlzIGRlcHJlY2F0ZWQuIFxuICogUmVwcmVzZW50cyBhIGNvbnRyb2wgdGhhdCBjb250YWlucyBhIGxpc3Qgb2YgcGFuZWxzIGFuZCBzZW5kcyB0aGF0IGluZm9ybWF0aW9uIHRvIHRoZSBzZXJ2ZXIuXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJ0b2NvLWZvcm0tY29udGFpbmVyXCIsXG4gIHRlbXBsYXRlVXJsOiBcIi4vZm9ybS1jb250YWluZXIuY29tcG9uZW50Lmh0bWxcIixcbiAgc3R5bGVVcmxzOiBbXCIuL2Zvcm0tY29udGFpbmVyLmNvbXBvbmVudC5zY3NzXCJdLFxufSlcbmV4cG9ydCBjbGFzcyBGb3JtQ29udGFpbmVyQ29tcG9uZW50IGV4dGVuZHMgQ29udGFpbmVyQ29udHJvbFxuICBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcbiAgLyoqXG4gICAqIElucHV0IGZpZWxkIHRoYXQgY29udGFpbnMgdGhlIGNvbnRlbnQgb2YgdGhpcyBjbGFzcy4gVGhlIGFycmF5IG9mIHBhbmVscyB0byBzaG93LlxuICAgKi9cbiAgQElucHV0KClcbiAgcHVibGljIHBhbmVsc0NvbnRlbnQ6IFBhbmVsQ29udGVudF9EZXByW107XG5cbiAgQElucHV0KClcbiAgcHVibGljIHVzZUFjY29yZGlvbjogYm9vbGVhbiA9IHRydWU7XG5cbiAgQElucHV0KClcbiAgcHVibGljIHVzZUNvbnRhaW5lcjogYm9vbGVhbiA9IHRydWU7XG5cbiAgQElucHV0KClcbiAgcHVibGljIGFjdGlvbkJ1dHRvbklzU3RlcHBlck5leHQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBASW5wdXQoKVxuICBwdWJsaWMgYWN0aW9uOiBGb3JtQ29udGFpbmVyQWN0aW9uO1xuXG4gIC8qKlxuICAgKiBBbiBzdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBhY3Rpb24gbGFiZWwgb2YgdGhlIGxhc3QgcGFuZWwuXG4gICAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgYWN0aW9uTGFiZWw6IHN0cmluZztcblxuICBASW5wdXQoKVxuICBwdWJsaWMgZGVsZXRlVmFsdWVzQWZ0ZXJBY3Rpb246IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudCBleHBhbmRlZCBwYW5lbCBwb3NpdGlvbi5cbiAgICovXG4gIHB1YmxpYyBzdGVwOiBudW1iZXI7XG5cbiAgcHVibGljIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvKiBCeSBkZWZhdWx0LCB0aGUgZmlyc3QgcGFuZWwgaXMgZXhwYW5kZWQuICovXG4gICAgdGhpcy5zdGVwID0gMDtcbiAgfVxuXG4gIHByaXZhdGUgc2V0Rm9ybUdyb3VwVG9QYW5lbHMoKTogdm9pZCB7XG4gICAgdGhpcy5wYW5lbHNDb250ZW50LmZvckVhY2goKHBhbmVsKSA9PiB7XG4gICAgICBwYW5lbC5mb3JtU2VjdGlvbiA9IHBhbmVsLmZvcm1TZWN0aW9uO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKFwib24gSU5JVCBjYWxsXCIsIHRoaXMucGFuZWxzQ29udGVudCk7XG5cbiAgICAvKiBTZXRzIHRoZSBkZWZhdWx0IHZhbHVlcy4gKi9cbiAgICBpZiAodGhpcy5wYW5lbHNDb250ZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuY29udGVudCA9IHtcbiAgICAgICAgZm9ybVNlY3Rpb246IHRoaXMucGFuZWxzQ29udGVudFswXS5mb3JtU2VjdGlvbixcbiAgICAgICAgbmFtZTogXCJGb3JtQ29udGFpbmVyQ29tcG9uZW50XCIsXG4gICAgICAgIGxhYmVsOiBcIkZvcm1Db250YWluZXJDb21wb25lbnRfTGFiZWxcIixcbiAgICAgICAgdHlwZTogdW5kZWZpbmVkLFxuICAgICAgICB2YWx1ZTogXCJGb3JtQ29udGFpbmVyQ29tcG9uZW50XCIsXG4gICAgICAgIC8vICAgICAgICAgICAgJ3dpZHRoJzogJzEwMCUnLFxuICAgICAgICBhcmlhTGFiZWw6IFwiRm9ybUNvbnRhaW5lckNvbXBvbmVudFwiLFxuICAgICAgICBmb3JtU2VjdGlvbkNvbnRlbnQ6IHRoaXMucGFuZWxzQ29udGVudFswXS5mb3JtU2VjdGlvbkNvbnRlbnQsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRoaXMuaW5pdCh1bmRlZmluZWQpO1xuXG4gICAgLy8gaWYgYWN0aW9uTGFiZWwgaXMgdW5kZWZpbmVkLCBtZWFucyB0aGF0IHRoZXJlIGlzIG5vIGFjdGlvbkxhYmVsLCB0aGUgdXNlciBtdXN0IGRlY2lkZSEhIVxuICAgIC8vIGlmICh0aGlzLmFjdGlvbkxhYmVsID09IHVuZGVmaW5lZCkgdGhpcy5hY3Rpb25MYWJlbCA9ICdBZGljaW9uYXInO1xuICAgIHRoaXMuc2V0Rm9ybUdyb3VwVG9QYW5lbHMoKTtcbiAgfVxuXG4gIHB1YmxpYyBuZ09uQ2hhbmdlcygpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZyhcIm9uIENIQU5HRVMgY2FsbFwiLCB0aGlzLnBhbmVsc0NvbnRlbnQpO1xuICAgIHRoaXMubmdPbkluaXQoKTtcblxuICAgIC8vIHRoaXMuaW5pdCh0aGlzLmNvbnRlbnQubGFiZWwsIGZhbHNlLCBmYWxzZSk7XG4gICAgLy8gdGhpcy5zZXRGb3JtR3JvdXBUb1BhbmVscygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIG5ldyBleHBhbmRlZCBwYW5lbCBwb3NpdGlvbi5cbiAgICogQHBhcmFtIG5ld1N0ZXAgVGhlIG5ldyBwb3NpdGlvbi5cbiAgICovXG4gIHB1YmxpYyBzZXRTdGVwKG5ld1N0ZXA6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuc3RlcCA9IG5ld1N0ZXA7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgZXhwYW5kZWQgcGFuZWwgcG9zaXRpb24gdG8gdGhlIG5leHQgcG9zaXRpb24uXG4gICAqL1xuICBwdWJsaWMgbmV4dFN0ZXAoKTogdm9pZCB7XG4gICAgdGhpcy5zdGVwKys7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgZXhwYW5kZWQgcGFuZWwgcG9zaXRpb24gdG8gdGhlIHByZXZpb3VzIHBvc2l0aW9uLlxuICAgKi9cbiAgcHVibGljIHByZXZTdGVwKCk6IHZvaWQge1xuICAgIHRoaXMuc3RlcC0tO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRzIGRhdGEgdG8gdGhlIHNlcnZlci4gQ29sbGVjdHMgYWxsIGFkZGVkIGluZm9ybWF0aW9uIGZyb20gdGhlIGNvbXBvbmVudC5cbiAgICogQ3JlYXRlcyBhIEpTT04gb2JqZWN0IGJhc2VkIG9uIGBmb3JtLm5hbWVgIGFuZCBgZm9ybS52YWx1ZWAgZmllbGRzLlxuICAgKi9cbiAgcHVibGljIGRvQWN0aW9uKCk6IHZvaWQge1xuICAgIC8vVE9ETzogcG9uZXIgZXN0ZSBtZXRob2QgaW4gYENvbnRhaW5lckNvbnRyb2xgLlxuXG4gICAgLyogUHJlcGFyZXMgYWxsIGRhdGEuICovXG5cbiAgICBjb25zdCBkYXRhID0ge307XG5cbiAgICB0aGlzLnBhbmVsc0NvbnRlbnQuZm9yRWFjaCgocGFuZWwpID0+IHtcbiAgICAgIHBhbmVsLmZvcm1TZWN0aW9uQ29udGVudC5mb3JFYWNoKChjb250cm9sQ29udGVudCkgPT4ge1xuICAgICAgICBkYXRhW2NvbnRyb2xDb250ZW50Lm5hbWVdID0gY29udHJvbENvbnRlbnQudmFsdWU7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLmFjdGlvbikge1xuICAgICAgdGhpcy5hY3Rpb24uZG9pdChkYXRhKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kZWxldGVWYWx1ZXNBZnRlckFjdGlvbikge1xuICAgICAgdGhpcy5wYW5lbHNDb250ZW50LmZvckVhY2goKHBhbmVsKSA9PiB7XG4gICAgICAgIHBhbmVsLmZvcm1TZWN0aW9uQ29udGVudC5mb3JFYWNoKChjb250cm9sQ29udGVudCkgPT4ge1xuICAgICAgICAgIGNvbnRyb2xDb250ZW50LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuIl19