/**
 * @fileoverview added by tsickle
 * Generated from: lib/backend/organization.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { HttpBackend, HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { tap } from 'rxjs/operators';
import { Environment, MessageService } from '../core/public-api';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "../core/services/message.service";
/**
 * The URL to the root api.
 * @type {?}
 */
export const ROOT_API = 'api';
/**
 * The object with the URLs to the endpoint apis.
 * @type {?}
 */
export const ENDPOINT_APIS = {
    organizations: ROOT_API + '/organizations',
};
/**
 * The backend service in order to communicate with a remote server over HTTP.
 */
export class OrganizationService {
    /**
     * @param {?} _http
     * @param {?} _messageService
     */
    constructor(_http, _messageService) {
        this._http = _http;
        this._messageService = _messageService;
        /**
         * The `httpOptions` object that contains the headers and will be passed to every `HttpClient` save method.
         */
        this._httpOptions = {
            headers: new HttpHeaders({
                'Content-Type': 'application/json',
                'Authorization': 'my-auth-token'
            })
        };
    }
    /**
     * Gets data from the server.
     * If an error occurs, lets the app keep running by returning the specified safe `optionalResult`.
     * @template T
     * @param {?} url The endpoint api URL.
     * @param {?} optionalResult If an error occurs, lets the app keep running by returning a safe optional value
     * as the observable result.
     * @return {?}
     */
    get(url, optionalResult) {
        return this._http.get(url).pipe(tap((/**
         * @param {?} _
         * @return {?}
         */
        _ => this.log(`fetched data from '${url}'`))));
    }
    /**
     * Gets data from the server that meets the specified `query`.
     * If an error occurs, lets the app keep running by returning the specified safe `optionalResult`.
     * @template T
     * @param {?} url The endpoint api URL.
     * @param {?} query The query to search.
     * @param {?} optionalResult If an error occurs, lets the app keep running by returning a safe optional value
     * as the observable result.
     * @return {?}
     */
    search(url, query, optionalResult) {
        return this._http.get(`${url}/?${query}`).pipe(tap((/**
         * @param {?} _
         * @return {?}
         */
        _ => this.log(`searched '${query}' in '${url}'`))));
    }
    /**
     * Adds `data` to the server. Expects the server to generate an `id` for the new `data`.
     * If an error occurs, lets the app keep running by returning the specified safe `optionalResult`.
     * @template T
     * @param {?} url The endpoint api URL.
     * @param {?} data The data to add.
     * @param {?} optionalResult If an error occurs, lets the app keep running by returning a safe optional value
     * as the observable result.
     * @return {?}
     */
    add(url, data, optionalResult) {
        /* Expects the server to generate an `id` for the new `data`. */
        return this._http.post(url, data, this._httpOptions).pipe(tap((/**
         * @param {?} _
         * @return {?}
         */
        _ => this.log(`added ${data} to '${url}'`))));
    }
    /**
     * Updates `data` on the server. Returns an Observable of that `data` if the `data` is inserted (does
     * not exist) on the server; otherwise, returns an Observable of null (if the `data` is only updated).
     * If an error occurs, lets the app keep running by returning the specified safe `optionalResult`.
     * @template T
     * @param {?} url The endpoint api URL.
     * @param {?} data The data to update.
     * @param {?} optionalResult If an error occurs, lets the app keep running by returning a safe optional value
     * as the observable result.
     * @return {?}
     */
    update(url, data, optionalResult) {
        return this._http.put(url, data, this._httpOptions).pipe(tap((/**
         * @param {?} _
         * @return {?}
         */
        _ => this.log(`updated ${data} to '${url}'`))));
    }
    /**
     * Deletes data from the server.
     * If an error occurs, lets the app keep running by returning the specified safe `optionalResult`.
     * @template T
     * @param {?} url The endpoint api URL.
     * @param {?} id The unique identifier that identifies the data to delete.
     * @param {?} optionalResult If an error occurs, lets the app keep running by returning a safe optional value
     * as the observable result.
     * @return {?}
     */
    delete(url, id, optionalResult) {
        return this._http.delete(`${url}/${id}`, this._httpOptions).pipe(tap((/**
         * @param {?} _
         * @return {?}
         */
        _ => this.log(`deleted data with id = ${id} from '${url}'`))));
    }
    /**
     * Logs an `OrganizationService` message with the `MessageService`.
     * @private
     * @param {?} message The message to log.
     * @return {?}
     */
    log(message) {
        this._messageService.add(`${OrganizationService.name}: ${message}.`);
    }
}
OrganizationService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
OrganizationService.ctorParameters = () => [
    { type: HttpClient },
    { type: MessageService }
];
/** @nocollapse */ OrganizationService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function OrganizationService_Factory() { return new OrganizationService(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.MessageService)); }, token: OrganizationService, providedIn: "root" });
if (false) {
    /**
     * The `httpOptions` object that contains the headers and will be passed to every `HttpClient` save method.
     * @type {?}
     * @private
     */
    OrganizationService.prototype._httpOptions;
    /**
     * @type {?}
     * @private
     */
    OrganizationService.prototype._http;
    /**
     * @type {?}
     * @private
     */
    OrganizationService.prototype._messageService;
}
export class OrganizationServiceNoAuth {
    /**
     * @param {?} env
     * @param {?} handler
     */
    constructor(env, handler) {
        this.env = env;
        this.handler = handler;
        this.path = 'organizations';
        this.http = new HttpClient(handler);
    }
    /**
     * @param {?} uuid
     * @return {?}
     */
    getOrganizationByUUID(uuid) {
        // const req = this.env.sceibaApi + this.prefix + "/" + uuid;
        /** @type {?} */
        const req = this.env.sceibaApi + "/pid/organization/" + uuid;
        return this.http.get(req);
    }
    /**
     * @param {?} uuid
     * @param {?=} relType
     * @return {?}
     */
    getOrganizationRelationships(uuid, relType = null) {
        /** @type {?} */
        const req = this.env.sceibaApi + this.path + '/' + uuid + '/relationships';
        if (relType != null) {
            /** @type {?} */
            let params = new HttpParams();
            params = params.set('type', relType);
            /** @type {?} */
            const options = {
                params: params,
            };
            return this.http.get(req, options);
        }
        else {
            return this.http.get(req);
        }
    }
    /**
     * @param {?} pid
     * @return {?}
     */
    getOrganizationByPID(pid) {
        // const req = this.env.sceibaApi + this.prefix + "/" + uuid;
        /** @type {?} */
        let params = new HttpParams();
        params = params.set('value', pid);
        /** @type {?} */
        const options = {
            params: params,
        };
        /** @type {?} */
        const req = this.env.sceibaApi + this.path + '/pid';
        return this.http.get(req, options);
    }
    /**
     * @param {?} params
     * @return {?}
     */
    getOrganizations(params) {
        /** @type {?} */
        const options = {
            params: params,
        };
        console.log(params);
        /** @type {?} */
        const req = this.env.sceibaApi + 'search/' + this.path;
        console.log(req);
        return this.http.get(req, options);
    }
}
OrganizationServiceNoAuth.decorators = [
    { type: Injectable }
];
/** @nocollapse */
OrganizationServiceNoAuth.ctorParameters = () => [
    { type: Environment },
    { type: HttpBackend }
];
if (false) {
    /** @type {?} */
    OrganizationServiceNoAuth.prototype.http;
    /** @type {?} */
    OrganizationServiceNoAuth.prototype.path;
    /**
     * @type {?}
     * @private
     */
    OrganizationServiceNoAuth.prototype.env;
    /**
     * @type {?}
     * @private
     */
    OrganizationServiceNoAuth.prototype.handler;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JnYW5pemF0aW9uLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90b2NvLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9iYWNrZW5kL29yZ2FuaXphdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3hGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFM0MsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBRSxXQUFXLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7Ozs7Ozs7O0FBT2pFLE1BQU0sT0FBTyxRQUFRLEdBQVcsS0FBSzs7Ozs7QUFLckMsTUFBTSxPQUFPLGFBQWEsR0FBRztJQUN6QixhQUFhLEVBQUUsUUFBUSxHQUFHLGdCQUFnQjtDQUM3Qzs7OztBQVFELE1BQU0sT0FBTyxtQkFBbUI7Ozs7O0lBWTVCLFlBQTJCLEtBQWlCLEVBQVUsZUFBK0I7UUFBMUQsVUFBSyxHQUFMLEtBQUssQ0FBWTtRQUFVLG9CQUFlLEdBQWYsZUFBZSxDQUFnQjs7OztRQVBwRSxpQkFBWSxHQUFHO1lBQzVCLE9BQU8sRUFBRSxJQUFJLFdBQVcsQ0FBQztnQkFDckIsY0FBYyxFQUFFLGtCQUFrQjtnQkFDbEMsZUFBZSxFQUFFLGVBQWU7YUFDbkMsQ0FBQztTQUNMLENBQUM7SUFHQSxDQUFDOzs7Ozs7Ozs7O0lBU0ksR0FBRyxDQUFJLEdBQVcsRUFBRSxjQUFpQjtRQUV4QyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFJLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FDOUIsR0FBRzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxzQkFBdUIsR0FBSSxHQUFHLENBQUMsRUFBQyxDQUNy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QUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNuRSxDQUFDOzs7WUF4REYsVUFBVTs7OztZQTdIRixXQUFXO1lBSlgsV0FBVzs7OztJQW9JbEIseUNBQWlCOztJQUNqQix5Q0FBc0I7Ozs7O0lBQ1Ysd0NBQXdCOzs7OztJQUFFLDRDQUE0QiIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgSHR0cEJhY2tlbmQsIEh0dHBDbGllbnQsIEh0dHBIZWFkZXJzLCBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQsIE1lc3NhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vY29yZS9wdWJsaWMtYXBpJztcbmltcG9ydCB7IEhpdCwgT3JnYW5pemF0aW9uLCBTZWFyY2hSZXNwb25zZSB9IGZyb20gJy4uL2VudGl0aWVzL3B1YmxpYy1hcGknO1xuXG5cbi8qKlxuICogVGhlIFVSTCB0byB0aGUgcm9vdCBhcGkuXG4gKi9cbmV4cG9ydCBjb25zdCBST09UX0FQSTogc3RyaW5nID0gJ2FwaSc7XG5cbi8qKlxuICogVGhlIG9iamVjdCB3aXRoIHRoZSBVUkxzIHRvIHRoZSBlbmRwb2ludCBhcGlzLlxuICovXG5leHBvcnQgY29uc3QgRU5EUE9JTlRfQVBJUyA9IHtcbiAgICBvcmdhbml6YXRpb25zOiBST09UX0FQSSArICcvb3JnYW5pemF0aW9ucycsXG59O1xuXG4vKipcbiAqIFRoZSBiYWNrZW5kIHNlcnZpY2UgaW4gb3JkZXIgdG8gY29tbXVuaWNhdGUgd2l0aCBhIHJlbW90ZSBzZXJ2ZXIgb3ZlciBIVFRQLlxuICovXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE9yZ2FuaXphdGlvblNlcnZpY2VcbntcbiAgICAvKipcbiAgICAgKiBUaGUgYGh0dHBPcHRpb25zYCBvYmplY3QgdGhhdCBjb250YWlucyB0aGUgaGVhZGVycyBhbmQgd2lsbCBiZSBwYXNzZWQgdG8gZXZlcnkgYEh0dHBDbGllbnRgIHNhdmUgbWV0aG9kLlxuICAgICAqL1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX2h0dHBPcHRpb25zID0ge1xuICAgICAgICBoZWFkZXJzOiBuZXcgSHR0cEhlYWRlcnMoe1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ215LWF1dGgtdG9rZW4nXG4gICAgICAgIH0pXG4gICAgfTtcblxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcml2YXRlIF9odHRwOiBIdHRwQ2xpZW50LCBwcml2YXRlIF9tZXNzYWdlU2VydmljZTogTWVzc2FnZVNlcnZpY2UpXG4gICAgeyB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGRhdGEgZnJvbSB0aGUgc2VydmVyLlxuICAgICAqIElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgdGhlIHNwZWNpZmllZCBzYWZlIGBvcHRpb25hbFJlc3VsdGAuXG4gICAgICogQHBhcmFtIHVybCBUaGUgZW5kcG9pbnQgYXBpIFVSTC5cbiAgICAgKiBAcGFyYW0gb3B0aW9uYWxSZXN1bHQgSWYgYW4gZXJyb3Igb2NjdXJzLCBsZXRzIHRoZSBhcHAga2VlcCBydW5uaW5nIGJ5IHJldHVybmluZyBhIHNhZmUgb3B0aW9uYWwgdmFsdWVcbiAgICAgKiBhcyB0aGUgb2JzZXJ2YWJsZSByZXN1bHQuXG4gICAgICovXG4gICAgcHVibGljIGdldDxUPih1cmw6IHN0cmluZywgb3B0aW9uYWxSZXN1bHQ6IFQpOiBPYnNlcnZhYmxlPFQ+XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5nZXQ8VD4odXJsKS5waXBlKFxuICAgICAgICAgICAgdGFwKF8gPT4gdGhpcy5sb2coYGZldGNoZWQgZGF0YSBmcm9tICckeyB1cmwgfSdgKSksXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBkYXRhIGZyb20gdGhlIHNlcnZlciB0aGF0IG1lZXRzIHRoZSBzcGVjaWZpZWQgYHF1ZXJ5YC5cbiAgICAgKiBJZiBhbiBlcnJvciBvY2N1cnMsIGxldHMgdGhlIGFwcCBrZWVwIHJ1bm5pbmcgYnkgcmV0dXJuaW5nIHRoZSBzcGVjaWZpZWQgc2FmZSBgb3B0aW9uYWxSZXN1bHRgLlxuICAgICAqIEBwYXJhbSB1cmwgVGhlIGVuZHBvaW50IGFwaSBVUkwuXG4gICAgICogQHBhcmFtIHF1ZXJ5IFRoZSBxdWVyeSB0byBzZWFyY2guXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUmVzdWx0IElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgYSBzYWZlIG9wdGlvbmFsIHZhbHVlXG4gICAgICogYXMgdGhlIG9ic2VydmFibGUgcmVzdWx0LlxuICAgICAqL1xuICAgIHB1YmxpYyBzZWFyY2g8VD4odXJsOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcsIG9wdGlvbmFsUmVzdWx0OiBUKTogT2JzZXJ2YWJsZTxUPlxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0PFQ+KGAkeyB1cmwgfS8/JHsgcXVlcnkgfWApLnBpcGUoXG4gICAgICAgICAgICB0YXAoXyA9PiB0aGlzLmxvZyhgc2VhcmNoZWQgJyR7IHF1ZXJ5IH0nIGluICckeyB1cmwgfSdgKSksXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBgZGF0YWAgdG8gdGhlIHNlcnZlci4gRXhwZWN0cyB0aGUgc2VydmVyIHRvIGdlbmVyYXRlIGFuIGBpZGAgZm9yIHRoZSBuZXcgYGRhdGFgLlxuICAgICAqIElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgdGhlIHNwZWNpZmllZCBzYWZlIGBvcHRpb25hbFJlc3VsdGAuXG4gICAgICogQHBhcmFtIHVybCBUaGUgZW5kcG9pbnQgYXBpIFVSTC5cbiAgICAgKiBAcGFyYW0gZGF0YSBUaGUgZGF0YSB0byBhZGQuXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUmVzdWx0IElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgYSBzYWZlIG9wdGlvbmFsIHZhbHVlXG4gICAgICogYXMgdGhlIG9ic2VydmFibGUgcmVzdWx0LlxuICAgICAqL1xuICAgIHB1YmxpYyBhZGQ8VD4odXJsOiBzdHJpbmcsIGRhdGE6IFQsIG9wdGlvbmFsUmVzdWx0OiBUKTogT2JzZXJ2YWJsZTxUPlxuICAgIHtcbiAgICAgICAgLyogRXhwZWN0cyB0aGUgc2VydmVyIHRvIGdlbmVyYXRlIGFuIGBpZGAgZm9yIHRoZSBuZXcgYGRhdGFgLiAqL1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLnBvc3Q8VD4odXJsLCBkYXRhLCB0aGlzLl9odHRwT3B0aW9ucykucGlwZShcbiAgICAgICAgICAgIHRhcChfID0+IHRoaXMubG9nKGBhZGRlZCAkeyBkYXRhIH0gdG8gJyR7IHVybCB9J2ApKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIGBkYXRhYCBvbiB0aGUgc2VydmVyLiBSZXR1cm5zIGFuIE9ic2VydmFibGUgb2YgdGhhdCBgZGF0YWAgaWYgdGhlIGBkYXRhYCBpcyBpbnNlcnRlZCAoZG9lc1xuICAgICAqIG5vdCBleGlzdCkgb24gdGhlIHNlcnZlcjsgb3RoZXJ3aXNlLCByZXR1cm5zIGFuIE9ic2VydmFibGUgb2YgbnVsbCAoaWYgdGhlIGBkYXRhYCBpcyBvbmx5IHVwZGF0ZWQpLlxuICAgICAqIElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgdGhlIHNwZWNpZmllZCBzYWZlIGBvcHRpb25hbFJlc3VsdGAuXG4gICAgICogQHBhcmFtIHVybCBUaGUgZW5kcG9pbnQgYXBpIFVSTC5cbiAgICAgKiBAcGFyYW0gZGF0YSBUaGUgZGF0YSB0byB1cGRhdGUuXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUmVzdWx0IElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgYSBzYWZlIG9wdGlvbmFsIHZhbHVlXG4gICAgICogYXMgdGhlIG9ic2VydmFibGUgcmVzdWx0LlxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGU8VD4odXJsOiBzdHJpbmcsIGRhdGE6IFQsIG9wdGlvbmFsUmVzdWx0OiBUKTogT2JzZXJ2YWJsZTxUPlxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAucHV0PFQ+KHVybCwgZGF0YSwgdGhpcy5faHR0cE9wdGlvbnMpLnBpcGUoXG4gICAgICAgICAgICB0YXAoXyA9PiB0aGlzLmxvZyhgdXBkYXRlZCAkeyBkYXRhIH0gdG8gJyR7IHVybCB9J2ApKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGVzIGRhdGEgZnJvbSB0aGUgc2VydmVyLlxuICAgICAqIElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgdGhlIHNwZWNpZmllZCBzYWZlIGBvcHRpb25hbFJlc3VsdGAuXG4gICAgICogQHBhcmFtIHVybCBUaGUgZW5kcG9pbnQgYXBpIFVSTC5cbiAgICAgKiBAcGFyYW0gaWQgVGhlIHVuaXF1ZSBpZGVudGlmaWVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZGF0YSB0byBkZWxldGUuXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUmVzdWx0IElmIGFuIGVycm9yIG9jY3VycywgbGV0cyB0aGUgYXBwIGtlZXAgcnVubmluZyBieSByZXR1cm5pbmcgYSBzYWZlIG9wdGlvbmFsIHZhbHVlXG4gICAgICogYXMgdGhlIG9ic2VydmFibGUgcmVzdWx0LlxuICAgICAqL1xuICAgIHB1YmxpYyBkZWxldGU8VD4odXJsOiBzdHJpbmcsIGlkOiBzdHJpbmcsIG9wdGlvbmFsUmVzdWx0OiBUKTogT2JzZXJ2YWJsZTxUPlxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZGVsZXRlPFQ+KGAkeyB1cmwgfS8keyBpZCB9YCwgdGhpcy5faHR0cE9wdGlvbnMpLnBpcGUoXG4gICAgICAgICAgICB0YXAoXyA9PiB0aGlzLmxvZyhgZGVsZXRlZCBkYXRhIHdpdGggaWQgPSAkeyBpZCB9IGZyb20gJyR7IHVybCB9J2ApKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2dzIGFuIGBPcmdhbml6YXRpb25TZXJ2aWNlYCBtZXNzYWdlIHdpdGggdGhlIGBNZXNzYWdlU2VydmljZWAuXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gbG9nLlxuICAgICAqL1xuICAgIHByaXZhdGUgbG9nKG1lc3NhZ2U6IHN0cmluZyk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuX21lc3NhZ2VTZXJ2aWNlLmFkZChgJHsgT3JnYW5pemF0aW9uU2VydmljZS5uYW1lIH06ICR7IG1lc3NhZ2UgfS5gKTtcbiAgICB9XG59XG5cblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIE9yZ2FuaXphdGlvblNlcnZpY2VOb0F1dGgge1xuXG4gIGh0dHA6IEh0dHBDbGllbnQ7XG4gIHBhdGggPSAnb3JnYW5pemF0aW9ucydcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlbnY6IEVudmlyb25tZW50LCBwcml2YXRlIGhhbmRsZXI6IEh0dHBCYWNrZW5kKSB7XG5cbiAgICB0aGlzLmh0dHAgPSBuZXcgSHR0cENsaWVudChoYW5kbGVyKTtcbiAgfVxuXG4gIGdldE9yZ2FuaXphdGlvbkJ5VVVJRCh1dWlkKTogT2JzZXJ2YWJsZTxIaXQ8T3JnYW5pemF0aW9uPj4ge1xuICAgIC8vIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucHJlZml4ICsgXCIvXCIgKyB1dWlkO1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIFwiL3BpZC9vcmdhbml6YXRpb24vXCIgKyB1dWlkO1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PEhpdDxPcmdhbml6YXRpb24+PihyZXEpO1xuICB9XG5cbiAgZ2V0T3JnYW5pemF0aW9uUmVsYXRpb25zaGlwcyh1dWlkLCByZWxUeXBlPW51bGwpOiBPYnNlcnZhYmxlPEFycmF5PEhpdDxPcmdhbml6YXRpb24+Pj4ge1xuICAgIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucGF0aCArICcvJyArIHV1aWQgKyAnL3JlbGF0aW9uc2hpcHMnO1xuXG4gICAgaWYgKHJlbFR5cGUgIT0gbnVsbCl7XG4gICAgICBsZXQgcGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ3R5cGUnLCByZWxUeXBlKTtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgfTtcbiAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PEFycmF5PEhpdDxPcmdhbml6YXRpb24+Pj4ocmVxLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8QXJyYXk8SGl0PE9yZ2FuaXphdGlvbj4+PihyZXEpO1xuICAgIH1cblxuICB9XG5cbiAgZ2V0T3JnYW5pemF0aW9uQnlQSUQocGlkKTogT2JzZXJ2YWJsZTxIaXQ8T3JnYW5pemF0aW9uPj4ge1xuICAgIC8vIGNvbnN0IHJlcSA9IHRoaXMuZW52LnNjZWliYUFwaSArIHRoaXMucHJlZml4ICsgXCIvXCIgKyB1dWlkO1xuICAgIGxldCBwYXJhbXMgPSBuZXcgSHR0cFBhcmFtcygpO1xuICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ3ZhbHVlJywgcGlkKTtcblxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgIC8vIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xuICAgIH07XG5cbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyB0aGlzLnBhdGggKyAnL3BpZCc7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8SGl0PE9yZ2FuaXphdGlvbj4+KHJlcSwgb3B0aW9ucyk7XG4gIH1cblxuICBnZXRPcmdhbml6YXRpb25zKHBhcmFtczogSHR0cFBhcmFtcyk6IE9ic2VydmFibGU8U2VhcmNoUmVzcG9uc2U8T3JnYW5pemF0aW9uPj4ge1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgIC8vIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xuICAgIH07XG4gICAgY29uc29sZS5sb2cocGFyYW1zKTtcbiAgICBjb25zdCByZXEgPSB0aGlzLmVudi5zY2VpYmFBcGkgKyAnc2VhcmNoLycgKyB0aGlzLnBhdGg7XG4gICAgY29uc29sZS5sb2cocmVxKTtcblxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PFNlYXJjaFJlc3BvbnNlPE9yZ2FuaXphdGlvbj4+KHJlcSwgb3B0aW9ucyk7XG4gIH1cblxufVxuIl19